/* 
  This file was generated automatically with ./scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_b86.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 2
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC)


static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t3, t4, t5, t7, t8, t9, t10, t11;
  double t12, t13, t15, t16, t19, t20, t21, t24;
  double t28;

#ifndef XC_DONT_COMPILE_VXC
  double t29, t33, t35, t40, t41, t42, t45, t48;
  double t49, t51, t54, t59, t62, t67, t72, t76;

#ifndef XC_DONT_COMPILE_FXC
  double t102, t105, t106, t108, t109, t111, t112, t115;
  double t123, t132, t142, t152, t158, t166;
#endif

#endif

#endif


  gga_x_b86_params *params;

  assert(p->params != NULL);
  params = (gga_x_b86_params * )(p->params);

  t3 = rho[0] / 0.2e1 <= 0.101e1 * p->threshold_dens;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t7 = t4 / t5;
  t8 = POW_1_3(rho[0]);
  t9 = params->beta * sigma[0];
  t10 = M_CBRT2;
  t11 = t10 * t10;
  t12 = rho[0] * rho[0];
  t13 = t8 * t8;
  t15 = 0.1e1 / t13 / t12;
  t16 = t11 * t15;
  t19 = params->gamma * sigma[0] * t16 + 0.1e1;
  t20 = pow(t19, params->omega);
  t21 = 0.1e1 / t20;
  t24 = t9 * t16 * t21 + 0.1e1;
  t28 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t8 * t24);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = 0.2e1 * t28;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t29 = 0.1e1 / t13;
  t33 = t12 * rho[0];
  t35 = 0.1e1 / t13 / t33;
  t40 = sigma[0] * sigma[0];
  t41 = params->beta * t40;
  t42 = t12 * t12;
  t45 = 0.1e1 / t8 / t42 / t12;
  t48 = t21 * params->omega;
  t49 = 0.1e1 / t19;
  t51 = t48 * params->gamma * t49;
  t54 = -0.8e1 / 0.3e1 * t9 * t11 * t35 * t21 + 0.16e2 / 0.3e1 * t41 * t10 * t45 * t51;
  t59 = my_piecewise3(t3, 0, -t7 * t29 * t24 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t8 * t54);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.2e1 * rho[0] * t59 + 0.2e1 * t28;

  t62 = params->beta * t11;
  t67 = 0.1e1 / t8 / t42 / rho[0];
  t72 = -0.2e1 * t9 * t10 * t67 * t51 + t62 * t15 * t21;
  t76 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t8 * t72);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.2e1 * rho[0] * t76;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t102 = t42 * t42;
  t105 = params->beta * t40 * sigma[0] / t102 / t12;
  t106 = params->omega * params->omega;
  t108 = params->gamma * params->gamma;
  t109 = t19 * t19;
  t111 = t108 / t109;
  t112 = t21 * t106 * t111;
  t115 = t48 * t111;
  t123 = my_piecewise3(t3, 0, t7 / t13 / rho[0] * t24 / 0.12e2 - t7 * t29 * t54 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t8 * (0.88e2 / 0.9e1 * t9 * t11 / t13 / t42 * t21 - 0.48e2 * t41 * t10 / t8 / t42 / t33 * t51 + 0.256e3 / 0.9e1 * t105 * t112 + 0.256e3 / 0.9e1 * t105 * t115));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * rho[0] * t123 + 0.4e1 * t59;

  t132 = params->beta * t10;
  t142 = t41 / t102 / rho[0];
  t152 = my_piecewise3(t3, 0, -t7 * t29 * t72 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t8 * (-0.8e1 / 0.3e1 * t62 * t35 * t21 + 0.16e2 * t132 * t45 * t21 * params->omega * params->gamma * sigma[0] * t49 - 0.32e2 / 0.3e1 * t142 * t112 - 0.32e2 / 0.3e1 * t142 * t115));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.2e1 * rho[0] * t152 + 0.2e1 * t76;

  t158 = t9 / t102;
  t166 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t8 * (-0.4e1 * t132 * t67 * t51 + 0.4e1 * t158 * t112 + 0.4e1 * t158 * t115));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.2e1 * rho[0] * t166;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t1, t2, t3, t4, t6, t7, t8, t9;
  double t10, t11, t12, t13, t14, t15, t16, t17;
  double t18, t19, t20, t22, t25, t26, t27, t30;
  double t31, t35, t36, t37, t38, t39, t40, t41;
  double t42, t43, t45, t48, t49, t50, t53, t54;
  double t58;

#ifndef XC_DONT_COMPILE_VXC
  double t59, t64, t65, t68, t70, t71, t72, t73;
  double t74, t75, t77, t78, t79, t82, t84, t87;
  double t88, t89, t92, t94, t95, t97, t100, t101;
  double t106, t107, t110, t112, t113, t114, t115, t116;
  double t121, t124, t125, t130, t131, t136, t137, t139;
  double t140, t141, t144, t146, t149, t150, t151, t154;
  double t156, t157, t159, t162, t163, t168, t175, t178;
  double t179, t183, t188, t191, t192, t196;

#ifndef XC_DONT_COMPILE_FXC
  double t201, t207, t210, t213, t216, t218, t220, t229;
  double t230, t251, t254, t255, t257, t258, t260, t261;
  double t264, t273, t277, t279, t282, t284, t286, t289;
  double t295, t306, t319, t322, t332, t340, t348, t355;
  double t367, t375, t403, t406, t408, t410, t411, t414;
  double t423, t431, t441, t448, t459, t463, t469, t476;
  double t496, t507, t515, t523, t530, t538;
#endif

#endif

#endif


  gga_x_b86_params *params;

  assert(p->params != NULL);
  params = (gga_x_b86_params * )(p->params);

  t1 = 0.101e1 * p->threshold_dens;
  t2 = rho[0] <= t1;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = M_CBRT2;
  t8 = t6 * t7;
  t9 = rho[0] + rho[1];
  t10 = POW_1_3(t9);
  t11 = t10 * t10;
  t12 = 0.1e1 / t11;
  t13 = rho[0] * t12;
  t14 = 0.1e1 / t9;
  t15 = rho[0] * t14;
  t16 = POW_1_3(t15);
  t17 = params->beta * sigma[0];
  t18 = rho[0] * rho[0];
  t19 = POW_1_3(rho[0]);
  t20 = t19 * t19;
  t22 = 0.1e1 / t20 / t18;
  t25 = params->gamma * sigma[0] * t22 + 0.1e1;
  t26 = pow(t25, params->omega);
  t27 = 0.1e1 / t26;
  t30 = t17 * t22 * t27 + 0.1e1;
  t31 = t16 * t30;
  t35 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t13 * t31);
  t36 = rho[1] <= t1;
  t37 = rho[1] * t12;
  t38 = rho[1] * t14;
  t39 = POW_1_3(t38);
  t40 = params->beta * sigma[2];
  t41 = rho[1] * rho[1];
  t42 = POW_1_3(rho[1]);
  t43 = t42 * t42;
  t45 = 0.1e1 / t43 / t41;
  t48 = params->gamma * sigma[2] * t45 + 0.1e1;
  t49 = pow(t48, params->omega);
  t50 = 0.1e1 / t49;
  t53 = t40 * t45 * t50 + 0.1e1;
  t54 = t39 * t53;
  t58 = my_piecewise3(t36, 0, -0.3e1 / 0.4e1 * t8 * t37 * t54);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = t35 + t58;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t59 = t12 * t16;
  t64 = 0.1e1 / t11 / t9;
  t65 = rho[0] * t64;
  t68 = t8 * t65 * t31 / 0.2e1;
  t70 = t6 * t7 * rho[0];
  t71 = t16 * t16;
  t72 = 0.1e1 / t71;
  t73 = t12 * t72;
  t74 = t9 * t9;
  t75 = 0.1e1 / t74;
  t77 = -rho[0] * t75 + t14;
  t78 = t30 * t77;
  t79 = t73 * t78;
  t82 = t18 * rho[0];
  t84 = 0.1e1 / t20 / t82;
  t87 = sigma[0] * sigma[0];
  t88 = params->beta * t87;
  t89 = t18 * t18;
  t92 = 0.1e1 / t19 / t89 / t18;
  t94 = t27 * params->omega;
  t95 = 0.1e1 / t25;
  t97 = t94 * params->gamma * t95;
  t100 = -0.8e1 / 0.3e1 * t17 * t84 * t27 + 0.8e1 / 0.3e1 * t88 * t92 * t97;
  t101 = t16 * t100;
  t106 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t59 * t30 + t68 - t70 * t79 / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t13 * t101);
  t107 = rho[1] * t64;
  t110 = t8 * t107 * t54 / 0.2e1;
  t112 = 0.1e1 / t11 / t74;
  t113 = t41 * t112;
  t114 = t39 * t39;
  t115 = 0.1e1 / t114;
  t116 = t115 * t53;
  t121 = my_piecewise3(t36, 0, t110 + t8 * t113 * t116 / 0.4e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t35 + t58 + t9 * (t106 + t121);

  t124 = t18 * t112;
  t125 = t72 * t30;
  t130 = my_piecewise3(t2, 0, t68 + t8 * t124 * t125 / 0.4e1);
  t131 = t12 * t39;
  t136 = t6 * t7 * rho[1];
  t137 = t12 * t115;
  t139 = -rho[1] * t75 + t14;
  t140 = t53 * t139;
  t141 = t137 * t140;
  t144 = t41 * rho[1];
  t146 = 0.1e1 / t43 / t144;
  t149 = sigma[2] * sigma[2];
  t150 = params->beta * t149;
  t151 = t41 * t41;
  t154 = 0.1e1 / t42 / t151 / t41;
  t156 = t50 * params->omega;
  t157 = 0.1e1 / t48;
  t159 = t156 * params->gamma * t157;
  t162 = -0.8e1 / 0.3e1 * t40 * t146 * t50 + 0.8e1 / 0.3e1 * t150 * t154 * t159;
  t163 = t39 * t162;
  t168 = my_piecewise3(t36, 0, -0.3e1 / 0.4e1 * t8 * t131 * t53 + t110 - t136 * t141 / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t37 * t163);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t35 + t58 + t9 * (t130 + t168);

  t175 = 0.1e1 / t19 / t89 / rho[0];
  t178 = -t17 * t175 * t97 + params->beta * t22 * t27;
  t179 = t16 * t178;
  t183 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t13 * t179);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = t9 * t183;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t188 = 0.1e1 / t42 / t151 / rho[1];
  t191 = -t40 * t188 * t159 + params->beta * t45 * t50;
  t192 = t39 * t191;
  t196 = my_piecewise3(t36, 0, -0.3e1 / 0.4e1 * t8 * t37 * t192);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = t9 * t196;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t201 = t8 * t64 * t16 * t30;
  t207 = rho[0] * t112;
  t210 = 0.5e1 / 0.6e1 * t8 * t207 * t31;
  t213 = t70 * t64 * t72 * t78;
  t216 = t8 * t65 * t101;
  t218 = 0.1e1 / t71 / t15;
  t220 = t77 * t77;
  t229 = t74 * t9;
  t230 = 0.1e1 / t229;
  t251 = t89 * t89;
  t254 = params->beta * t87 * sigma[0] / t251 / t18;
  t255 = params->omega * params->omega;
  t257 = params->gamma * params->gamma;
  t258 = t25 * t25;
  t260 = t257 / t258;
  t261 = t27 * t255 * t260;
  t264 = t94 * t260;
  t273 = my_piecewise3(t2, 0, t201 - t8 * t79 / 0.2e1 - 0.3e1 / 0.2e1 * t8 * t59 * t100 - t210 + t213 / 0.3e1 + t216 + t70 * t12 * t218 * t30 * t220 / 0.6e1 - t70 * t73 * t100 * t77 / 0.2e1 - t70 * t73 * t30 * (0.2e1 * rho[0] * t230 - 0.2e1 * t75) / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t13 * t16 * (0.88e2 / 0.9e1 * t17 / t20 / t89 * t27 - 0.24e2 * t88 / t19 / t89 / t82 * t97 + 0.64e2 / 0.9e1 * t254 * t261 + 0.64e2 / 0.9e1 * t254 * t264));
  t277 = 0.5e1 / 0.6e1 * t8 * rho[1] * t112 * t54;
  t279 = 0.1e1 / t11 / t229;
  t282 = t8 * t41 * t279 * t116;
  t284 = t74 * t74;
  t286 = 0.1e1 / t11 / t284;
  t289 = 0.1e1 / t114 / t38;
  t295 = my_piecewise3(t36, 0, -t277 - 0.5e1 / 0.6e1 * t282 + t8 * t144 * t286 * t289 * t53 / 0.6e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * t106 + 0.2e1 * t121 + t9 * (t273 + t295);

  t306 = t8 * t18 * t279 * t125;
  t319 = my_piecewise3(t2, 0, t201 / 0.2e1 - t210 + t213 / 0.6e1 + t216 / 0.2e1 + t8 * t207 * t125 / 0.2e1 - 0.2e1 / 0.3e1 * t306 - t6 * t7 * t18 * t112 * t218 * t78 / 0.6e1 + t8 * t124 * t72 * t100 / 0.4e1);
  t322 = t8 * t64 * t39 * t53;
  t332 = t136 * t64 * t115 * t140;
  t340 = rho[1] * t230;
  t348 = t8 * t107 * t163;
  t355 = my_piecewise3(t36, 0, t322 / 0.2e1 + t8 * t112 * t115 * t53 * rho[1] / 0.4e1 - t277 - t282 / 0.6e1 + t332 / 0.6e1 - t6 * t7 * t41 * t112 * t289 * t140 / 0.6e1 - t136 * t137 * t53 * (-t75 + 0.2e1 * t340) / 0.4e1 + t348 / 0.2e1 + t8 * t113 * t115 * t162 / 0.4e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t106 + t121 + t130 + t168 + t9 * (t319 + t355);

  t367 = my_piecewise3(t2, 0, -t210 - 0.5e1 / 0.6e1 * t306 + t8 * t82 * t286 * t218 * t30 / 0.6e1);
  t375 = t139 * t139;
  t403 = t151 * t151;
  t406 = params->beta * t149 * sigma[2] / t403 / t41;
  t408 = t48 * t48;
  t410 = t257 / t408;
  t411 = t50 * t255 * t410;
  t414 = t156 * t410;
  t423 = my_piecewise3(t36, 0, t322 - t8 * t141 / 0.2e1 - 0.3e1 / 0.2e1 * t8 * t131 * t162 - t277 + t332 / 0.3e1 + t348 + t136 * t12 * t289 * t53 * t375 / 0.6e1 - t136 * t137 * t162 * t139 / 0.2e1 - t136 * t137 * t53 * (-0.2e1 * t75 + 0.2e1 * t340) / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t37 * t39 * (0.88e2 / 0.9e1 * t40 / t43 / t151 * t50 - 0.24e2 * t150 / t42 / t151 / t144 * t159 + 0.64e2 / 0.9e1 * t406 * t411 + 0.64e2 / 0.9e1 * t406 * t414));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = 0.2e1 * t130 + 0.2e1 * t168 + t9 * (t367 + t423);

  t431 = t8 * t65 * t179 / 0.2e1;
  t441 = params->omega * params->gamma;
  t448 = t88 / t251 / rho[0];
  t459 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t59 * t178 + t431 - t70 * t73 * t178 * t77 / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t13 * t16 * (-0.8e1 / 0.3e1 * params->beta * t84 * t27 + 0.8e1 * params->beta * t92 * t27 * t441 * sigma[0] * t95 - 0.8e1 / 0.3e1 * t448 * t261 - 0.8e1 / 0.3e1 * t448 * t264));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t9 * t459 + t183;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  t463 = t8 * t107 * t192 / 0.2e1;
  t469 = my_piecewise3(t36, 0, t463 + t8 * t113 * t115 * t191 / 0.4e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t9 * t469 + t196;

  t476 = my_piecewise3(t2, 0, t431 + t8 * t124 * t72 * t178 / 0.4e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t9 * t476 + t183;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t496 = t150 / t403 / rho[1];
  t507 = my_piecewise3(t36, 0, -0.3e1 / 0.4e1 * t8 * t131 * t191 + t463 - t136 * t137 * t191 * t139 / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t37 * t39 * (-0.8e1 / 0.3e1 * params->beta * t146 * t50 + 0.8e1 * params->beta * t154 * t50 * t441 * sigma[2] * t157 - 0.8e1 / 0.3e1 * t496 * t411 - 0.8e1 / 0.3e1 * t496 * t414));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t9 * t507 + t196;

  t515 = t17 / t251;
  t523 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t13 * t16 * (-0.2e1 * params->beta * t175 * t27 * t441 * t95 + t515 * t261 + t515 * t264));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = t9 * t523;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  t530 = t40 / t403;
  t538 = my_piecewise3(t36, 0, -0.3e1 / 0.4e1 * t8 * t37 * t39 * (-0.2e1 * params->beta * t188 * t50 * t441 * t157 + t530 * t411 + t530 * t414));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = t9 * t538;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}

