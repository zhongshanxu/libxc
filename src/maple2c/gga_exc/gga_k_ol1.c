/* 
  This file was generated automatically with ./scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_k_ol1.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 2
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC)


static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t3, t4, t5, t6, t8, t9, t10, t11;
  double t13, t16, t18, t22, t24, t25, t26, t27;
  double t30, t34;

#ifndef XC_DONT_COMPILE_VXC
  double t35, t39, t40, t42, t46, t51, t55, t59;
  double t64, t67;

#ifndef XC_DONT_COMPILE_FXC
  double t73, t76, t91, t105, t116;
#endif

#endif

#endif



  t3 = rho[0] / 0.2e1 <= 0.101e1 * p->threshold_dens;
  t4 = M_CBRT3;
  t5 = t4 * t4;
  t6 = M_CBRTPI;
  t8 = t5 * t6 * M_PI;
  t9 = POW_1_3(rho[0]);
  t10 = t9 * t9;
  t11 = rho[0] * rho[0];
  t13 = 0.1e1 / t10 / t11;
  t16 = sqrt(sigma[0]);
  t18 = 0.1e1 / t9 / rho[0];
  t22 = M_CBRT6;
  t24 = M_PI * M_PI;
  t25 = POW_1_3(t24);
  t26 = t25 * t25;
  t27 = 0.1e1 / t26;
  t30 = 0.1e1 + 0.5e1 / 0.9e1 * (sigma[0] * t13 / 0.72e2 + 0.677e-2 * t16 * t18) * t22 * t27;
  t34 = my_piecewise3(t3, 0, 0.3e1 / 0.20e2 * t8 * t10 * t30);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = 0.2e1 * t34;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t35 = 0.1e1 / t9;
  t39 = t8 * t10;
  t40 = t11 * rho[0];
  t42 = 0.1e1 / t10 / t40;
  t46 = 0.1e1 / t9 / t11;
  t51 = (-sigma[0] * t42 / 0.27e2 - 0.90266666666666666666e-2 * t16 * t46) * t22 * t27;
  t55 = my_piecewise3(t3, 0, t8 * t35 * t30 / 0.10e2 + t39 * t51 / 0.12e2);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.2e1 * rho[0] * t55 + 0.2e1 * t34;

  t59 = 0.1e1 / t16;
  t64 = (t13 / 0.72e2 + 0.33850000000000000000e-2 * t59 * t18) * t22 * t27;
  t67 = my_piecewise3(t3, 0, t39 * t64 / 0.12e2);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.2e1 * rho[0] * t67;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t73 = t8 * t35;
  t76 = t11 * t11;
  t91 = my_piecewise3(t3, 0, -t8 * t18 * t30 / 0.30e2 + t73 * t51 / 0.9e1 + t39 * (0.11e2 / 0.81e2 * sigma[0] / t10 / t76 + 0.21062222222222222222e-1 * t16 / t9 / t40) * t22 * t27 / 0.12e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * rho[0] * t91 + 0.4e1 * t55;

  t105 = my_piecewise3(t3, 0, t73 * t64 / 0.18e2 + t39 * (-t42 / 0.27e2 - 0.45133333333333333333e-2 * t59 * t46) * t22 * t27 / 0.12e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.2e1 * rho[0] * t105 + 0.2e1 * t67;

  t116 = my_piecewise3(t3, 0, -0.64895402177010868827e-3 * t5 / t10 / t16 / sigma[0] * t22 * t27);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.2e1 * rho[0] * t116;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t13, t14, t15, t17;
  double t18, t19, t21, t23, t26, t28, t30, t35;
  double t36, t37, t38, t41, t42, t45, t46, t47;
  double t48, t49, t50, t52, t53, t54, t56, t60;
  double t62, t70, t71, t74;

#ifndef XC_DONT_COMPILE_VXC
  double t78, t80, t82, t83, t84, t85, t86, t88;
  double t89, t93, t94, t95, t97, t102, t106, t108;
  double t111, t113, t115, t116, t118, t119, t125, t128;
  double t130, t134, t137, t139, t140, t144, t145, t146;
  double t148, t153, t157, t159, t162, t167, t171, t173;
  double t175, t178, t182, t184, t186;

#ifndef XC_DONT_COMPILE_FXC
  double t189, t191, t196, t202, t205, t207, t208, t211;
  double t213, t218, t219, t223, t224, t232, t248, t252;
  double t254, t257, t260, t262, t264, t270, t280, t287;
  double t292, t293, t296, t303, t309, t316, t317, t320;
  double t321, t326, t338, t348, t353, t363, t379, t384;
  double t385, t399, t402, t403, t408, t414, t430, t441;
  double t451;
#endif

#endif

#endif



  t1 = 0.101e1 * p->threshold_dens;
  t2 = rho[0] <= t1;
  t3 = M_CBRT6;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t6 = t5 * M_PI;
  t7 = t4 * t6;
  t8 = t7 * rho[0];
  t9 = rho[0] + rho[1];
  t10 = POW_1_3(t9);
  t11 = 0.1e1 / t10;
  t12 = 0.1e1 / t9;
  t13 = rho[0] * t12;
  t14 = POW_1_3(t13);
  t15 = t14 * t14;
  t17 = rho[0] * rho[0];
  t18 = POW_1_3(rho[0]);
  t19 = t18 * t18;
  t21 = 0.1e1 / t19 / t17;
  t23 = M_CBRT2;
  t26 = sqrt(sigma[0]);
  t28 = 0.1e1 / t18 / rho[0];
  t30 = t23 * t23;
  t35 = M_PI * M_PI;
  t36 = POW_1_3(t35);
  t37 = t36 * t36;
  t38 = 0.1e1 / t37;
  t41 = 0.1e1 + 0.5e1 / 0.9e1 * (sigma[0] * t21 * t23 / 0.144e3 + 0.33850000000000000000e-2 * t26 * t28 * t30) * t3 * t38;
  t42 = t11 * t15 * t41;
  t45 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t8 * t42);
  t46 = rho[1] <= t1;
  t47 = t7 * rho[1];
  t48 = rho[1] * t12;
  t49 = POW_1_3(t48);
  t50 = t49 * t49;
  t52 = rho[1] * rho[1];
  t53 = POW_1_3(rho[1]);
  t54 = t53 * t53;
  t56 = 0.1e1 / t54 / t52;
  t60 = sqrt(sigma[2]);
  t62 = 0.1e1 / t53 / rho[1];
  t70 = 0.1e1 + 0.5e1 / 0.9e1 * (sigma[2] * t56 * t23 / 0.144e3 + 0.33850000000000000000e-2 * t60 * t62 * t30) * t3 * t38;
  t71 = t11 * t50 * t70;
  t74 = my_piecewise3(t46, 0, 0.3e1 / 0.10e2 * t47 * t71);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = t45 + t74;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t78 = 0.1e1 / t10 / t9;
  t80 = t78 * t15 * t41;
  t82 = t8 * t80 / 0.10e2;
  t83 = 0.1e1 / t14;
  t84 = t11 * t83;
  t85 = t9 * t9;
  t86 = 0.1e1 / t85;
  t88 = -rho[0] * t86 + t12;
  t89 = t41 * t88;
  t93 = t6 * rho[0];
  t94 = t93 * t11;
  t95 = t17 * rho[0];
  t97 = 0.1e1 / t19 / t95;
  t102 = 0.1e1 / t18 / t17;
  t106 = -sigma[0] * t97 * t23 / 0.54e2 - 0.45133333333333333333e-2 * t26 * t102 * t30;
  t108 = t15 * t106 * t38;
  t111 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t7 * t42 - t82 + t8 * t84 * t89 / 0.5e1 + t94 * t108);
  t113 = t78 * t50 * t70;
  t115 = t47 * t113 / 0.10e2;
  t116 = t7 * t52;
  t118 = 0.1e1 / t10 / t85;
  t119 = 0.1e1 / t49;
  t125 = my_piecewise3(t46, 0, -t115 - t116 * t118 * t119 * t70 / 0.5e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t45 + t74 + t9 * (t111 + t125);

  t128 = t7 * t17;
  t130 = t118 * t83 * t41;
  t134 = my_piecewise3(t2, 0, -t82 - t128 * t130 / 0.5e1);
  t137 = t11 * t119;
  t139 = -rho[1] * t86 + t12;
  t140 = t70 * t139;
  t144 = t6 * rho[1];
  t145 = t144 * t11;
  t146 = t52 * rho[1];
  t148 = 0.1e1 / t54 / t146;
  t153 = 0.1e1 / t53 / t52;
  t157 = -sigma[2] * t148 * t23 / 0.54e2 - 0.45133333333333333333e-2 * t60 * t153 * t30;
  t159 = t50 * t157 * t38;
  t162 = my_piecewise3(t46, 0, 0.3e1 / 0.10e2 * t7 * t71 - t115 + t47 * t137 * t140 / 0.5e1 + t145 * t159);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t45 + t74 + t9 * (t134 + t162);

  t167 = 0.1e1 / t26;
  t171 = t21 * t23 / 0.144e3 + 0.16925000000000000000e-2 * t167 * t28 * t30;
  t173 = t15 * t171 * t38;
  t175 = my_piecewise3(t2, 0, t94 * t173);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = t9 * t175;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t178 = 0.1e1 / t60;
  t182 = t56 * t23 / 0.144e3 + 0.16925000000000000000e-2 * t178 * t62 * t30;
  t184 = t50 * t182 * t38;
  t186 = my_piecewise3(t46, 0, t145 * t184);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = t9 * t186;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t189 = t7 * t80;
  t191 = t7 * t11;
  t196 = t6 * t11;
  t202 = 0.2e1 / 0.15e2 * t8 * t118 * t15 * t41;
  t205 = t8 * t78 * t83 * t89;
  t207 = t93 * t78;
  t208 = t207 * t108;
  t211 = 0.1e1 / t14 / t13;
  t213 = t88 * t88;
  t218 = t83 * t106;
  t219 = t38 * t88;
  t223 = t85 * t9;
  t224 = 0.1e1 / t223;
  t232 = t17 * t17;
  t248 = my_piecewise3(t2, 0, -t189 / 0.5e1 + 0.2e1 / 0.5e1 * t191 * t83 * t41 * t88 + 0.2e1 * t196 * t108 + t202 - 0.2e1 / 0.15e2 * t205 - 0.2e1 / 0.3e1 * t208 - t8 * t11 * t211 * t41 * t213 / 0.15e2 + 0.4e1 / 0.3e1 * t94 * t218 * t219 + t8 * t84 * t41 * (0.2e1 * rho[0] * t224 - 0.2e1 * t86) / 0.5e1 + t94 * t15 * (0.11e2 / 0.162e3 * sigma[0] / t19 / t232 * t23 + 0.10531111111111111111e-1 * t26 / t18 / t95 * t30) * t38);
  t252 = 0.2e1 / 0.15e2 * t47 * t118 * t50 * t70;
  t254 = 0.1e1 / t10 / t223;
  t257 = t116 * t254 * t119 * t70;
  t260 = t85 * t85;
  t262 = 0.1e1 / t10 / t260;
  t264 = 0.1e1 / t49 / t48;
  t270 = my_piecewise3(t46, 0, t252 + 0.8e1 / 0.15e2 * t257 - t7 * t146 * t262 * t264 * t70 / 0.15e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * t111 + 0.2e1 * t125 + t9 * (t248 + t270);

  t280 = t128 * t254 * t83 * t41;
  t287 = t6 * t17 * t118;
  t292 = my_piecewise3(t2, 0, -t189 / 0.10e2 + t202 - t205 / 0.15e2 - t208 / 0.3e1 - 0.2e1 / 0.5e1 * t8 * t130 + 0.7e1 / 0.15e2 * t280 + t128 * t118 * t211 * t89 / 0.15e2 - 0.2e1 / 0.3e1 * t287 * t218 * t38);
  t293 = t7 * t113;
  t296 = t119 * t70;
  t303 = t47 * t78 * t119 * t140;
  t309 = rho[1] * t224;
  t316 = t144 * t78;
  t317 = t316 * t159;
  t320 = t6 * t52 * t118;
  t321 = t119 * t157;
  t326 = my_piecewise3(t46, 0, -t293 / 0.10e2 - t7 * t118 * t296 * rho[1] / 0.5e1 + t252 + t257 / 0.15e2 - t303 / 0.15e2 + t116 * t118 * t264 * t140 / 0.15e2 + t47 * t137 * t70 * (-t86 + 0.2e1 * t309) / 0.5e1 - t317 / 0.3e1 - 0.2e1 / 0.3e1 * t320 * t321 * t38);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t111 + t125 + t134 + t162 + t9 * (t292 + t326);

  t338 = my_piecewise3(t2, 0, t202 + 0.8e1 / 0.15e2 * t280 - t7 * t95 * t262 * t211 * t41 / 0.15e2);
  t348 = t139 * t139;
  t353 = t38 * t139;
  t363 = t52 * t52;
  t379 = my_piecewise3(t46, 0, -t293 / 0.5e1 + 0.2e1 / 0.5e1 * t191 * t296 * t139 + 0.2e1 * t196 * t159 + t252 - 0.2e1 / 0.15e2 * t303 - 0.2e1 / 0.3e1 * t317 - t47 * t11 * t264 * t70 * t348 / 0.15e2 + 0.4e1 / 0.3e1 * t145 * t321 * t353 + t47 * t137 * t70 * (-0.2e1 * t86 + 0.2e1 * t309) / 0.5e1 + t145 * t50 * (0.11e2 / 0.162e3 * sigma[2] / t54 / t363 * t23 + 0.10531111111111111111e-1 * t60 / t53 / t146 * t30) * t38);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = 0.2e1 * t134 + 0.2e1 * t162 + t9 * (t338 + t379);

  t384 = t207 * t173 / 0.3e1;
  t385 = t83 * t171;
  t399 = my_piecewise3(t2, 0, t196 * t173 - t384 + 0.2e1 / 0.3e1 * t94 * t385 * t219 + t94 * t15 * (-t97 * t23 / 0.54e2 - 0.22566666666666666667e-2 * t167 * t102 * t30) * t38);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t9 * t399 + t175;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  t402 = t316 * t184 / 0.3e1;
  t403 = t119 * t182;
  t408 = my_piecewise3(t46, 0, -t402 - 0.2e1 / 0.3e1 * t320 * t403 * t38);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t9 * t408 + t186;

  t414 = my_piecewise3(t2, 0, -t384 - 0.2e1 / 0.3e1 * t287 * t385 * t38);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t9 * t414 + t175;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t430 = my_piecewise3(t46, 0, t196 * t184 - t402 + 0.2e1 / 0.3e1 * t145 * t403 * t353 + t145 * t50 * (-t148 * t23 / 0.54e2 - 0.22566666666666666667e-2 * t178 * t153 * t30) * t38);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t9 * t430 + t186;

  t441 = my_piecewise3(t2, 0, -0.38937241306206521296e-2 / t18 * t11 * t15 / t26 / sigma[0] * t30 * t38);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = t9 * t441;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  t451 = my_piecewise3(t46, 0, -0.38937241306206521296e-2 / t53 * t11 * t50 / t60 / sigma[2] * t30 * t38);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = t9 * t451;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}

