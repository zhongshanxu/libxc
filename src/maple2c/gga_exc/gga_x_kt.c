/* 
  This file was generated automatically with ./scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_kt.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 2
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC)


static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t3, t4, t5, t6, t7, t8, t9, t10;
  double t12, t13, t14, t15, t16, t17, t18, t21;
  double t24, t25, t26, t30, t34;

#ifndef XC_DONT_COMPILE_VXC
  double t35, t36, t40, t47, t48, t50, t51, t52;
  double t56, t61, t67, t70;

#ifndef XC_DONT_COMPILE_FXC
  double t88, t105, t118;
#endif

#endif

#endif


  gga_x_kt_params *params;

  assert(p->params != NULL);
  params = (gga_x_kt_params * )(p->params);

  t3 = rho[0] / 0.2e1 <= 0.101e1 * p->threshold_dens;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t6 = 0.1e1 / t5;
  t7 = t4 * t6;
  t8 = POW_1_3(rho[0]);
  t9 = t4 * t4;
  t10 = params->gamma * t9;
  t12 = POW_1_3(0.1e1 / M_PI);
  t13 = 0.1e1 / t12;
  t14 = M_CBRT4;
  t15 = t13 * t14;
  t16 = t10 * t15;
  t17 = M_CBRT2;
  t18 = t8 * rho[0];
  t21 = t17 * t17;
  t24 = t21 * t18 / 0.4e1 + params->delta;
  t25 = 0.1e1 / t24;
  t26 = sigma[0] * t25;
  t30 = 0.1e1 - t16 * t17 / t18 * t26 / 0.9e1;
  t34 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t8 * t30);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = 0.2e1 * t34;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t35 = t8 * t8;
  t36 = 0.1e1 / t35;
  t40 = rho[0] * rho[0];
  t47 = t10 * t13;
  t48 = 0.1e1 / rho[0];
  t50 = t24 * t24;
  t51 = 0.1e1 / t50;
  t52 = sigma[0] * t51;
  t56 = 0.4e1 / 0.27e2 * t16 * t17 / t8 / t40 * t26 + 0.2e1 / 0.27e2 * t47 * t14 * t48 * t52;
  t61 = my_piecewise3(t3, 0, -t7 * t36 * t30 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t8 * t56);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.2e1 * rho[0] * t61 + 0.2e1 * t34;

  t67 = t15 * t17 * t25;
  t70 = my_piecewise3(t3, 0, t6 * t48 * params->gamma * t67 / 0.8e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.2e1 * rho[0] * t70;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t88 = 0.1e1 / t40;
  t105 = my_piecewise3(t3, 0, t7 / t35 / rho[0] * t30 / 0.12e2 - t7 * t36 * t56 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t8 * (-0.28e2 / 0.81e2 * t16 * t17 / t8 / t40 / rho[0] * t26 - 0.14e2 / 0.81e2 * t47 * t14 * t88 * t52 - 0.4e1 / 0.81e2 * t16 * t36 * sigma[0] / t50 / t24 * t21));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * rho[0] * t105 + 0.4e1 * t61;

  t118 = my_piecewise3(t3, 0, -t6 * t88 * params->gamma * t67 / 0.8e1 - t6 * t36 * params->gamma * t15 * t51 / 0.12e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.2e1 * rho[0] * t118 + 0.2e1 * t70;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.0e0;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t13, t14, t15, t16;
  double t17, t20, t21, t22, t23, t24, t25, t26;
  double t28, t29, t30, t34, t35, t39, t40, t41;
  double t42, t43, t44, t45, t46, t48, t49, t50;
  double t54, t55, t59;

#ifndef XC_DONT_COMPILE_VXC
  double t60, t65, t66, t69, t71, t72, t73, t74;
  double t75, t76, t78, t79, t80, t83, t91, t92;
  double t93, t97, t98, t103, t104, t107, t108, t110;
  double t111, t112, t113, t114, t119, t122, t123, t128;
  double t129, t134, t135, t137, t138, t139, t149, t150;
  double t151, t155, t156, t161, t164, t165, t166, t169;
  double t170, t171, t174, t175, t176, t179, t180, t183;

#ifndef XC_DONT_COMPILE_FXC
  double t188, t194, t197, t200, t203, t205, t207, t216;
  double t217, t225, t237, t252, t256, t258, t261, t263;
  double t264, t266, t269, t275, t286, t299, t302, t312;
  double t320, t328, t335, t347, t355, t381, t396, t406;
  double t409, t421, t426, t434, t443, t462;
#endif

#endif

#endif


  gga_x_kt_params *params;

  assert(p->params != NULL);
  params = (gga_x_kt_params * )(p->params);

  t1 = 0.101e1 * p->threshold_dens;
  t2 = rho[0] <= t1;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t5 = 0.1e1 / t4;
  t6 = t3 * t5;
  t7 = M_CBRT2;
  t8 = t6 * t7;
  t9 = rho[0] + rho[1];
  t10 = POW_1_3(t9);
  t11 = t10 * t10;
  t12 = 0.1e1 / t11;
  t13 = rho[0] * t12;
  t14 = 0.1e1 / t9;
  t15 = rho[0] * t14;
  t16 = POW_1_3(t15);
  t17 = t3 * t3;
  t20 = POW_1_3(0.1e1 / M_PI);
  t21 = 0.1e1 / t20;
  t22 = params->gamma * t17 * t21;
  t23 = M_CBRT4;
  t24 = POW_1_3(rho[0]);
  t25 = t24 * rho[0];
  t26 = 0.1e1 / t25;
  t28 = t25 + params->delta;
  t29 = 0.1e1 / t28;
  t30 = sigma[0] * t29;
  t34 = 0.1e1 - 0.2e1 / 0.9e1 * t22 * t23 * t26 * t30;
  t35 = t16 * t34;
  t39 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t13 * t35);
  t40 = rho[1] <= t1;
  t41 = rho[1] * t12;
  t42 = rho[1] * t14;
  t43 = POW_1_3(t42);
  t44 = POW_1_3(rho[1]);
  t45 = t44 * rho[1];
  t46 = 0.1e1 / t45;
  t48 = t45 + params->delta;
  t49 = 0.1e1 / t48;
  t50 = sigma[2] * t49;
  t54 = 0.1e1 - 0.2e1 / 0.9e1 * t22 * t23 * t46 * t50;
  t55 = t43 * t54;
  t59 = my_piecewise3(t40, 0, -0.3e1 / 0.4e1 * t8 * t41 * t55);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = t39 + t59;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t60 = t12 * t16;
  t65 = 0.1e1 / t11 / t9;
  t66 = rho[0] * t65;
  t69 = t8 * t66 * t35 / 0.2e1;
  t71 = t6 * t7 * rho[0];
  t72 = t16 * t16;
  t73 = 0.1e1 / t72;
  t74 = t12 * t73;
  t75 = t9 * t9;
  t76 = 0.1e1 / t75;
  t78 = -rho[0] * t76 + t14;
  t79 = t34 * t78;
  t80 = t74 * t79;
  t83 = rho[0] * rho[0];
  t91 = t28 * t28;
  t92 = 0.1e1 / t91;
  t93 = sigma[0] * t92;
  t97 = 0.8e1 / 0.27e2 * t22 * t23 / t24 / t83 * t30 + 0.8e1 / 0.27e2 * t22 * t23 / rho[0] * t93;
  t98 = t16 * t97;
  t103 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t60 * t34 + t69 - t71 * t80 / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t13 * t98);
  t104 = rho[1] * t65;
  t107 = t8 * t104 * t55 / 0.2e1;
  t108 = rho[1] * rho[1];
  t110 = 0.1e1 / t11 / t75;
  t111 = t108 * t110;
  t112 = t43 * t43;
  t113 = 0.1e1 / t112;
  t114 = t113 * t54;
  t119 = my_piecewise3(t40, 0, t107 + t8 * t111 * t114 / 0.4e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t39 + t59 + t9 * (t103 + t119);

  t122 = t83 * t110;
  t123 = t73 * t34;
  t128 = my_piecewise3(t2, 0, t69 + t8 * t122 * t123 / 0.4e1);
  t129 = t12 * t43;
  t134 = t6 * t7 * rho[1];
  t135 = t12 * t113;
  t137 = -rho[1] * t76 + t14;
  t138 = t54 * t137;
  t139 = t135 * t138;
  t149 = t48 * t48;
  t150 = 0.1e1 / t149;
  t151 = sigma[2] * t150;
  t155 = 0.8e1 / 0.27e2 * t22 * t23 / t44 / t108 * t50 + 0.8e1 / 0.27e2 * t22 * t23 / rho[1] * t151;
  t156 = t43 * t155;
  t161 = my_piecewise3(t40, 0, -0.3e1 / 0.4e1 * t8 * t129 * t54 + t107 - t134 * t139 / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t41 * t156);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t39 + t59 + t9 * (t128 + t161);

  t164 = t5 * t7;
  t165 = 0.1e1 / t24;
  t166 = t165 * t12;
  t169 = t21 * t23;
  t170 = t169 * t29;
  t171 = t16 * params->gamma * t170;
  t174 = my_piecewise3(t2, 0, t164 * t166 * t171 / 0.2e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = t9 * t174;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t175 = 0.1e1 / t44;
  t176 = t175 * t12;
  t179 = t169 * t49;
  t180 = t43 * params->gamma * t179;
  t183 = my_piecewise3(t40, 0, t164 * t176 * t180 / 0.2e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = t9 * t183;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t188 = t8 * t65 * t16 * t34;
  t194 = rho[0] * t110;
  t197 = 0.5e1 / 0.6e1 * t8 * t194 * t35;
  t200 = t71 * t65 * t73 * t79;
  t203 = t8 * t66 * t98;
  t205 = 0.1e1 / t72 / t15;
  t207 = t78 * t78;
  t216 = t75 * t9;
  t217 = 0.1e1 / t216;
  t225 = t83 * rho[0];
  t237 = t24 * t24;
  t252 = my_piecewise3(t2, 0, t188 - t8 * t80 / 0.2e1 - 0.3e1 / 0.2e1 * t8 * t60 * t97 - t197 + t200 / 0.3e1 + t203 + t71 * t12 * t205 * t34 * t207 / 0.6e1 - t71 * t74 * t97 * t78 / 0.2e1 - t71 * t74 * t34 * (0.2e1 * rho[0] * t217 - 0.2e1 * t76) / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t13 * t16 * (-0.56e2 / 0.81e2 * t22 * t23 / t24 / t225 * t30 - 0.56e2 / 0.81e2 * t22 * t23 / t83 * t93 - 0.64e2 / 0.81e2 * t22 * t23 / t237 * sigma[0] / t91 / t28));
  t256 = 0.5e1 / 0.6e1 * t8 * rho[1] * t110 * t55;
  t258 = 0.1e1 / t11 / t216;
  t261 = t8 * t108 * t258 * t114;
  t263 = t108 * rho[1];
  t264 = t75 * t75;
  t266 = 0.1e1 / t11 / t264;
  t269 = 0.1e1 / t112 / t42;
  t275 = my_piecewise3(t40, 0, -t256 - 0.5e1 / 0.6e1 * t261 + t8 * t263 * t266 * t269 * t54 / 0.6e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * t103 + 0.2e1 * t119 + t9 * (t252 + t275);

  t286 = t8 * t83 * t258 * t123;
  t299 = my_piecewise3(t2, 0, t188 / 0.2e1 - t197 + t200 / 0.6e1 + t203 / 0.2e1 + t8 * t194 * t123 / 0.2e1 - 0.2e1 / 0.3e1 * t286 - t6 * t7 * t83 * t110 * t205 * t79 / 0.6e1 + t8 * t122 * t73 * t97 / 0.4e1);
  t302 = t8 * t65 * t43 * t54;
  t312 = t134 * t65 * t113 * t138;
  t320 = rho[1] * t217;
  t328 = t8 * t104 * t156;
  t335 = my_piecewise3(t40, 0, t302 / 0.2e1 + t8 * t110 * t113 * t54 * rho[1] / 0.4e1 - t256 - t261 / 0.6e1 + t312 / 0.6e1 - t6 * t7 * t108 * t110 * t269 * t138 / 0.6e1 - t134 * t135 * t54 * (-t76 + 0.2e1 * t320) / 0.4e1 + t328 / 0.2e1 + t8 * t111 * t113 * t155 / 0.4e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t103 + t119 + t128 + t161 + t9 * (t299 + t335);

  t347 = my_piecewise3(t2, 0, -t197 - 0.5e1 / 0.6e1 * t286 + t8 * t225 * t266 * t205 * t34 / 0.6e1);
  t355 = t137 * t137;
  t381 = t44 * t44;
  t396 = my_piecewise3(t40, 0, t302 - t8 * t139 / 0.2e1 - 0.3e1 / 0.2e1 * t8 * t129 * t155 - t256 + t312 / 0.3e1 + t328 + t134 * t12 * t269 * t54 * t355 / 0.6e1 - t134 * t135 * t155 * t137 / 0.2e1 - t134 * t135 * t54 * (-0.2e1 * t76 + 0.2e1 * t320) / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t41 * t43 * (-0.56e2 / 0.81e2 * t22 * t23 / t44 / t263 * t50 - 0.56e2 / 0.81e2 * t22 * t23 / t108 * t151 - 0.64e2 / 0.81e2 * t22 * t23 / t381 * sigma[2] / t149 / t48));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = 0.2e1 * t128 + 0.2e1 * t161 + t9 * (t347 + t396);

  t406 = t164 * t165 * t65 * t171 / 0.3e1;
  t409 = params->gamma * t21;
  t421 = my_piecewise3(t2, 0, -t164 * t26 * t12 * t171 / 0.6e1 - t406 + t164 * t166 * t73 * t409 * t23 * t29 * t78 / 0.6e1 - 0.2e1 / 0.3e1 * t164 * t60 * t409 * t23 * t92);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t9 * t421 + t174;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  t426 = t164 * t175 * t65 * t180 / 0.3e1;
  t434 = my_piecewise3(t40, 0, -t426 - t164 * t381 * t110 * t113 * params->gamma * t179 / 0.6e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t9 * t434 + t183;

  t443 = my_piecewise3(t2, 0, -t406 - t164 * t237 * t110 * t73 * params->gamma * t170 / 0.6e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t9 * t443 + t174;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t462 = my_piecewise3(t40, 0, -t164 * t46 * t12 * t180 / 0.6e1 - t426 + t164 * t176 * t113 * t409 * t23 * t49 * t137 / 0.6e1 - 0.2e1 / 0.3e1 * t164 * t129 * t409 * t23 * t150);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t9 * t462 + t183;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = 0.0e0;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}

