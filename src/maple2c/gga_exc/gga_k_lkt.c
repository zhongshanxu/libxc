/* 
  This file was generated automatically with ./scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_k_lkt.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 2
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC)


static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t3, t4, t5, t6, t8, t9, t10, t11;
  double t12, t13, t14, t16, t17, t18, t19, t21;
  double t24, t25, t26, t27, t28, t29, t30, t32;
  double t33, t34, t35, t37, t41, t45;

#ifndef XC_DONT_COMPILE_VXC
  double t46, t50, t52, t54, t58, t59, t62, t64;
  double t68, t73, t77, t81, t87, t91;

#ifndef XC_DONT_COMPILE_FXC
  double t102, t103, t104, t105, t114, t117, t119, t130;
  double t143, t156, t159, t169, t177;
#endif

#endif

#endif


  gga_k_lkt_params *params;
 
  assert(p->params != NULL);
  params = (gga_k_lkt_params * )(p->params);

  t3 = rho[0] / 0.2e1 <= 0.101e1 * p->threshold_dens;
  t4 = M_CBRT3;
  t5 = t4 * t4;
  t6 = M_CBRTPI;
  t8 = t5 * t6 * M_PI;
  t9 = POW_1_3(rho[0]);
  t10 = t9 * t9;
  t11 = M_CBRT6;
  t12 = t11 * t11;
  t13 = M_PI * M_PI;
  t14 = POW_1_3(t13);
  t16 = t12 / t14;
  t17 = sqrt(sigma[0]);
  t18 = M_CBRT2;
  t19 = t17 * t18;
  t21 = 0.1e1 / t9 / rho[0];
  t24 = t16 * t19 * t21 / 0.12e2;
  t25 = t24 < 0.200e3;
  t26 = my_piecewise3(t25, t24, 200);
  t27 = params->a * t26;
  t28 = cosh(t27);
  t29 = 0.1e1 / t28;
  t30 = t14 * t14;
  t32 = t11 / t30;
  t33 = t18 * t18;
  t34 = sigma[0] * t33;
  t35 = rho[0] * rho[0];
  t37 = 0.1e1 / t10 / t35;
  t41 = t29 + 0.5e1 / 0.72e2 * t32 * t34 * t37;
  t45 = my_piecewise3(t3, 0, 0.3e1 / 0.20e2 * t8 * t10 * t41);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = 0.2e1 * t45;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t46 = 0.1e1 / t9;
  t50 = t28 * t28;
  t52 = 0.1e1 / t50 * params->a;
  t54 = 0.1e1 / t9 / t35;
  t58 = my_piecewise3(t25, -t16 * t19 * t54 / 0.9e1, 0);
  t59 = sinh(t27);
  t62 = t35 * rho[0];
  t64 = 0.1e1 / t10 / t62;
  t68 = -t52 * t58 * t59 - 0.5e1 / 0.27e2 * t32 * t34 * t64;
  t73 = my_piecewise3(t3, 0, t8 * t46 * t41 / 0.10e2 + 0.3e1 / 0.20e2 * t8 * t10 * t68);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.2e1 * rho[0] * t73 + 0.2e1 * t45;

  t77 = 0.1e1 / t17 * t18;
  t81 = my_piecewise3(t25, t16 * t77 * t21 / 0.24e2, 0);
  t87 = -t52 * t81 * t59 + 0.5e1 / 0.72e2 * t32 * t33 * t37;
  t91 = my_piecewise3(t3, 0, 0.3e1 / 0.20e2 * t8 * t10 * t87);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.2e1 * rho[0] * t91;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t102 = params->a * params->a;
  t103 = 0.1e1 / t50 / t28 * t102;
  t104 = t58 * t58;
  t105 = t59 * t59;
  t114 = my_piecewise3(t25, 0.7e1 / 0.27e2 * t16 * t19 / t9 / t62, 0);
  t117 = t29 * t102;
  t119 = t35 * t35;
  t130 = my_piecewise3(t3, 0, -t8 * t21 * t41 / 0.30e2 + t8 * t46 * t68 / 0.5e1 + 0.3e1 / 0.20e2 * t8 * t10 * (0.2e1 * t103 * t104 * t105 - t52 * t114 * t59 - t117 * t104 + 0.55e2 / 0.81e2 * t32 * t34 / t10 / t119));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * rho[0] * t130 + 0.4e1 * t73;

  t143 = my_piecewise3(t25, -t16 * t77 * t54 / 0.18e2, 0);
  t156 = my_piecewise3(t3, 0, t8 * t46 * t87 / 0.10e2 + 0.3e1 / 0.20e2 * t8 * t10 * (0.2e1 * t103 * t81 * t105 * t58 - t52 * t143 * t59 - t117 * t81 * t58 - 0.5e1 / 0.27e2 * t32 * t33 * t64));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.2e1 * rho[0] * t156 + 0.2e1 * t91;

  t159 = t81 * t81;
  t169 = my_piecewise3(t25, -t16 / t17 / sigma[0] * t18 * t21 / 0.48e2, 0);
  t177 = my_piecewise3(t3, 0, 0.3e1 / 0.20e2 * t8 * t10 * (0.2e1 * t103 * t159 * t105 - t52 * t169 * t59 - t117 * t159));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.2e1 * rho[0] * t177;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t1, t2, t3, t4, t5, t7, t8, t9;
  double t10, t11, t12, t13, t14, t15, t16, t17;
  double t18, t20, t21, t22, t24, t27, t28, t29;
  double t30, t31, t32, t33, t35, t36, t37, t39;
  double t43, t44, t47, t48, t49, t50, t51, t52;
  double t53, t54, t55, t57, t60, t61, t62, t63;
  double t64, t65, t66, t67, t69, t73, t74, t77;

#ifndef XC_DONT_COMPILE_VXC
  double t81, t82, t83, t85, t86, t87, t88, t89;
  double t91, t92, t96, t98, t100, t104, t105, t108;
  double t110, t114, t115, t119, t120, t121, t123, t124;
  double t126, t127, t128, t133, t136, t137, t138, t142;
  double t145, t147, t148, t152, t154, t156, t160, t161;
  double t164, t166, t170, t171, t175, t178, t182, t187;
  double t188, t191, t192, t196, t201, t202, t205;

#ifndef XC_DONT_COMPILE_FXC
  double t208, t210, t220, t223, t226, t229, t231, t240;
  double t241, t251, t252, t253, t254, t263, t266, t268;
  double t279, t283, t285, t288, t291, t293, t295, t301;
  double t311, t321, t322, t325, t332, t338, t346, t352;
  double t364, t374, t391, t392, t393, t402, t405, t407;
  double t418, t425, t437, t449, t453, t458, t464, t479;
  double t491, t493, t502, t510, t511, t520, t528;
#endif

#endif

#endif


  gga_k_lkt_params *params;
 
  assert(p->params != NULL);
  params = (gga_k_lkt_params * )(p->params);

  t1 = 0.101e1 * p->threshold_dens;
  t2 = rho[0] <= t1;
  t3 = M_CBRT6;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = t7 * rho[0];
  t9 = rho[0] + rho[1];
  t10 = POW_1_3(t9);
  t11 = 0.1e1 / t10;
  t12 = 0.1e1 / t9;
  t13 = rho[0] * t12;
  t14 = POW_1_3(t13);
  t15 = t14 * t14;
  t16 = t11 * t15;
  t17 = M_PI * M_PI;
  t18 = POW_1_3(t17);
  t20 = t4 / t18;
  t21 = sqrt(sigma[0]);
  t22 = POW_1_3(rho[0]);
  t24 = 0.1e1 / t22 / rho[0];
  t27 = t20 * t21 * t24 / 0.12e2;
  t28 = t27 < 0.200e3;
  t29 = my_piecewise3(t28, t27, 200);
  t30 = params->a * t29;
  t31 = cosh(t30);
  t32 = 0.1e1 / t31;
  t33 = t18 * t18;
  t35 = t3 / t33;
  t36 = rho[0] * rho[0];
  t37 = t22 * t22;
  t39 = 0.1e1 / t37 / t36;
  t43 = t32 + 0.5e1 / 0.72e2 * t35 * sigma[0] * t39;
  t44 = t16 * t43;
  t47 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t8 * t44);
  t48 = rho[1] <= t1;
  t49 = t7 * rho[1];
  t50 = rho[1] * t12;
  t51 = POW_1_3(t50);
  t52 = t51 * t51;
  t53 = t11 * t52;
  t54 = sqrt(sigma[2]);
  t55 = POW_1_3(rho[1]);
  t57 = 0.1e1 / t55 / rho[1];
  t60 = t20 * t54 * t57 / 0.12e2;
  t61 = t60 < 0.200e3;
  t62 = my_piecewise3(t61, t60, 200);
  t63 = params->a * t62;
  t64 = cosh(t63);
  t65 = 0.1e1 / t64;
  t66 = rho[1] * rho[1];
  t67 = t55 * t55;
  t69 = 0.1e1 / t67 / t66;
  t73 = t65 + 0.5e1 / 0.72e2 * t35 * sigma[2] * t69;
  t74 = t53 * t73;
  t77 = my_piecewise3(t48, 0, 0.3e1 / 0.10e2 * t49 * t74);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = t47 + t77;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t81 = 0.1e1 / t10 / t9;
  t82 = t81 * t15;
  t83 = t82 * t43;
  t85 = t8 * t83 / 0.10e2;
  t86 = 0.1e1 / t14;
  t87 = t11 * t86;
  t88 = t9 * t9;
  t89 = 0.1e1 / t88;
  t91 = -rho[0] * t89 + t12;
  t92 = t43 * t91;
  t96 = t31 * t31;
  t98 = 0.1e1 / t96 * params->a;
  t100 = 0.1e1 / t22 / t36;
  t104 = my_piecewise3(t28, -t20 * t21 * t100 / 0.9e1, 0);
  t105 = sinh(t30);
  t108 = t36 * rho[0];
  t110 = 0.1e1 / t37 / t108;
  t114 = -t98 * t104 * t105 - 0.5e1 / 0.27e2 * t35 * sigma[0] * t110;
  t115 = t16 * t114;
  t119 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t7 * t44 - t85 + t8 * t87 * t92 / 0.5e1 + 0.3e1 / 0.10e2 * t8 * t115);
  t120 = t81 * t52;
  t121 = t120 * t73;
  t123 = t49 * t121 / 0.10e2;
  t124 = t7 * t66;
  t126 = 0.1e1 / t10 / t88;
  t127 = 0.1e1 / t51;
  t128 = t126 * t127;
  t133 = my_piecewise3(t48, 0, -t123 - t124 * t128 * t73 / 0.5e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t47 + t77 + t9 * (t119 + t133);

  t136 = t7 * t36;
  t137 = t126 * t86;
  t138 = t137 * t43;
  t142 = my_piecewise3(t2, 0, -t85 - t136 * t138 / 0.5e1);
  t145 = t11 * t127;
  t147 = -rho[1] * t89 + t12;
  t148 = t73 * t147;
  t152 = t64 * t64;
  t154 = 0.1e1 / t152 * params->a;
  t156 = 0.1e1 / t55 / t66;
  t160 = my_piecewise3(t61, -t20 * t54 * t156 / 0.9e1, 0);
  t161 = sinh(t63);
  t164 = t66 * rho[1];
  t166 = 0.1e1 / t67 / t164;
  t170 = -t154 * t160 * t161 - 0.5e1 / 0.27e2 * t35 * sigma[2] * t166;
  t171 = t53 * t170;
  t175 = my_piecewise3(t48, 0, 0.3e1 / 0.10e2 * t7 * t74 - t123 + t49 * t145 * t148 / 0.5e1 + 0.3e1 / 0.10e2 * t49 * t171);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t47 + t77 + t9 * (t142 + t175);

  t178 = 0.1e1 / t21;
  t182 = my_piecewise3(t28, t20 * t178 * t24 / 0.24e2, 0);
  t187 = -t98 * t182 * t105 + 0.5e1 / 0.72e2 * t35 * t39;
  t188 = t16 * t187;
  t191 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t8 * t188);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = t9 * t191;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t192 = 0.1e1 / t54;
  t196 = my_piecewise3(t61, t20 * t192 * t57 / 0.24e2, 0);
  t201 = -t154 * t196 * t161 + 0.5e1 / 0.72e2 * t35 * t69;
  t202 = t53 * t201;
  t205 = my_piecewise3(t48, 0, 0.3e1 / 0.10e2 * t49 * t202);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = t9 * t205;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t208 = t7 * t83;
  t210 = t7 * t11;
  t220 = 0.2e1 / 0.15e2 * t8 * t126 * t15 * t43;
  t223 = t8 * t81 * t86 * t92;
  t226 = t8 * t82 * t114;
  t229 = 0.1e1 / t14 / t13;
  t231 = t91 * t91;
  t240 = t88 * t9;
  t241 = 0.1e1 / t240;
  t251 = params->a * params->a;
  t252 = 0.1e1 / t96 / t31 * t251;
  t253 = t104 * t104;
  t254 = t105 * t105;
  t263 = my_piecewise3(t28, 0.7e1 / 0.27e2 * t20 * t21 / t22 / t108, 0);
  t266 = t32 * t251;
  t268 = t36 * t36;
  t279 = my_piecewise3(t2, 0, -t208 / 0.5e1 + 0.2e1 / 0.5e1 * t210 * t86 * t43 * t91 + 0.3e1 / 0.5e1 * t7 * t115 + t220 - 0.2e1 / 0.15e2 * t223 - t226 / 0.5e1 - t8 * t11 * t229 * t43 * t231 / 0.15e2 + 0.2e1 / 0.5e1 * t8 * t87 * t114 * t91 + t8 * t87 * t43 * (0.2e1 * rho[0] * t241 - 0.2e1 * t89) / 0.5e1 + 0.3e1 / 0.10e2 * t8 * t16 * (0.2e1 * t252 * t253 * t254 - t98 * t263 * t105 - t266 * t253 + 0.55e2 / 0.81e2 * t35 * sigma[0] / t37 / t268));
  t283 = 0.2e1 / 0.15e2 * t49 * t126 * t52 * t73;
  t285 = 0.1e1 / t10 / t240;
  t288 = t124 * t285 * t127 * t73;
  t291 = t88 * t88;
  t293 = 0.1e1 / t10 / t291;
  t295 = 0.1e1 / t51 / t50;
  t301 = my_piecewise3(t48, 0, t283 + 0.8e1 / 0.15e2 * t288 - t7 * t164 * t293 * t295 * t73 / 0.15e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * t119 + 0.2e1 * t133 + t9 * (t279 + t301);

  t311 = t136 * t285 * t86 * t43;
  t321 = my_piecewise3(t2, 0, -t208 / 0.10e2 + t220 - t223 / 0.15e2 - t226 / 0.10e2 - 0.2e1 / 0.5e1 * t8 * t138 + 0.7e1 / 0.15e2 * t311 + t136 * t126 * t229 * t92 / 0.15e2 - t136 * t137 * t114 / 0.5e1);
  t322 = t7 * t121;
  t325 = t127 * t73;
  t332 = t49 * t81 * t127 * t148;
  t338 = rho[1] * t241;
  t346 = t49 * t120 * t170;
  t352 = my_piecewise3(t48, 0, -t322 / 0.10e2 - t7 * t126 * t325 * rho[1] / 0.5e1 + t283 + t288 / 0.15e2 - t332 / 0.15e2 + t124 * t126 * t295 * t148 / 0.15e2 + t49 * t145 * t73 * (-t89 + 0.2e1 * t338) / 0.5e1 - t346 / 0.10e2 - t124 * t128 * t170 / 0.5e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t119 + t133 + t142 + t175 + t9 * (t321 + t352);

  t364 = my_piecewise3(t2, 0, t220 + 0.8e1 / 0.15e2 * t311 - t7 * t108 * t293 * t229 * t43 / 0.15e2);
  t374 = t147 * t147;
  t391 = 0.1e1 / t152 / t64 * t251;
  t392 = t160 * t160;
  t393 = t161 * t161;
  t402 = my_piecewise3(t61, 0.7e1 / 0.27e2 * t20 * t54 / t55 / t164, 0);
  t405 = t65 * t251;
  t407 = t66 * t66;
  t418 = my_piecewise3(t48, 0, -t322 / 0.5e1 + 0.2e1 / 0.5e1 * t210 * t325 * t147 + 0.3e1 / 0.5e1 * t7 * t171 + t283 - 0.2e1 / 0.15e2 * t332 - t346 / 0.5e1 - t49 * t11 * t295 * t73 * t374 / 0.15e2 + 0.2e1 / 0.5e1 * t49 * t145 * t170 * t147 + t49 * t145 * t73 * (-0.2e1 * t89 + 0.2e1 * t338) / 0.5e1 + 0.3e1 / 0.10e2 * t49 * t53 * (0.2e1 * t391 * t392 * t393 - t154 * t402 * t161 - t405 * t392 + 0.55e2 / 0.81e2 * t35 * sigma[2] / t67 / t407));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = 0.2e1 * t142 + 0.2e1 * t175 + t9 * (t364 + t418);

  t425 = t8 * t82 * t187 / 0.10e2;
  t437 = my_piecewise3(t28, -t20 * t178 * t100 / 0.18e2, 0);
  t449 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t7 * t188 - t425 + t8 * t87 * t187 * t91 / 0.5e1 + 0.3e1 / 0.10e2 * t8 * t16 * (0.2e1 * t252 * t182 * t254 * t104 - t98 * t437 * t105 - t266 * t182 * t104 - 0.5e1 / 0.27e2 * t35 * t110));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t9 * t449 + t191;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  t453 = t49 * t120 * t201 / 0.10e2;
  t458 = my_piecewise3(t48, 0, -t453 - t124 * t128 * t201 / 0.5e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t9 * t458 + t205;

  t464 = my_piecewise3(t2, 0, -t425 - t136 * t137 * t187 / 0.5e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t9 * t464 + t191;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t479 = my_piecewise3(t61, -t20 * t192 * t156 / 0.18e2, 0);
  t491 = my_piecewise3(t48, 0, 0.3e1 / 0.10e2 * t7 * t202 - t453 + t49 * t145 * t201 * t147 / 0.5e1 + 0.3e1 / 0.10e2 * t49 * t53 * (0.2e1 * t391 * t196 * t393 * t160 - t154 * t479 * t161 - t405 * t196 * t160 - 0.5e1 / 0.27e2 * t35 * t166));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t9 * t491 + t205;

  t493 = t182 * t182;
  t502 = my_piecewise3(t28, -t20 / t21 / sigma[0] * t24 / 0.48e2, 0);
  t510 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t8 * t16 * (-t98 * t502 * t105 + 0.2e1 * t252 * t493 * t254 - t266 * t493));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = t9 * t510;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  t511 = t196 * t196;
  t520 = my_piecewise3(t61, -t20 / t54 / sigma[2] * t57 / 0.48e2, 0);
  t528 = my_piecewise3(t48, 0, 0.3e1 / 0.10e2 * t49 * t53 * (-t154 * t520 * t161 + 0.2e1 * t391 * t511 * t393 - t405 * t511));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = t9 * t528;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}

