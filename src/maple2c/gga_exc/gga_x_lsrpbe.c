/* 
  This file was generated automatically with ./scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_lsrpbe.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 2
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC)


static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t3, t4, t5, t7, t8, t9, t11, t12;
  double t13, t14, t15, t16, t17, t18, t19, t20;
  double t22, t23, t28, t31, t37, t40, t44;

#ifndef XC_DONT_COMPILE_VXC
  double t45, t49, t51, t55, t57, t58, t62, t67;
  double t73, t74, t79, t83;

#ifndef XC_DONT_COMPILE_FXC
  double t94, t96, t101, t102, t103, t105, t106, t111;
  double t113, t121, t122, t124, t135, t145, t149, t167;
  double t173, t186;
#endif

#endif

#endif


  gga_x_lsrpbe_params *params;

  assert(p->params != NULL);
  params = (gga_x_lsrpbe_params * )(p->params);

  t3 = rho[0] / 0.2e1 <= 0.101e1 * p->threshold_dens;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t7 = t4 / t5;
  t8 = POW_1_3(rho[0]);
  t9 = M_CBRT6;
  t11 = M_PI * M_PI;
  t12 = POW_1_3(t11);
  t13 = t12 * t12;
  t14 = 0.1e1 / t13;
  t15 = params->mu * t9 * t14;
  t16 = M_CBRT2;
  t17 = t16 * t16;
  t18 = sigma[0] * t17;
  t19 = rho[0] * rho[0];
  t20 = t8 * t8;
  t22 = 0.1e1 / t20 / t19;
  t23 = 0.1e1 / params->kappa;
  t28 = exp(-t15 * t18 * t22 * t23 / 0.24e2);
  t31 = params->kappa + 0.1e1;
  t37 = exp(-params->alpha * t9 * t14 * t18 * t22 / 0.24e2);
  t40 = 0.1e1 + params->kappa * (0.1e1 - t28) - t31 * (0.1e1 - t37);
  t44 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t8 * t40);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = 0.2e1 * t44;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t45 = 0.1e1 / t20;
  t49 = t19 * rho[0];
  t51 = 0.1e1 / t20 / t49;
  t55 = t31 * params->alpha;
  t57 = t55 * t9 * t14;
  t58 = t51 * t37;
  t62 = -t15 * t18 * t51 * t28 / 0.9e1 + t57 * t18 * t58 / 0.9e1;
  t67 = my_piecewise3(t3, 0, -t7 * t45 * t40 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t8 * t62);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.2e1 * rho[0] * t67 + 0.2e1 * t44;

  t73 = t55 * t9;
  t74 = t14 * t17;
  t79 = t15 * t17 * t22 * t28 / 0.24e2 - t73 * t74 * t22 * t37 / 0.24e2;
  t83 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t8 * t79);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.2e1 * rho[0] * t83;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t94 = t19 * t19;
  t96 = 0.1e1 / t20 / t94;
  t101 = params->mu * params->mu;
  t102 = t9 * t9;
  t103 = t101 * t102;
  t105 = 0.1e1 / t12 / t11;
  t106 = sigma[0] * sigma[0];
  t111 = 0.1e1 / t8 / t94 / t49;
  t113 = t23 * t28;
  t121 = params->alpha * params->alpha;
  t122 = t31 * t121;
  t124 = t122 * t102 * t105;
  t135 = my_piecewise3(t3, 0, t7 / t20 / rho[0] * t40 / 0.12e2 - t7 * t45 * t62 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t8 * (0.11e2 / 0.27e2 * t15 * t18 * t96 * t28 - 0.2e1 / 0.81e2 * t103 * t105 * t106 * t16 * t111 * t113 - 0.11e2 / 0.27e2 * t57 * t18 * t96 * t37 + 0.2e1 / 0.81e2 * t124 * t106 * t16 * t111 * t37));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * rho[0] * t135 + 0.4e1 * t67;

  t145 = t105 * t16;
  t149 = 0.1e1 / t8 / t94 / t19;
  t167 = my_piecewise3(t3, 0, -t7 * t45 * t79 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t8 * (-t15 * t17 * t51 * t28 / 0.9e1 + t103 * t145 * t149 * sigma[0] * t113 / 0.108e3 + t73 * t74 * t58 / 0.9e1 - t124 * t16 * t149 * sigma[0] * t37 / 0.108e3));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.2e1 * rho[0] * t167 + 0.2e1 * t83;

  t173 = 0.1e1 / t8 / t94 / rho[0];
  t186 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t8 * (t122 * t102 * t145 * t173 * t37 / 0.288e3 - t103 * t105 * t16 * t173 * t113 / 0.288e3));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.2e1 * rho[0] * t186;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t1, t2, t3, t4, t6, t7, t8, t9;
  double t10, t11, t12, t13, t14, t15, t16, t17;
  double t18, t19, t20, t21, t22, t23, t24, t25;
  double t26, t28, t30, t34, t37, t38, t39, t43;
  double t46, t47, t51, t52, t53, t54, t55, t56;
  double t57, t58, t60, t65, t68, t72, t75, t76;
  double t80;

#ifndef XC_DONT_COMPILE_VXC
  double t81, t86, t87, t90, t92, t93, t94, t95;
  double t96, t97, t99, t100, t101, t104, t106, t111;
  double t116, t117, t122, t123, t126, t128, t129, t130;
  double t131, t132, t137, t140, t141, t146, t147, t152;
  double t153, t155, t156, t157, t160, t162, t170, t171;
  double t176, t179, t185, t186, t190, t191, t197, t198;
  double t202;

#ifndef XC_DONT_COMPILE_FXC
  double t207, t213, t216, t219, t222, t224, t226, t235;
  double t236, t244, t246, t251, t252, t255, t256, t257;
  double t260, t262, t270, t272, t284, t288, t290, t293;
  double t295, t297, t300, t306, t317, t330, t333, t343;
  double t351, t359, t366, t378, t386, t401, t403, t408;
  double t411, t413, t432, t440, t445, t451, t470, t474;
  double t480, t487, t496, t502, t521, t525, t538, t541;
  double t554;
#endif

#endif

#endif


  gga_x_lsrpbe_params *params;

  assert(p->params != NULL);
  params = (gga_x_lsrpbe_params * )(p->params);

  t1 = 0.101e1 * p->threshold_dens;
  t2 = rho[0] <= t1;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = M_CBRT2;
  t8 = t6 * t7;
  t9 = rho[0] + rho[1];
  t10 = POW_1_3(t9);
  t11 = t10 * t10;
  t12 = 0.1e1 / t11;
  t13 = rho[0] * t12;
  t14 = 0.1e1 / t9;
  t15 = rho[0] * t14;
  t16 = POW_1_3(t15);
  t17 = M_CBRT6;
  t18 = params->mu * t17;
  t19 = M_PI * M_PI;
  t20 = POW_1_3(t19);
  t21 = t20 * t20;
  t22 = 0.1e1 / t21;
  t23 = t18 * t22;
  t24 = rho[0] * rho[0];
  t25 = POW_1_3(rho[0]);
  t26 = t25 * t25;
  t28 = 0.1e1 / t26 / t24;
  t30 = 0.1e1 / params->kappa;
  t34 = exp(-t23 * sigma[0] * t28 * t30 / 0.24e2);
  t37 = params->kappa + 0.1e1;
  t38 = params->alpha * t17;
  t39 = t22 * sigma[0];
  t43 = exp(-t38 * t39 * t28 / 0.24e2);
  t46 = 0.1e1 + params->kappa * (0.1e1 - t34) - t37 * (0.1e1 - t43);
  t47 = t16 * t46;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t13 * t47);
  t52 = rho[1] <= t1;
  t53 = rho[1] * t12;
  t54 = rho[1] * t14;
  t55 = POW_1_3(t54);
  t56 = rho[1] * rho[1];
  t57 = POW_1_3(rho[1]);
  t58 = t57 * t57;
  t60 = 0.1e1 / t58 / t56;
  t65 = exp(-t23 * sigma[2] * t60 * t30 / 0.24e2);
  t68 = t22 * sigma[2];
  t72 = exp(-t38 * t68 * t60 / 0.24e2);
  t75 = 0.1e1 + params->kappa * (0.1e1 - t65) - t37 * (0.1e1 - t72);
  t76 = t55 * t75;
  t80 = my_piecewise3(t52, 0, -0.3e1 / 0.4e1 * t8 * t53 * t76);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = t51 + t80;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t81 = t12 * t16;
  t86 = 0.1e1 / t11 / t9;
  t87 = rho[0] * t86;
  t90 = t8 * t87 * t47 / 0.2e1;
  t92 = t6 * t7 * rho[0];
  t93 = t16 * t16;
  t94 = 0.1e1 / t93;
  t95 = t12 * t94;
  t96 = t9 * t9;
  t97 = 0.1e1 / t96;
  t99 = -rho[0] * t97 + t14;
  t100 = t46 * t99;
  t101 = t95 * t100;
  t104 = t24 * rho[0];
  t106 = 0.1e1 / t26 / t104;
  t111 = t37 * params->alpha * t17;
  t116 = t111 * t39 * t106 * t43 / 0.9e1 - t23 * sigma[0] * t106 * t34 / 0.9e1;
  t117 = t16 * t116;
  t122 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t81 * t46 + t90 - t92 * t101 / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t13 * t117);
  t123 = rho[1] * t86;
  t126 = t8 * t123 * t76 / 0.2e1;
  t128 = 0.1e1 / t11 / t96;
  t129 = t56 * t128;
  t130 = t55 * t55;
  t131 = 0.1e1 / t130;
  t132 = t131 * t75;
  t137 = my_piecewise3(t52, 0, t126 + t8 * t129 * t132 / 0.4e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t51 + t80 + t9 * (t122 + t137);

  t140 = t24 * t128;
  t141 = t94 * t46;
  t146 = my_piecewise3(t2, 0, t90 + t8 * t140 * t141 / 0.4e1);
  t147 = t12 * t55;
  t152 = t6 * t7 * rho[1];
  t153 = t12 * t131;
  t155 = -rho[1] * t97 + t14;
  t156 = t75 * t155;
  t157 = t153 * t156;
  t160 = t56 * rho[1];
  t162 = 0.1e1 / t58 / t160;
  t170 = t111 * t68 * t162 * t72 / 0.9e1 - t23 * sigma[2] * t162 * t65 / 0.9e1;
  t171 = t55 * t170;
  t176 = my_piecewise3(t52, 0, -0.3e1 / 0.4e1 * t8 * t147 * t75 + t126 - t152 * t157 / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t53 * t171);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t51 + t80 + t9 * (t146 + t176);

  t179 = t22 * t28;
  t185 = -t111 * t179 * t43 / 0.24e2 + t18 * t179 * t34 / 0.24e2;
  t186 = t16 * t185;
  t190 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t13 * t186);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = t9 * t190;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t191 = t22 * t60;
  t197 = -t111 * t191 * t72 / 0.24e2 + t18 * t191 * t65 / 0.24e2;
  t198 = t55 * t197;
  t202 = my_piecewise3(t52, 0, -0.3e1 / 0.4e1 * t8 * t53 * t198);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = t9 * t202;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t207 = t8 * t86 * t16 * t46;
  t213 = rho[0] * t128;
  t216 = 0.5e1 / 0.6e1 * t8 * t213 * t47;
  t219 = t92 * t86 * t94 * t100;
  t222 = t8 * t87 * t117;
  t224 = 0.1e1 / t93 / t15;
  t226 = t99 * t99;
  t235 = t96 * t9;
  t236 = 0.1e1 / t235;
  t244 = t24 * t24;
  t246 = 0.1e1 / t26 / t244;
  t251 = params->mu * params->mu;
  t252 = t17 * t17;
  t255 = 0.1e1 / t20 / t19;
  t256 = t251 * t252 * t255;
  t257 = sigma[0] * sigma[0];
  t260 = 0.1e1 / t25 / t244 / t104;
  t262 = t30 * t34;
  t270 = params->alpha * params->alpha;
  t272 = t37 * t270 * t252;
  t284 = my_piecewise3(t2, 0, t207 - t8 * t101 / 0.2e1 - 0.3e1 / 0.2e1 * t8 * t81 * t116 - t216 + t219 / 0.3e1 + t222 + t92 * t12 * t224 * t46 * t226 / 0.6e1 - t92 * t95 * t116 * t99 / 0.2e1 - t92 * t95 * t46 * (0.2e1 * rho[0] * t236 - 0.2e1 * t97) / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t13 * t16 * (0.11e2 / 0.27e2 * t23 * sigma[0] * t246 * t34 - t256 * t257 * t260 * t262 / 0.81e2 - 0.11e2 / 0.27e2 * t111 * t39 * t246 * t43 + t272 * t255 * t257 * t260 * t43 / 0.81e2));
  t288 = 0.5e1 / 0.6e1 * t8 * rho[1] * t128 * t76;
  t290 = 0.1e1 / t11 / t235;
  t293 = t8 * t56 * t290 * t132;
  t295 = t96 * t96;
  t297 = 0.1e1 / t11 / t295;
  t300 = 0.1e1 / t130 / t54;
  t306 = my_piecewise3(t52, 0, -t288 - 0.5e1 / 0.6e1 * t293 + t8 * t160 * t297 * t300 * t75 / 0.6e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * t122 + 0.2e1 * t137 + t9 * (t284 + t306);

  t317 = t8 * t24 * t290 * t141;
  t330 = my_piecewise3(t2, 0, t207 / 0.2e1 - t216 + t219 / 0.6e1 + t222 / 0.2e1 + t8 * t213 * t141 / 0.2e1 - 0.2e1 / 0.3e1 * t317 - t6 * t7 * t24 * t128 * t224 * t100 / 0.6e1 + t8 * t140 * t94 * t116 / 0.4e1);
  t333 = t8 * t86 * t55 * t75;
  t343 = t152 * t86 * t131 * t156;
  t351 = rho[1] * t236;
  t359 = t8 * t123 * t171;
  t366 = my_piecewise3(t52, 0, t333 / 0.2e1 + t8 * t128 * t131 * t75 * rho[1] / 0.4e1 - t288 - t293 / 0.6e1 + t343 / 0.6e1 - t6 * t7 * t56 * t128 * t300 * t156 / 0.6e1 - t152 * t153 * t75 * (-t97 + 0.2e1 * t351) / 0.4e1 + t359 / 0.2e1 + t8 * t129 * t131 * t170 / 0.4e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t122 + t137 + t146 + t176 + t9 * (t330 + t366);

  t378 = my_piecewise3(t2, 0, -t216 - 0.5e1 / 0.6e1 * t317 + t8 * t104 * t297 * t224 * t46 / 0.6e1);
  t386 = t155 * t155;
  t401 = t56 * t56;
  t403 = 0.1e1 / t58 / t401;
  t408 = sigma[2] * sigma[2];
  t411 = 0.1e1 / t57 / t401 / t160;
  t413 = t30 * t65;
  t432 = my_piecewise3(t52, 0, t333 - t8 * t157 / 0.2e1 - 0.3e1 / 0.2e1 * t8 * t147 * t170 - t288 + t343 / 0.3e1 + t359 + t152 * t12 * t300 * t75 * t386 / 0.6e1 - t152 * t153 * t170 * t155 / 0.2e1 - t152 * t153 * t75 * (-0.2e1 * t97 + 0.2e1 * t351) / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t53 * t55 * (0.11e2 / 0.27e2 * t23 * sigma[2] * t403 * t65 - t256 * t408 * t411 * t413 / 0.81e2 - 0.11e2 / 0.27e2 * t111 * t68 * t403 * t72 + t272 * t255 * t408 * t411 * t72 / 0.81e2));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = 0.2e1 * t146 + 0.2e1 * t176 + t9 * (t378 + t432);

  t440 = t8 * t87 * t186 / 0.2e1;
  t445 = t22 * t106;
  t451 = 0.1e1 / t25 / t244 / t24;
  t470 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t81 * t185 + t440 - t92 * t95 * t185 * t99 / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t13 * t16 * (-t18 * t445 * t34 / 0.9e1 + t256 * t451 * sigma[0] * t262 / 0.216e3 + t111 * t445 * t43 / 0.9e1 - t272 * t255 * t451 * sigma[0] * t43 / 0.216e3));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t9 * t470 + t190;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  t474 = t8 * t123 * t198 / 0.2e1;
  t480 = my_piecewise3(t52, 0, t474 + t8 * t129 * t131 * t197 / 0.4e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t9 * t480 + t202;

  t487 = my_piecewise3(t2, 0, t440 + t8 * t140 * t94 * t185 / 0.4e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t9 * t487 + t190;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t496 = t22 * t162;
  t502 = 0.1e1 / t57 / t401 / t56;
  t521 = my_piecewise3(t52, 0, -0.3e1 / 0.4e1 * t8 * t147 * t197 + t474 - t152 * t153 * t197 * t155 / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t53 * t55 * (-t18 * t496 * t65 / 0.9e1 + t256 * t502 * sigma[2] * t413 / 0.216e3 + t111 * t496 * t72 / 0.9e1 - t272 * t255 * t502 * sigma[2] * t72 / 0.216e3));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t9 * t521 + t202;

  t525 = 0.1e1 / t25 / t244 / rho[0];
  t538 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t13 * t16 * (t272 * t255 * t525 * t43 / 0.576e3 - t256 * t525 * t30 * t34 / 0.576e3));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = t9 * t538;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  t541 = 0.1e1 / t57 / t401 / rho[1];
  t554 = my_piecewise3(t52, 0, -0.3e1 / 0.4e1 * t8 * t53 * t55 * (t272 * t255 * t541 * t72 / 0.576e3 - t256 * t541 * t30 * t65 / 0.576e3));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = t9 * t554;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}

