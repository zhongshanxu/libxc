/* 
  This file was generated automatically with ./scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_optx.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 2
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC)


static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t3, t4, t5, t7, t8, t9, t10, t11;
  double t12, t13, t14, t15, t21, t22, t27, t28;
  double t29, t30, t33, t37;

#ifndef XC_DONT_COMPILE_VXC
  double t38, t46, t50, t51, t52, t54, t57, t61;
  double t66, t69, t72, t77, t81;

#ifndef XC_DONT_COMPILE_FXC
  double t92, t100, t106, t107, t108, t113, t114, t124;
  double t149, t169;
#endif

#endif

#endif


  gga_x_optx_params *params;
 
  assert(p->params != NULL);
  params = (gga_x_optx_params * )(p->params);

  t3 = rho[0] / 0.2e1 <= 0.101e1 * p->threshold_dens;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t7 = t4 / t5;
  t8 = POW_1_3(rho[0]);
  t9 = params->gamma * params->gamma;
  t10 = params->b * t9;
  t11 = sigma[0] * sigma[0];
  t12 = t10 * t11;
  t13 = M_CBRT2;
  t14 = rho[0] * rho[0];
  t15 = t14 * t14;
  t21 = t13 * t13;
  t22 = t8 * t8;
  t27 = 0.1e1 + params->gamma * sigma[0] * t21 / t22 / t14;
  t28 = t27 * t27;
  t29 = 0.1e1 / t28;
  t30 = t13 / t8 / t15 / rho[0] * t29;
  t33 = 0.2e1 * t12 * t30 + params->a;
  t37 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t8 * t33);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = 0.2e1 * t37;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t38 = 0.1e1 / t22;
  t46 = t13 / t8 / t15 / t14 * t29;
  t50 = params->b * t9 * params->gamma;
  t51 = t11 * sigma[0];
  t52 = t15 * t15;
  t54 = 0.1e1 / t52 / rho[0];
  t57 = 0.1e1 / t28 / t27;
  t61 = -0.32e2 / 0.3e1 * t12 * t46 + 0.64e2 / 0.3e1 * t50 * t51 * t54 * t57;
  t66 = my_piecewise3(t3, 0, -t7 * t38 * t33 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t8 * t61);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.2e1 * rho[0] * t66 + 0.2e1 * t37;

  t69 = t10 * sigma[0];
  t72 = 0.1e1 / t52;
  t77 = -0.8e1 * t50 * t11 * t72 * t57 + 0.4e1 * t69 * t30;
  t81 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t8 * t77);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.2e1 * rho[0] * t81;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t92 = t14 * rho[0];
  t100 = t52 * t14;
  t106 = t9 * t9;
  t107 = params->b * t106;
  t108 = t11 * t11;
  t113 = t28 * t28;
  t114 = 0.1e1 / t113;
  t124 = my_piecewise3(t3, 0, t7 / t22 / rho[0] * t33 / 0.12e2 - t7 * t38 * t61 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t8 * (0.608e3 / 0.9e1 * t12 * t13 / t8 / t15 / t92 * t29 - 0.2752e4 / 0.9e1 * t50 * t51 / t100 * t57 + 0.512e3 / 0.3e1 * t107 * t108 / t22 / t52 / t15 * t114 * t21));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * rho[0] * t124 + 0.4e1 * t66;

  t149 = my_piecewise3(t3, 0, -t7 * t38 * t77 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t8 * (-0.64e2 / 0.3e1 * t69 * t46 + 0.320e3 / 0.3e1 * t50 * t11 * t54 * t57 - 0.64e2 * t107 * t51 / t22 / t52 / t92 * t114 * t21));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.2e1 * rho[0] * t149 + 0.2e1 * t81;

  t169 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t8 * (0.4e1 * t10 * t30 - 0.32e2 * t50 * sigma[0] * t72 * t57 + 0.24e2 * t107 * t11 / t22 / t100 * t114 * t21));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.2e1 * rho[0] * t169;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t1, t2, t3, t4, t6, t7, t8, t9;
  double t10, t11, t12, t13, t14, t15, t16, t17;
  double t18, t19, t20, t21, t23, t25, t28, t32;
  double t33, t34, t37, t38, t42, t43, t44, t45;
  double t46, t47, t48, t49, t51, t53, t56, t60;
  double t61, t62, t65, t66, t70;

#ifndef XC_DONT_COMPILE_VXC
  double t71, t76, t77, t80, t82, t83, t84, t85;
  double t86, t87, t89, t90, t91, t96, t101, t102;
  double t103, t105, t108, t112, t113, t118, t119, t122;
  double t124, t125, t126, t127, t128, t133, t136, t137;
  double t142, t143, t148, t149, t151, t152, t153, t158;
  double t162, t163, t165, t168, t172, t173, t178, t184;
  double t189, t190, t194, t198, t203, t204, t208;

#ifndef XC_DONT_COMPILE_FXC
  double t213, t219, t222, t225, t228, t230, t232, t241;
  double t242, t250, t258, t264, t265, t266, t271, t272;
  double t282, t286, t288, t291, t293, t294, t296, t299;
  double t305, t316, t329, t332, t342, t350, t358, t365;
  double t377, t385, t407, t413, t418, t419, t429, t437;
  double t463, t467, t473, t480, t510, t530, t549;
#endif

#endif

#endif


  gga_x_optx_params *params;
 
  assert(p->params != NULL);
  params = (gga_x_optx_params * )(p->params);

  t1 = 0.101e1 * p->threshold_dens;
  t2 = rho[0] <= t1;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = M_CBRT2;
  t8 = t6 * t7;
  t9 = rho[0] + rho[1];
  t10 = POW_1_3(t9);
  t11 = t10 * t10;
  t12 = 0.1e1 / t11;
  t13 = rho[0] * t12;
  t14 = 0.1e1 / t9;
  t15 = rho[0] * t14;
  t16 = POW_1_3(t15);
  t17 = params->gamma * params->gamma;
  t18 = params->b * t17;
  t19 = sigma[0] * sigma[0];
  t20 = rho[0] * rho[0];
  t21 = t20 * t20;
  t23 = POW_1_3(rho[0]);
  t25 = 0.1e1 / t23 / t21 / rho[0];
  t28 = t23 * t23;
  t32 = 0.1e1 + params->gamma * sigma[0] / t28 / t20;
  t33 = t32 * t32;
  t34 = 0.1e1 / t33;
  t37 = t18 * t19 * t25 * t34 + params->a;
  t38 = t16 * t37;
  t42 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t13 * t38);
  t43 = rho[1] <= t1;
  t44 = rho[1] * t12;
  t45 = rho[1] * t14;
  t46 = POW_1_3(t45);
  t47 = sigma[2] * sigma[2];
  t48 = rho[1] * rho[1];
  t49 = t48 * t48;
  t51 = POW_1_3(rho[1]);
  t53 = 0.1e1 / t51 / t49 / rho[1];
  t56 = t51 * t51;
  t60 = 0.1e1 + params->gamma * sigma[2] / t56 / t48;
  t61 = t60 * t60;
  t62 = 0.1e1 / t61;
  t65 = t18 * t47 * t53 * t62 + params->a;
  t66 = t46 * t65;
  t70 = my_piecewise3(t43, 0, -0.3e1 / 0.4e1 * t8 * t44 * t66);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = t42 + t70;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t71 = t12 * t16;
  t76 = 0.1e1 / t11 / t9;
  t77 = rho[0] * t76;
  t80 = t8 * t77 * t38 / 0.2e1;
  t82 = t6 * t7 * rho[0];
  t83 = t16 * t16;
  t84 = 0.1e1 / t83;
  t85 = t12 * t84;
  t86 = t9 * t9;
  t87 = 0.1e1 / t86;
  t89 = -rho[0] * t87 + t14;
  t90 = t37 * t89;
  t91 = t85 * t90;
  t96 = 0.1e1 / t23 / t21 / t20;
  t101 = params->b * t17 * params->gamma;
  t102 = t19 * sigma[0];
  t103 = t21 * t21;
  t105 = 0.1e1 / t103 / rho[0];
  t108 = 0.1e1 / t33 / t32;
  t112 = 0.16e2 / 0.3e1 * t101 * t102 * t105 * t108 - 0.16e2 / 0.3e1 * t18 * t19 * t96 * t34;
  t113 = t16 * t112;
  t118 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t71 * t37 + t80 - t82 * t91 / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t13 * t113);
  t119 = rho[1] * t76;
  t122 = t8 * t119 * t66 / 0.2e1;
  t124 = 0.1e1 / t11 / t86;
  t125 = t48 * t124;
  t126 = t46 * t46;
  t127 = 0.1e1 / t126;
  t128 = t127 * t65;
  t133 = my_piecewise3(t43, 0, t122 + t8 * t125 * t128 / 0.4e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t42 + t70 + t9 * (t118 + t133);

  t136 = t20 * t124;
  t137 = t84 * t37;
  t142 = my_piecewise3(t2, 0, t80 + t8 * t136 * t137 / 0.4e1);
  t143 = t12 * t46;
  t148 = t6 * t7 * rho[1];
  t149 = t12 * t127;
  t151 = -rho[1] * t87 + t14;
  t152 = t65 * t151;
  t153 = t149 * t152;
  t158 = 0.1e1 / t51 / t49 / t48;
  t162 = t47 * sigma[2];
  t163 = t49 * t49;
  t165 = 0.1e1 / t163 / rho[1];
  t168 = 0.1e1 / t61 / t60;
  t172 = 0.16e2 / 0.3e1 * t101 * t162 * t165 * t168 - 0.16e2 / 0.3e1 * t18 * t47 * t158 * t62;
  t173 = t46 * t172;
  t178 = my_piecewise3(t43, 0, -0.3e1 / 0.4e1 * t8 * t143 * t65 + t122 - t148 * t153 / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t44 * t173);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t42 + t70 + t9 * (t142 + t178);

  t184 = 0.1e1 / t103;
  t189 = -0.2e1 * t101 * t19 * t184 * t108 + 0.2e1 * t18 * sigma[0] * t25 * t34;
  t190 = t16 * t189;
  t194 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t13 * t190);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = t9 * t194;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t198 = 0.1e1 / t163;
  t203 = -0.2e1 * t101 * t47 * t198 * t168 + 0.2e1 * t18 * sigma[2] * t53 * t62;
  t204 = t46 * t203;
  t208 = my_piecewise3(t43, 0, -0.3e1 / 0.4e1 * t8 * t44 * t204);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = t9 * t208;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t213 = t8 * t76 * t16 * t37;
  t219 = rho[0] * t124;
  t222 = 0.5e1 / 0.6e1 * t8 * t219 * t38;
  t225 = t82 * t76 * t84 * t90;
  t228 = t8 * t77 * t113;
  t230 = 0.1e1 / t83 / t15;
  t232 = t89 * t89;
  t241 = t86 * t9;
  t242 = 0.1e1 / t241;
  t250 = t20 * rho[0];
  t258 = t103 * t20;
  t264 = t17 * t17;
  t265 = params->b * t264;
  t266 = t19 * t19;
  t271 = t33 * t33;
  t272 = 0.1e1 / t271;
  t282 = my_piecewise3(t2, 0, t213 - t8 * t91 / 0.2e1 - 0.3e1 / 0.2e1 * t8 * t71 * t112 - t222 + t225 / 0.3e1 + t228 + t82 * t12 * t230 * t37 * t232 / 0.6e1 - t82 * t85 * t112 * t89 / 0.2e1 - t82 * t85 * t37 * (0.2e1 * rho[0] * t242 - 0.2e1 * t87) / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t13 * t16 * (0.304e3 / 0.9e1 * t18 * t19 / t23 / t21 / t250 * t34 - 0.688e3 / 0.9e1 * t101 * t102 / t258 * t108 + 0.128e3 / 0.3e1 * t265 * t266 / t28 / t103 / t21 * t272));
  t286 = 0.5e1 / 0.6e1 * t8 * rho[1] * t124 * t66;
  t288 = 0.1e1 / t11 / t241;
  t291 = t8 * t48 * t288 * t128;
  t293 = t48 * rho[1];
  t294 = t86 * t86;
  t296 = 0.1e1 / t11 / t294;
  t299 = 0.1e1 / t126 / t45;
  t305 = my_piecewise3(t43, 0, -t286 - 0.5e1 / 0.6e1 * t291 + t8 * t293 * t296 * t299 * t65 / 0.6e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * t118 + 0.2e1 * t133 + t9 * (t282 + t305);

  t316 = t8 * t20 * t288 * t137;
  t329 = my_piecewise3(t2, 0, t213 / 0.2e1 - t222 + t225 / 0.6e1 + t228 / 0.2e1 + t8 * t219 * t137 / 0.2e1 - 0.2e1 / 0.3e1 * t316 - t6 * t7 * t20 * t124 * t230 * t90 / 0.6e1 + t8 * t136 * t84 * t112 / 0.4e1);
  t332 = t8 * t76 * t46 * t65;
  t342 = t148 * t76 * t127 * t152;
  t350 = rho[1] * t242;
  t358 = t8 * t119 * t173;
  t365 = my_piecewise3(t43, 0, t332 / 0.2e1 + t8 * t124 * t127 * t65 * rho[1] / 0.4e1 - t286 - t291 / 0.6e1 + t342 / 0.6e1 - t6 * t7 * t48 * t124 * t299 * t152 / 0.6e1 - t148 * t149 * t65 * (-t87 + 0.2e1 * t350) / 0.4e1 + t358 / 0.2e1 + t8 * t125 * t127 * t172 / 0.4e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t118 + t133 + t142 + t178 + t9 * (t329 + t365);

  t377 = my_piecewise3(t2, 0, -t222 - 0.5e1 / 0.6e1 * t316 + t8 * t250 * t296 * t230 * t37 / 0.6e1);
  t385 = t151 * t151;
  t407 = t163 * t48;
  t413 = t47 * t47;
  t418 = t61 * t61;
  t419 = 0.1e1 / t418;
  t429 = my_piecewise3(t43, 0, t332 - t8 * t153 / 0.2e1 - 0.3e1 / 0.2e1 * t8 * t143 * t172 - t286 + t342 / 0.3e1 + t358 + t148 * t12 * t299 * t65 * t385 / 0.6e1 - t148 * t149 * t172 * t151 / 0.2e1 - t148 * t149 * t65 * (-0.2e1 * t87 + 0.2e1 * t350) / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t44 * t46 * (0.304e3 / 0.9e1 * t18 * t47 / t51 / t49 / t293 * t62 - 0.688e3 / 0.9e1 * t101 * t162 / t407 * t168 + 0.128e3 / 0.3e1 * t265 * t413 / t56 / t163 / t49 * t419));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = 0.2e1 * t142 + 0.2e1 * t178 + t9 * (t377 + t429);

  t437 = t8 * t77 * t190 / 0.2e1;
  t463 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t71 * t189 + t437 - t82 * t85 * t189 * t89 / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t13 * t16 * (-0.32e2 / 0.3e1 * t18 * sigma[0] * t96 * t34 + 0.80e2 / 0.3e1 * t101 * t19 * t105 * t108 - 0.16e2 * t265 * t102 / t28 / t103 / t250 * t272));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t9 * t463 + t194;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  t467 = t8 * t119 * t204 / 0.2e1;
  t473 = my_piecewise3(t43, 0, t467 + t8 * t125 * t127 * t203 / 0.4e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t9 * t473 + t208;

  t480 = my_piecewise3(t2, 0, t437 + t8 * t136 * t84 * t189 / 0.4e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t9 * t480 + t194;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t510 = my_piecewise3(t43, 0, -0.3e1 / 0.4e1 * t8 * t143 * t203 + t467 - t148 * t149 * t203 * t151 / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t44 * t46 * (-0.32e2 / 0.3e1 * t18 * sigma[2] * t158 * t62 + 0.80e2 / 0.3e1 * t101 * t47 * t165 * t168 - 0.16e2 * t265 * t162 / t56 / t163 / t293 * t419));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t9 * t510 + t208;

  t530 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t13 * t16 * (0.2e1 * t18 * t25 * t34 - 0.8e1 * t101 * sigma[0] * t184 * t108 + 0.6e1 * t265 * t19 / t28 / t258 * t272));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = t9 * t530;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  t549 = my_piecewise3(t43, 0, -0.3e1 / 0.4e1 * t8 * t44 * t46 * (0.2e1 * t18 * t53 * t62 - 0.8e1 * t101 * sigma[2] * t198 * t168 + 0.6e1 * t265 * t47 / t56 / t407 * t419));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = t9 * t549;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}

