/* 
  This file was generated automatically with ./scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_herman.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 2
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC)


static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t3, t4, t5, t7, t8, t9, t11, t12;
  double t14, t16, t17, t19, t20, t26, t30;

#ifndef XC_DONT_COMPILE_VXC
  double t38, t40, t44, t50, t53;

#ifndef XC_DONT_COMPILE_FXC
  double t61, t68, t73;
#endif

#endif

#endif



  t3 = rho[0] / 0.2e1 <= 0.101e1 * p->threshold_dens;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t7 = t4 / t5;
  t8 = POW_1_3(rho[0]);
  t9 = t4 * t4;
  t11 = POW_1_3(0.1e1 / M_PI);
  t12 = 0.1e1 / t11;
  t14 = M_CBRT4;
  t16 = M_CBRT2;
  t17 = t16 * t16;
  t19 = rho[0] * rho[0];
  t20 = t8 * t8;
  t26 = 0.1e1 + 0.66666666666666666668e-3 * t9 * t12 * t14 * sigma[0] * t17 / t20 / t19;
  t30 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t8 * t26);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = 0.2e1 * t30;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t38 = 0.1e1 / t8 / t19 / rho[0] * t12;
  t40 = t14 * sigma[0] * t17;
  t44 = my_piecewise3(t3, 0, -t7 / t20 * t26 / 0.8e1 + 0.13655681265105913629e-2 * t38 * t40);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.2e1 * rho[0] * t44 + 0.2e1 * t30;

  t50 = t14 * t17;
  t53 = my_piecewise3(t3, 0, -0.51208804744147176112e-3 / t8 / t19 * t12 * t50);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.2e1 * rho[0] * t53;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t61 = t19 * t19;
  t68 = my_piecewise3(t3, 0, t7 / t20 / rho[0] * t26 / 0.12e2 - 0.40967043795317740887e-2 / t8 / t61 * t12 * t40);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * rho[0] * t68 + 0.4e1 * t44;

  t73 = my_piecewise3(t3, 0, 0.11948721106967674426e-2 * t38 * t50);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.2e1 * rho[0] * t73 + 0.2e1 * t53;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.0e0;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t1, t2, t3, t4, t6, t7, t8, t9;
  double t10, t11, t12, t14, t15, t16, t17, t19;
  double t20, t21, t22, t23, t24, t25, t26, t28;
  double t32, t33, t37, t38, t40, t41, t42, t43;
  double t44, t45, t47, t51, t52, t56;

#ifndef XC_DONT_COMPILE_VXC
  double t62, t66, t68, t69, t70, t71, t72, t73;
  double t75, t76, t77, t80, t81, t82, t83, t87;
  double t91, t93, t95, t96, t97, t102, t106, t111;
  double t117, t118, t120, t121, t122, t125, t126, t127;
  double t128, t132, t137, t138, t139, t142, t145, t146;
  double t147, t150;

#ifndef XC_DONT_COMPILE_FXC
  double t155, t158, t160, t161, t168, t171, t174, t177;
  double t180, t182, t192, t193, t202, t206, t208, t211;
  double t213, t214, t216, t219, t225, t236, t245, t250;
  double t253, t263, t271, t279, t282, t287, t299, t312;
  double t329, t336, t342, t346, t354, t363, t372;
#endif

#endif

#endif



  t1 = 0.101e1 * p->threshold_dens;
  t2 = rho[0] <= t1;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = M_CBRT2;
  t8 = t6 * t7;
  t9 = rho[0] + rho[1];
  t10 = POW_1_3(t9);
  t11 = t10 * t10;
  t12 = 0.1e1 / t11;
  t14 = 0.1e1 / t9;
  t15 = rho[0] * t14;
  t16 = POW_1_3(t15);
  t17 = t3 * t3;
  t19 = POW_1_3(0.1e1 / M_PI);
  t20 = 0.1e1 / t19;
  t21 = t17 * t20;
  t22 = M_CBRT4;
  t23 = t22 * sigma[0];
  t24 = rho[0] * rho[0];
  t25 = POW_1_3(rho[0]);
  t26 = t25 * t25;
  t28 = 0.1e1 / t26 / t24;
  t32 = 0.1e1 + 0.66666666666666666668e-3 * t21 * t23 * t28;
  t33 = t16 * t32;
  t37 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * rho[0] * t12 * t33);
  t38 = rho[1] <= t1;
  t40 = rho[1] * t14;
  t41 = POW_1_3(t40);
  t42 = t22 * sigma[2];
  t43 = rho[1] * rho[1];
  t44 = POW_1_3(rho[1]);
  t45 = t44 * t44;
  t47 = 0.1e1 / t45 / t43;
  t51 = 0.1e1 + 0.66666666666666666668e-3 * t21 * t42 * t47;
  t52 = t41 * t51;
  t56 = my_piecewise3(t38, 0, -0.3e1 / 0.4e1 * t8 * rho[1] * t12 * t52);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = t37 + t56;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t62 = 0.1e1 / t11 / t9;
  t66 = t8 * rho[0] * t62 * t33 / 0.2e1;
  t68 = t6 * t7 * rho[0];
  t69 = t16 * t16;
  t70 = 0.1e1 / t69;
  t71 = t12 * t70;
  t72 = t9 * t9;
  t73 = 0.1e1 / t72;
  t75 = -rho[0] * t73 + t14;
  t76 = t32 * t75;
  t77 = t71 * t76;
  t80 = t7 * t28;
  t81 = t80 * t12;
  t82 = t16 * t20;
  t83 = t82 * t23;
  t87 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t12 * t16 * t32 + t66 - t68 * t77 / 0.4e1 + 0.27311362530211827259e-2 * t81 * t83);
  t91 = t8 * rho[1] * t62 * t52 / 0.2e1;
  t93 = 0.1e1 / t11 / t72;
  t95 = t41 * t41;
  t96 = 0.1e1 / t95;
  t97 = t96 * t51;
  t102 = my_piecewise3(t38, 0, t91 + t8 * t43 * t93 * t97 / 0.4e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t37 + t56 + t9 * (t87 + t102);

  t106 = t70 * t32;
  t111 = my_piecewise3(t2, 0, t66 + t8 * t24 * t93 * t106 / 0.4e1);
  t117 = t6 * t7 * rho[1];
  t118 = t12 * t96;
  t120 = -rho[1] * t73 + t14;
  t121 = t51 * t120;
  t122 = t118 * t121;
  t125 = t7 * t47;
  t126 = t125 * t12;
  t127 = t41 * t20;
  t128 = t127 * t42;
  t132 = my_piecewise3(t38, 0, -0.3e1 / 0.4e1 * t8 * t12 * t41 * t51 + t91 - t117 * t122 / 0.4e1 + 0.27311362530211827259e-2 * t126 * t128);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t37 + t56 + t9 * (t111 + t132);

  t137 = t7 / t26 / rho[0];
  t138 = t137 * t12;
  t139 = t82 * t22;
  t142 = my_piecewise3(t2, 0, -0.10241760948829435222e-2 * t138 * t139);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = t9 * t142;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t145 = t7 / t45 / rho[1];
  t146 = t145 * t12;
  t147 = t127 * t22;
  t150 = my_piecewise3(t38, 0, -0.10241760948829435222e-2 * t146 * t147);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = t9 * t150;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t155 = t8 * t62 * t16 * t32;
  t158 = t7 * t12;
  t160 = t20 * t22;
  t161 = t24 * rho[0];
  t168 = rho[0] * t93;
  t171 = 0.5e1 / 0.6e1 * t8 * t168 * t33;
  t174 = t68 * t62 * t70 * t76;
  t177 = t80 * t62 * t83;
  t180 = 0.1e1 / t69 / t15;
  t182 = t75 * t75;
  t192 = t72 * t9;
  t193 = 0.1e1 / t192;
  t202 = my_piecewise3(t2, 0, t155 - t8 * t77 / 0.2e1 - 0.45518937550353045432e-2 * t158 * t16 * t160 * sigma[0] / t26 / t161 - t171 + t174 / 0.3e1 - 0.36415150040282436345e-2 * t177 + t68 * t12 * t180 * t32 * t182 / 0.6e1 + 0.18207575020141218172e-2 * t80 * t71 * t160 * sigma[0] * t75 - t68 * t71 * t32 * (0.2e1 * rho[0] * t193 - 0.2e1 * t73) / 0.4e1);
  t206 = 0.5e1 / 0.6e1 * t8 * rho[1] * t93 * t52;
  t208 = 0.1e1 / t11 / t192;
  t211 = t8 * t43 * t208 * t97;
  t213 = t43 * rho[1];
  t214 = t72 * t72;
  t216 = 0.1e1 / t11 / t214;
  t219 = 0.1e1 / t95 / t40;
  t225 = my_piecewise3(t38, 0, -t206 - 0.5e1 / 0.6e1 * t211 + t8 * t213 * t216 * t219 * t51 / 0.6e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * t87 + 0.2e1 * t102 + t9 * (t202 + t225);

  t236 = t8 * t24 * t208 * t106;
  t245 = t70 * t20;
  t250 = my_piecewise3(t2, 0, t155 / 0.2e1 - t171 + t174 / 0.6e1 - 0.18207575020141218172e-2 * t177 + t8 * t168 * t106 / 0.2e1 - 0.2e1 / 0.3e1 * t236 - t6 * t7 * t24 * t93 * t180 * t76 / 0.6e1 - 0.91037875100706090862e-3 * t137 * t93 * t245 * t23);
  t253 = t8 * t62 * t41 * t51;
  t263 = t117 * t62 * t96 * t121;
  t271 = rho[1] * t193;
  t279 = t125 * t62 * t128;
  t282 = t96 * t20;
  t287 = my_piecewise3(t38, 0, t253 / 0.2e1 + t8 * t93 * t96 * t51 * rho[1] / 0.4e1 - t206 - t211 / 0.6e1 + t263 / 0.6e1 - t6 * t7 * t43 * t93 * t219 * t121 / 0.6e1 - t117 * t118 * t51 * (-t73 + 0.2e1 * t271) / 0.4e1 - 0.18207575020141218173e-2 * t279 - 0.91037875100706090863e-3 * t145 * t93 * t282 * t42);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t87 + t102 + t111 + t132 + t9 * (t250 + t287);

  t299 = my_piecewise3(t2, 0, -t171 - 0.5e1 / 0.6e1 * t236 + t8 * t161 * t216 * t180 * t32 / 0.6e1);
  t312 = t120 * t120;
  t329 = my_piecewise3(t38, 0, t253 - t8 * t122 / 0.2e1 - 0.45518937550353045432e-2 * t158 * t41 * t160 * sigma[2] / t45 / t213 - t206 + t263 / 0.3e1 - 0.36415150040282436345e-2 * t279 + t117 * t12 * t219 * t51 * t312 / 0.6e1 + 0.18207575020141218172e-2 * t125 * t118 * t160 * sigma[2] * t120 - t117 * t118 * t51 * (-0.2e1 * t73 + 0.2e1 * t271) / 0.4e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = 0.2e1 * t111 + 0.2e1 * t132 + t9 * (t299 + t329);

  t336 = 0.68278406325529568147e-3 * t137 * t62 * t139;
  t342 = my_piecewise3(t2, 0, 0.17069601581382392037e-2 * t81 * t139 + t336 - 0.34139203162764784073e-3 * t138 * t245 * t22 * t75);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t9 * t342 + t142;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  t346 = 0.68278406325529568147e-3 * t145 * t62 * t147;
  t354 = my_piecewise3(t38, 0, t346 + 0.34139203162764784073e-3 * t7 / t45 * t93 * t282 * t22);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t9 * t354 + t150;

  t363 = my_piecewise3(t2, 0, t336 + 0.34139203162764784073e-3 * t7 / t26 * t93 * t245 * t22);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t9 * t363 + t142;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t372 = my_piecewise3(t38, 0, 0.17069601581382392037e-2 * t126 * t147 + t346 - 0.34139203162764784073e-3 * t146 * t282 * t22 * t120);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t9 * t372 + t150;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = 0.0e0;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}

