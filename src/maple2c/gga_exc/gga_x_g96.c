/* 
  This file was generated automatically with ./scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_g96.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 2
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC)


static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t3, t4, t5, t6, t7, t8, t9, t11;
  double t12, t14, t15, t16, t17, t20, t21, t26;
  double t30;

#ifndef XC_DONT_COMPILE_VXC
  double t31, t36, t39, t40, t41, t45, t50, t53;
  double t56;

#ifndef XC_DONT_COMPILE_FXC
  double t64, t70, t76, t77, t83, t96, t115;
#endif

#endif

#endif



  t3 = rho[0] / 0.2e1 <= 0.101e1 * p->threshold_dens;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t6 = 0.1e1 / t5;
  t7 = t4 * t6;
  t8 = POW_1_3(rho[0]);
  t9 = t4 * t4;
  t11 = POW_1_3(0.1e1 / M_PI);
  t12 = 0.1e1 / t11;
  t14 = M_CBRT4;
  t15 = sqrt(sigma[0]);
  t16 = M_CBRT2;
  t17 = t15 * t16;
  t20 = t17 / t8 / rho[0];
  t21 = sqrt(t20);
  t26 = 0.1e1 + 0.2e1 / 0.1233e4 * t9 * t12 * t14 * t21 * t20;
  t30 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t8 * t26);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = 0.2e1 * t30;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t31 = t8 * t8;
  t36 = rho[0] * rho[0];
  t39 = t6 / t36 * t12;
  t40 = t14 * t21;
  t41 = t40 * t17;
  t45 = my_piecewise3(t3, 0, -t7 / t31 * t26 / 0.8e1 + t39 * t41 / 0.274e3);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.2e1 * rho[0] * t45 + 0.2e1 * t30;

  t50 = t6 / rho[0] * t12;
  t53 = t40 / t15 * t16;
  t56 = my_piecewise3(t3, 0, -0.3e1 / 0.2192e4 * t50 * t53);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.2e1 * rho[0] * t56;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t64 = t36 * rho[0];
  t70 = t36 * t36;
  t76 = t14 / t21;
  t77 = t16 * t16;
  t83 = my_piecewise3(t3, 0, t7 / t31 / rho[0] * t26 / 0.12e2 - 0.5e1 / 0.822e3 * t6 / t64 * t12 * t41 - t6 / t8 / t70 * t12 * t76 * sigma[0] * t77 / 0.411e3);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * rho[0] * t83 + 0.4e1 * t45;

  t96 = my_piecewise3(t3, 0, 0.3e1 / 0.2192e4 * t39 * t53 + t6 / t8 / t64 * t12 * t76 * t77 / 0.1096e4);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.2e1 * rho[0] * t96 + 0.2e1 * t56;

  t115 = my_piecewise3(t3, 0, -0.3e1 / 0.8768e4 * t6 / t8 / t36 * t12 * t76 / sigma[0] * t77 + 0.3e1 / 0.4384e4 * t50 * t40 / t15 / sigma[0] * t16);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.2e1 * rho[0] * t115;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t14, t15, t16, t17;
  double t19, t20, t21, t22, t23, t24, t26, t27;
  double t28, t33, t34, t38, t39, t41, t42, t43;
  double t44, t46, t47, t48, t53, t54, t58;

#ifndef XC_DONT_COMPILE_VXC
  double t59, t64, t68, t70, t71, t72, t73, t74;
  double t75, t77, t78, t79, t82, t83, t84, t85;
  double t86, t87, t88, t92, t96, t97, t99, t101;
  double t102, t103, t108, t111, t113, t118, t119, t124;
  double t125, t127, t128, t129, t132, t133, t134, t135;
  double t136, t137, t141, t144, t145, t146, t147, t148;
  double t149, t152, t153, t154, t155, t156, t157, t158;
  double t161;

#ifndef XC_DONT_COMPILE_FXC
  double t166, t170, t171, t178, t181, t184, t188, t191;
  double t193, t204, t205, t213, t214, t220, t226, t230;
  double t232, t235, t237, t238, t240, t243, t249, t260;
  double t270, t275, t278, t288, t296, t305, t309, t314;
  double t326, t330, t340, t357, t363, t369, t377, t393;
  double t398, t405, t413, t432, t450, t467;
#endif

#endif

#endif



  t1 = 0.101e1 * p->threshold_dens;
  t2 = rho[0] <= t1;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t5 = 0.1e1 / t4;
  t6 = t3 * t5;
  t7 = M_CBRT2;
  t8 = t6 * t7;
  t9 = rho[0] + rho[1];
  t10 = POW_1_3(t9);
  t11 = t10 * t10;
  t12 = 0.1e1 / t11;
  t14 = 0.1e1 / t9;
  t15 = rho[0] * t14;
  t16 = POW_1_3(t15);
  t17 = t3 * t3;
  t19 = POW_1_3(0.1e1 / M_PI);
  t20 = 0.1e1 / t19;
  t21 = t17 * t20;
  t22 = M_CBRT4;
  t23 = sqrt(sigma[0]);
  t24 = POW_1_3(rho[0]);
  t26 = 0.1e1 / t24 / rho[0];
  t27 = t23 * t26;
  t28 = sqrt(t27);
  t33 = 0.1e1 + 0.2e1 / 0.1233e4 * t21 * t22 * t28 * t27;
  t34 = t16 * t33;
  t38 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * rho[0] * t12 * t34);
  t39 = rho[1] <= t1;
  t41 = rho[1] * t14;
  t42 = POW_1_3(t41);
  t43 = sqrt(sigma[2]);
  t44 = POW_1_3(rho[1]);
  t46 = 0.1e1 / t44 / rho[1];
  t47 = t43 * t46;
  t48 = sqrt(t47);
  t53 = 0.1e1 + 0.2e1 / 0.1233e4 * t21 * t22 * t48 * t47;
  t54 = t42 * t53;
  t58 = my_piecewise3(t39, 0, -0.3e1 / 0.4e1 * t8 * rho[1] * t12 * t54);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = t38 + t58;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t59 = t12 * t16;
  t64 = 0.1e1 / t11 / t9;
  t68 = t8 * rho[0] * t64 * t34 / 0.2e1;
  t70 = t6 * t7 * rho[0];
  t71 = t16 * t16;
  t72 = 0.1e1 / t71;
  t73 = t12 * t72;
  t74 = t9 * t9;
  t75 = 0.1e1 / t74;
  t77 = -rho[0] * t75 + t14;
  t78 = t33 * t77;
  t79 = t73 * t78;
  t82 = t5 * t7;
  t83 = t26 * t12;
  t84 = t82 * t83;
  t85 = t16 * t20;
  t86 = t22 * t28;
  t87 = t86 * t23;
  t88 = t85 * t87;
  t92 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t59 * t33 + t68 - t70 * t79 / 0.4e1 + t84 * t88 / 0.137e3);
  t96 = t8 * rho[1] * t64 * t54 / 0.2e1;
  t97 = rho[1] * rho[1];
  t99 = 0.1e1 / t11 / t74;
  t101 = t42 * t42;
  t102 = 0.1e1 / t101;
  t103 = t102 * t53;
  t108 = my_piecewise3(t39, 0, t96 + t8 * t97 * t99 * t103 / 0.4e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t38 + t58 + t9 * (t92 + t108);

  t111 = rho[0] * rho[0];
  t113 = t72 * t33;
  t118 = my_piecewise3(t2, 0, t68 + t8 * t111 * t99 * t113 / 0.4e1);
  t119 = t12 * t42;
  t124 = t6 * t7 * rho[1];
  t125 = t12 * t102;
  t127 = -rho[1] * t75 + t14;
  t128 = t53 * t127;
  t129 = t125 * t128;
  t132 = t46 * t12;
  t133 = t82 * t132;
  t134 = t42 * t20;
  t135 = t22 * t48;
  t136 = t135 * t43;
  t137 = t134 * t136;
  t141 = my_piecewise3(t39, 0, -0.3e1 / 0.4e1 * t8 * t119 * t53 + t96 - t124 * t129 / 0.4e1 + t133 * t137 / 0.137e3);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t38 + t58 + t9 * (t118 + t141);

  t144 = 0.1e1 / t24;
  t145 = t144 * t12;
  t146 = t82 * t145;
  t147 = 0.1e1 / t23;
  t148 = t86 * t147;
  t149 = t85 * t148;
  t152 = my_piecewise3(t2, 0, -0.3e1 / 0.1096e4 * t146 * t149);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = t9 * t152;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t153 = 0.1e1 / t44;
  t154 = t153 * t12;
  t155 = t82 * t154;
  t156 = 0.1e1 / t43;
  t157 = t135 * t156;
  t158 = t134 * t157;
  t161 = my_piecewise3(t39, 0, -0.3e1 / 0.1096e4 * t155 * t158);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = t9 * t161;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t166 = t8 * t64 * t16 * t33;
  t170 = t20 * t22;
  t171 = t28 * t23;
  t178 = rho[0] * t99;
  t181 = 0.5e1 / 0.6e1 * t8 * t178 * t34;
  t184 = t70 * t64 * t72 * t78;
  t188 = t82 * t26 * t64 * t88;
  t191 = 0.1e1 / t71 / t15;
  t193 = t77 * t77;
  t204 = t74 * t9;
  t205 = 0.1e1 / t204;
  t213 = t111 * rho[0];
  t214 = t24 * t24;
  t220 = t22 / t28;
  t226 = my_piecewise3(t2, 0, t166 - t8 * t79 / 0.2e1 - t82 * t59 * t170 * t171 / t24 / t111 / 0.411e3 - t181 + t184 / 0.3e1 - 0.4e1 / 0.411e3 * t188 + t70 * t12 * t191 * t33 * t193 / 0.6e1 + 0.2e1 / 0.411e3 * t82 * t83 * t72 * t170 * t171 * t77 - t70 * t73 * t33 * (0.2e1 * rho[0] * t205 - 0.2e1 * t75) / 0.4e1 - 0.2e1 / 0.411e3 * t82 / t214 / t213 * t12 * t85 * t220 * sigma[0]);
  t230 = 0.5e1 / 0.6e1 * t8 * rho[1] * t99 * t54;
  t232 = 0.1e1 / t11 / t204;
  t235 = t8 * t97 * t232 * t103;
  t237 = t97 * rho[1];
  t238 = t74 * t74;
  t240 = 0.1e1 / t11 / t238;
  t243 = 0.1e1 / t101 / t41;
  t249 = my_piecewise3(t39, 0, -t230 - 0.5e1 / 0.6e1 * t235 + t8 * t237 * t240 * t243 * t53 / 0.6e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * t92 + 0.2e1 * t108 + t9 * (t226 + t249);

  t260 = t8 * t111 * t232 * t113;
  t270 = t72 * t20;
  t275 = my_piecewise3(t2, 0, t166 / 0.2e1 - t181 + t184 / 0.6e1 - 0.2e1 / 0.411e3 * t188 + t8 * t178 * t113 / 0.2e1 - 0.2e1 / 0.3e1 * t260 - t6 * t7 * t111 * t99 * t191 * t78 / 0.6e1 - t82 * t144 * t99 * t270 * t87 / 0.411e3);
  t278 = t8 * t64 * t42 * t53;
  t288 = t124 * t64 * t102 * t128;
  t296 = rho[1] * t205;
  t305 = t82 * t46 * t64 * t137;
  t309 = t102 * t20;
  t314 = my_piecewise3(t39, 0, t278 / 0.2e1 + t8 * t99 * t102 * t53 * rho[1] / 0.4e1 - t230 - t235 / 0.6e1 + t288 / 0.6e1 - t6 * t7 * t97 * t99 * t243 * t128 / 0.6e1 - t124 * t125 * t53 * (-t75 + 0.2e1 * t296) / 0.4e1 - 0.2e1 / 0.411e3 * t305 - t82 * t153 * t99 * t309 * t136 / 0.411e3);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t92 + t108 + t118 + t141 + t9 * (t275 + t314);

  t326 = my_piecewise3(t2, 0, -t181 - 0.5e1 / 0.6e1 * t260 + t8 * t213 * t240 * t191 * t33 / 0.6e1);
  t330 = t48 * t43;
  t340 = t127 * t127;
  t357 = t44 * t44;
  t363 = t22 / t48;
  t369 = my_piecewise3(t39, 0, t278 - t8 * t129 / 0.2e1 - t82 * t119 * t170 * t330 / t44 / t97 / 0.411e3 - t230 + t288 / 0.3e1 - 0.4e1 / 0.411e3 * t305 + t124 * t12 * t243 * t53 * t340 / 0.6e1 + 0.2e1 / 0.411e3 * t82 * t132 * t102 * t170 * t330 * t127 - t124 * t125 * t53 * (-0.2e1 * t75 + 0.2e1 * t296) / 0.4e1 - 0.2e1 / 0.411e3 * t82 / t357 / t237 * t12 * t134 * t363 * sigma[2]);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = 0.2e1 * t118 + 0.2e1 * t141 + t9 * (t326 + t369);

  t377 = t82 * t144 * t64 * t149 / 0.548e3;
  t393 = my_piecewise3(t2, 0, t84 * t149 / 0.1096e4 + t377 - t82 * t145 * t72 * t170 * t28 * t147 * t77 / 0.1096e4 + t82 / t214 / t111 * t12 * t85 * t220 / 0.548e3);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t9 * t393 + t152;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  t398 = t82 * t153 * t64 * t158 / 0.548e3;
  t405 = my_piecewise3(t39, 0, t398 + t82 * t357 * t99 * t309 * t157 / 0.1096e4);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t9 * t405 + t161;

  t413 = my_piecewise3(t2, 0, t377 + t82 * t214 * t99 * t270 * t148 / 0.1096e4);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t9 * t413 + t152;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t432 = my_piecewise3(t39, 0, t133 * t158 / 0.1096e4 + t398 - t82 * t154 * t102 * t170 * t48 * t156 * t127 / 0.1096e4 + t82 / t357 / t97 * t12 * t134 * t363 / 0.548e3);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t9 * t432 + t161;

  t450 = my_piecewise3(t2, 0, -0.3e1 / 0.4384e4 * t82 / t214 / rho[0] * t12 * t85 * t220 / sigma[0] + 0.3e1 / 0.2192e4 * t146 * t85 * t86 / t23 / sigma[0]);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = t9 * t450;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  t467 = my_piecewise3(t39, 0, -0.3e1 / 0.4384e4 * t82 / t357 / rho[1] * t12 * t134 * t363 / sigma[2] + 0.3e1 / 0.2192e4 * t155 * t134 * t135 / t43 / sigma[2]);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = t9 * t467;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}

