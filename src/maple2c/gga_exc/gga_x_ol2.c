/* 
  This file was generated automatically with ./scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_ol2.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 2
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC)


static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t3, t4, t5, t7, t8, t9, t10, t11;
  double t12, t13, t15, t16, t19, t20, t22, t27;
  double t28, t29, t31, t35;

#ifndef XC_DONT_COMPILE_VXC
  double t36, t40, t42, t43, t49, t52, t53, t54;
  double t58, t63, t66, t69, t70, t73, t77, t81;

#ifndef XC_DONT_COMPILE_FXC
  double t92, t95, t107, t112, t121, t145, t165;
#endif

#endif

#endif


  gga_x_ol2_params *params;

  assert(p->params != NULL);
  params = (gga_x_ol2_params * )(p->params);

  t3 = rho[0] / 0.2e1 <= 0.101e1 * p->threshold_dens;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t7 = t4 / t5;
  t8 = POW_1_3(rho[0]);
  t9 = params->bb * sigma[0];
  t10 = M_CBRT2;
  t11 = t10 * t10;
  t12 = rho[0] * rho[0];
  t13 = t8 * t8;
  t15 = 0.1e1 / t13 / t12;
  t16 = t11 * t15;
  t19 = sqrt(sigma[0]);
  t20 = params->cc * t19;
  t22 = 0.1e1 / t8 / rho[0];
  t27 = 0.4e1 * t19 * t10 * t22 + t10;
  t28 = 0.1e1 / t27;
  t29 = t10 * t22 * t28;
  t31 = params->aa + 0.13888888888888888889e-1 * t9 * t16 + t20 * t29;
  t35 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t8 * t31);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = 0.2e1 * t35;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t36 = 0.1e1 / t13;
  t40 = t12 * rho[0];
  t42 = 0.1e1 / t13 / t40;
  t43 = t11 * t42;
  t49 = t10 / t8 / t12 * t28;
  t52 = params->cc * sigma[0];
  t53 = t27 * t27;
  t54 = 0.1e1 / t53;
  t58 = -0.37037037037037037037e-1 * t9 * t43 - 0.4e1 / 0.3e1 * t20 * t49 + 0.16e2 / 0.3e1 * t52 * t43 * t54;
  t63 = my_piecewise3(t3, 0, -t7 * t36 * t31 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t8 * t58);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.2e1 * rho[0] * t63 + 0.2e1 * t35;

  t66 = params->bb * t11;
  t69 = 0.1e1 / t19;
  t70 = params->cc * t69;
  t73 = params->cc * t11;
  t77 = 0.13888888888888888889e-1 * t66 * t15 + t70 * t29 / 0.2e1 - 0.2e1 * t73 * t15 * t54;
  t81 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t8 * t77);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.2e1 * rho[0] * t81;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t92 = t12 * t12;
  t95 = t11 / t13 / t92;
  t107 = t19 * sigma[0];
  t112 = 0.1e1 / t53 / t27;
  t121 = my_piecewise3(t3, 0, t7 / t13 / rho[0] * t31 / 0.12e2 - t7 * t36 * t58 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t8 * (0.13580246913580246914e0 * t9 * t95 + 0.28e2 / 0.9e1 * t20 * t10 / t8 / t40 * t28 - 0.80e2 / 0.3e1 * t52 * t95 * t54 + 0.1024e4 / 0.9e1 * params->cc * t107 / t92 / t12 * t112));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * rho[0] * t121 + 0.4e1 * t63;

  t145 = my_piecewise3(t3, 0, -t7 * t36 * t77 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t8 * (-0.37037037037037037037e-1 * t66 * t42 - 0.2e1 / 0.3e1 * t70 * t49 + 0.8e1 * t73 * t42 * t54 - 0.128e3 / 0.3e1 * params->cc / t92 / rho[0] * t112 * t19));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.2e1 * rho[0] * t145 + 0.2e1 * t81;

  t165 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t8 * (-params->cc / t107 * t29 / 0.4e1 - params->cc / sigma[0] * t16 * t54 + 0.16e2 * params->cc / t92 * t112 * t69));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.2e1 * rho[0] * t165;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t1, t2, t3, t4, t6, t7, t8, t9;
  double t10, t11, t12, t13, t14, t15, t16, t17;
  double t18, t19, t20, t22, t25, t26, t28, t31;
  double t32, t33, t35, t36, t40, t41, t42, t43;
  double t44, t45, t46, t47, t48, t50, t53, t54;
  double t56, t59, t60, t61, t63, t64, t68;

#ifndef XC_DONT_COMPILE_VXC
  double t69, t74, t75, t78, t80, t81, t82, t83;
  double t84, t85, t87, t88, t89, t92, t94, t99;
  double t102, t103, t104, t108, t109, t114, t115, t118;
  double t120, t121, t122, t123, t124, t129, t132, t133;
  double t138, t139, t144, t145, t147, t148, t149, t152;
  double t154, t159, t162, t163, t164, t168, t169, t174;
  double t179, t180, t186, t187, t191, t194, t195, t201;
  double t202, t206;

#ifndef XC_DONT_COMPILE_FXC
  double t211, t217, t220, t223, t226, t228, t230, t239;
  double t240, t248, t250, t261, t266, t276, t280, t282;
  double t285, t287, t289, t292, t298, t309, t322, t325;
  double t335, t343, t351, t358, t370, t378, t393, t395;
  double t406, t411, t421, t429, t453, t457, t463, t470;
  double t498, t518, t537;
#endif

#endif

#endif


  gga_x_ol2_params *params;

  assert(p->params != NULL);
  params = (gga_x_ol2_params * )(p->params);

  t1 = 0.101e1 * p->threshold_dens;
  t2 = rho[0] <= t1;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = M_CBRT2;
  t8 = t6 * t7;
  t9 = rho[0] + rho[1];
  t10 = POW_1_3(t9);
  t11 = t10 * t10;
  t12 = 0.1e1 / t11;
  t13 = rho[0] * t12;
  t14 = 0.1e1 / t9;
  t15 = rho[0] * t14;
  t16 = POW_1_3(t15);
  t17 = params->bb * sigma[0];
  t18 = rho[0] * rho[0];
  t19 = POW_1_3(rho[0]);
  t20 = t19 * t19;
  t22 = 0.1e1 / t20 / t18;
  t25 = sqrt(sigma[0]);
  t26 = params->cc * t25;
  t28 = 0.1e1 / t19 / rho[0];
  t31 = 0.4e1 * t25 * t28 + t7;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t35 = params->aa + 0.13888888888888888889e-1 * t17 * t22 + t26 * t33;
  t36 = t16 * t35;
  t40 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t13 * t36);
  t41 = rho[1] <= t1;
  t42 = rho[1] * t12;
  t43 = rho[1] * t14;
  t44 = POW_1_3(t43);
  t45 = params->bb * sigma[2];
  t46 = rho[1] * rho[1];
  t47 = POW_1_3(rho[1]);
  t48 = t47 * t47;
  t50 = 0.1e1 / t48 / t46;
  t53 = sqrt(sigma[2]);
  t54 = params->cc * t53;
  t56 = 0.1e1 / t47 / rho[1];
  t59 = 0.4e1 * t53 * t56 + t7;
  t60 = 0.1e1 / t59;
  t61 = t56 * t60;
  t63 = params->aa + 0.13888888888888888889e-1 * t45 * t50 + t54 * t61;
  t64 = t44 * t63;
  t68 = my_piecewise3(t41, 0, -0.3e1 / 0.4e1 * t8 * t42 * t64);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = t40 + t68;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t69 = t12 * t16;
  t74 = 0.1e1 / t11 / t9;
  t75 = rho[0] * t74;
  t78 = t8 * t75 * t36 / 0.2e1;
  t80 = t6 * t7 * rho[0];
  t81 = t16 * t16;
  t82 = 0.1e1 / t81;
  t83 = t12 * t82;
  t84 = t9 * t9;
  t85 = 0.1e1 / t84;
  t87 = -rho[0] * t85 + t14;
  t88 = t35 * t87;
  t89 = t83 * t88;
  t92 = t18 * rho[0];
  t94 = 0.1e1 / t20 / t92;
  t99 = 0.1e1 / t19 / t18 * t32;
  t102 = params->cc * sigma[0];
  t103 = t31 * t31;
  t104 = 0.1e1 / t103;
  t108 = -0.37037037037037037037e-1 * t17 * t94 - 0.4e1 / 0.3e1 * t26 * t99 + 0.16e2 / 0.3e1 * t102 * t94 * t104;
  t109 = t16 * t108;
  t114 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t69 * t35 + t78 - t80 * t89 / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t13 * t109);
  t115 = rho[1] * t74;
  t118 = t8 * t115 * t64 / 0.2e1;
  t120 = 0.1e1 / t11 / t84;
  t121 = t46 * t120;
  t122 = t44 * t44;
  t123 = 0.1e1 / t122;
  t124 = t123 * t63;
  t129 = my_piecewise3(t41, 0, t118 + t8 * t121 * t124 / 0.4e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t40 + t68 + t9 * (t114 + t129);

  t132 = t18 * t120;
  t133 = t82 * t35;
  t138 = my_piecewise3(t2, 0, t78 + t8 * t132 * t133 / 0.4e1);
  t139 = t12 * t44;
  t144 = t6 * t7 * rho[1];
  t145 = t12 * t123;
  t147 = -rho[1] * t85 + t14;
  t148 = t63 * t147;
  t149 = t145 * t148;
  t152 = t46 * rho[1];
  t154 = 0.1e1 / t48 / t152;
  t159 = 0.1e1 / t47 / t46 * t60;
  t162 = params->cc * sigma[2];
  t163 = t59 * t59;
  t164 = 0.1e1 / t163;
  t168 = -0.37037037037037037037e-1 * t45 * t154 - 0.4e1 / 0.3e1 * t54 * t159 + 0.16e2 / 0.3e1 * t162 * t154 * t164;
  t169 = t44 * t168;
  t174 = my_piecewise3(t41, 0, -0.3e1 / 0.4e1 * t8 * t139 * t63 + t118 - t144 * t149 / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t42 * t169);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t40 + t68 + t9 * (t138 + t174);

  t179 = 0.1e1 / t25;
  t180 = params->cc * t179;
  t186 = 0.13888888888888888889e-1 * params->bb * t22 + t180 * t33 / 0.2e1 - 0.2e1 * params->cc * t22 * t104;
  t187 = t16 * t186;
  t191 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t13 * t187);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = t9 * t191;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t194 = 0.1e1 / t53;
  t195 = params->cc * t194;
  t201 = 0.13888888888888888889e-1 * params->bb * t50 + t195 * t61 / 0.2e1 - 0.2e1 * params->cc * t50 * t164;
  t202 = t44 * t201;
  t206 = my_piecewise3(t41, 0, -0.3e1 / 0.4e1 * t8 * t42 * t202);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = t9 * t206;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t211 = t8 * t74 * t16 * t35;
  t217 = rho[0] * t120;
  t220 = 0.5e1 / 0.6e1 * t8 * t217 * t36;
  t223 = t80 * t74 * t82 * t88;
  t226 = t8 * t75 * t109;
  t228 = 0.1e1 / t81 / t15;
  t230 = t87 * t87;
  t239 = t84 * t9;
  t240 = 0.1e1 / t239;
  t248 = t18 * t18;
  t250 = 0.1e1 / t20 / t248;
  t261 = t25 * sigma[0];
  t266 = 0.1e1 / t103 / t31;
  t276 = my_piecewise3(t2, 0, t211 - t8 * t89 / 0.2e1 - 0.3e1 / 0.2e1 * t8 * t69 * t108 - t220 + t223 / 0.3e1 + t226 + t80 * t12 * t228 * t35 * t230 / 0.6e1 - t80 * t83 * t108 * t87 / 0.2e1 - t80 * t83 * t35 * (0.2e1 * rho[0] * t240 - 0.2e1 * t85) / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t13 * t16 * (0.13580246913580246914e0 * t17 * t250 + 0.28e2 / 0.9e1 * t26 / t19 / t92 * t32 - 0.80e2 / 0.3e1 * t102 * t250 * t104 + 0.512e3 / 0.9e1 * params->cc * t261 / t248 / t18 * t266));
  t280 = 0.5e1 / 0.6e1 * t8 * rho[1] * t120 * t64;
  t282 = 0.1e1 / t11 / t239;
  t285 = t8 * t46 * t282 * t124;
  t287 = t84 * t84;
  t289 = 0.1e1 / t11 / t287;
  t292 = 0.1e1 / t122 / t43;
  t298 = my_piecewise3(t41, 0, -t280 - 0.5e1 / 0.6e1 * t285 + t8 * t152 * t289 * t292 * t63 / 0.6e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * t114 + 0.2e1 * t129 + t9 * (t276 + t298);

  t309 = t8 * t18 * t282 * t133;
  t322 = my_piecewise3(t2, 0, t211 / 0.2e1 - t220 + t223 / 0.6e1 + t226 / 0.2e1 + t8 * t217 * t133 / 0.2e1 - 0.2e1 / 0.3e1 * t309 - t6 * t7 * t18 * t120 * t228 * t88 / 0.6e1 + t8 * t132 * t82 * t108 / 0.4e1);
  t325 = t8 * t74 * t44 * t63;
  t335 = t144 * t74 * t123 * t148;
  t343 = rho[1] * t240;
  t351 = t8 * t115 * t169;
  t358 = my_piecewise3(t41, 0, t325 / 0.2e1 + t8 * t120 * t123 * t63 * rho[1] / 0.4e1 - t280 - t285 / 0.6e1 + t335 / 0.6e1 - t6 * t7 * t46 * t120 * t292 * t148 / 0.6e1 - t144 * t145 * t63 * (-t85 + 0.2e1 * t343) / 0.4e1 + t351 / 0.2e1 + t8 * t121 * t123 * t168 / 0.4e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t114 + t129 + t138 + t174 + t9 * (t322 + t358);

  t370 = my_piecewise3(t2, 0, -t220 - 0.5e1 / 0.6e1 * t309 + t8 * t92 * t289 * t228 * t35 / 0.6e1);
  t378 = t147 * t147;
  t393 = t46 * t46;
  t395 = 0.1e1 / t48 / t393;
  t406 = t53 * sigma[2];
  t411 = 0.1e1 / t163 / t59;
  t421 = my_piecewise3(t41, 0, t325 - t8 * t149 / 0.2e1 - 0.3e1 / 0.2e1 * t8 * t139 * t168 - t280 + t335 / 0.3e1 + t351 + t144 * t12 * t292 * t63 * t378 / 0.6e1 - t144 * t145 * t168 * t147 / 0.2e1 - t144 * t145 * t63 * (-0.2e1 * t85 + 0.2e1 * t343) / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t42 * t44 * (0.13580246913580246914e0 * t45 * t395 + 0.28e2 / 0.9e1 * t54 / t47 / t152 * t60 - 0.80e2 / 0.3e1 * t162 * t395 * t164 + 0.512e3 / 0.9e1 * params->cc * t406 / t393 / t46 * t411));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = 0.2e1 * t138 + 0.2e1 * t174 + t9 * (t370 + t421);

  t429 = t8 * t75 * t187 / 0.2e1;
  t453 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t69 * t186 + t429 - t80 * t83 * t186 * t87 / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t13 * t16 * (-0.37037037037037037037e-1 * params->bb * t94 - 0.2e1 / 0.3e1 * t180 * t99 + 0.8e1 * params->cc * t94 * t104 - 0.64e2 / 0.3e1 * params->cc / t248 / rho[0] * t266 * t25));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t9 * t453 + t191;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  t457 = t8 * t115 * t202 / 0.2e1;
  t463 = my_piecewise3(t41, 0, t457 + t8 * t121 * t123 * t201 / 0.4e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t9 * t463 + t206;

  t470 = my_piecewise3(t2, 0, t429 + t8 * t132 * t82 * t186 / 0.4e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t9 * t470 + t191;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t498 = my_piecewise3(t41, 0, -0.3e1 / 0.4e1 * t8 * t139 * t201 + t457 - t144 * t145 * t201 * t147 / 0.4e1 - 0.3e1 / 0.4e1 * t8 * t42 * t44 * (-0.37037037037037037037e-1 * params->bb * t154 - 0.2e1 / 0.3e1 * t195 * t159 + 0.8e1 * params->cc * t154 * t164 - 0.64e2 / 0.3e1 * params->cc / t393 / rho[1] * t411 * t53));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t9 * t498 + t206;

  t518 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t13 * t16 * (-params->cc / t261 * t33 / 0.4e1 - params->cc / sigma[0] * t22 * t104 + 0.8e1 * params->cc / t248 * t266 * t179));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = t9 * t518;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  t537 = my_piecewise3(t41, 0, -0.3e1 / 0.4e1 * t8 * t42 * t44 * (-params->cc / t406 * t61 / 0.4e1 - params->cc / sigma[2] * t50 * t164 + 0.8e1 * params->cc / t393 * t411 * t194));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = t9 * t537;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}

