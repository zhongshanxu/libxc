/* 
  This file was generated automatically with ./scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_k_ol2.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 2
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC)


static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t3, t4, t5, t6, t8, t9, t10, t11;
  double t12, t13, t14, t16, t17, t20, t21, t23;
  double t28, t29, t30, t32, t36;

#ifndef XC_DONT_COMPILE_VXC
  double t37, t41, t43, t44, t50, t53, t54, t55;
  double t59, t64, t67, t70, t71, t74, t78, t82;

#ifndef XC_DONT_COMPILE_FXC
  double t91, t94, t106, t111, t120, t144, t164;
#endif

#endif

#endif


  gga_k_ol2_params *params;

  assert(p->params != NULL);
  params = (gga_k_ol2_params * )(p->params);

  t3 = rho[0] / 0.2e1 <= 0.101e1 * p->threshold_dens;
  t4 = M_CBRT3;
  t5 = t4 * t4;
  t6 = M_CBRTPI;
  t8 = t5 * t6 * M_PI;
  t9 = POW_1_3(rho[0]);
  t10 = t9 * t9;
  t11 = params->bb * sigma[0];
  t12 = M_CBRT2;
  t13 = t12 * t12;
  t14 = rho[0] * rho[0];
  t16 = 0.1e1 / t10 / t14;
  t17 = t13 * t16;
  t20 = sqrt(sigma[0]);
  t21 = params->cc * t20;
  t23 = 0.1e1 / t9 / rho[0];
  t28 = 0.4e1 * t20 * t12 * t23 + t12;
  t29 = 0.1e1 / t28;
  t30 = t12 * t23 * t29;
  t32 = params->aa + 0.13888888888888888889e-1 * t11 * t17 + t21 * t30;
  t36 = my_piecewise3(t3, 0, 0.3e1 / 0.20e2 * t8 * t10 * t32);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = 0.2e1 * t36;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t37 = 0.1e1 / t9;
  t41 = t14 * rho[0];
  t43 = 0.1e1 / t10 / t41;
  t44 = t13 * t43;
  t50 = t12 / t9 / t14 * t29;
  t53 = params->cc * sigma[0];
  t54 = t28 * t28;
  t55 = 0.1e1 / t54;
  t59 = -0.37037037037037037037e-1 * t11 * t44 - 0.4e1 / 0.3e1 * t21 * t50 + 0.16e2 / 0.3e1 * t53 * t44 * t55;
  t64 = my_piecewise3(t3, 0, t8 * t37 * t32 / 0.10e2 + 0.3e1 / 0.20e2 * t8 * t10 * t59);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.2e1 * rho[0] * t64 + 0.2e1 * t36;

  t67 = params->bb * t13;
  t70 = 0.1e1 / t20;
  t71 = params->cc * t70;
  t74 = params->cc * t13;
  t78 = 0.13888888888888888889e-1 * t67 * t16 + t71 * t30 / 0.2e1 - 0.2e1 * t74 * t16 * t55;
  t82 = my_piecewise3(t3, 0, 0.3e1 / 0.20e2 * t8 * t10 * t78);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.2e1 * rho[0] * t82;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t91 = t14 * t14;
  t94 = t13 / t10 / t91;
  t106 = t20 * sigma[0];
  t111 = 0.1e1 / t54 / t28;
  t120 = my_piecewise3(t3, 0, -t8 * t23 * t32 / 0.30e2 + t8 * t37 * t59 / 0.5e1 + 0.3e1 / 0.20e2 * t8 * t10 * (0.13580246913580246914e0 * t11 * t94 + 0.28e2 / 0.9e1 * t21 * t12 / t9 / t41 * t29 - 0.80e2 / 0.3e1 * t53 * t94 * t55 + 0.1024e4 / 0.9e1 * params->cc * t106 / t91 / t14 * t111));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * rho[0] * t120 + 0.4e1 * t64;

  t144 = my_piecewise3(t3, 0, t8 * t37 * t78 / 0.10e2 + 0.3e1 / 0.20e2 * t8 * t10 * (-0.37037037037037037037e-1 * t67 * t43 - 0.2e1 / 0.3e1 * t71 * t50 + 0.8e1 * t74 * t43 * t55 - 0.128e3 / 0.3e1 * params->cc / t91 / rho[0] * t111 * t20));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.2e1 * rho[0] * t144 + 0.2e1 * t82;

  t164 = my_piecewise3(t3, 0, 0.3e1 / 0.20e2 * t8 * t10 * (-params->cc / t106 * t30 / 0.4e1 - params->cc / sigma[0] * t17 * t55 + 0.16e2 * params->cc / t91 * t111 * t70));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.2e1 * rho[0] * t164;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t1, t2, t3, t4, t5, t7, t8, t9;
  double t10, t11, t12, t13, t14, t15, t16, t17;
  double t18, t19, t20, t22, t25, t26, t28, t29;
  double t32, t33, t34, t36, t37, t40, t41, t42;
  double t43, t44, t45, t46, t47, t48, t49, t50;
  double t52, t55, t56, t58, t61, t62, t63, t65;
  double t66, t69;

#ifndef XC_DONT_COMPILE_VXC
  double t73, t74, t75, t77, t78, t79, t80, t81;
  double t83, t84, t88, t90, t95, t98, t99, t100;
  double t104, t105, t109, t110, t111, t113, t114, t116;
  double t117, t118, t123, t126, t127, t128, t132, t135;
  double t137, t138, t142, t144, t149, t152, t153, t154;
  double t158, t159, t163, t168, t169, t175, t176, t179;
  double t182, t183, t189, t190, t193;

#ifndef XC_DONT_COMPILE_FXC
  double t196, t198, t208, t211, t214, t217, t219, t228;
  double t229, t237, t239, t250, t255, t264, t268, t270;
  double t273, t276, t278, t280, t286, t296, t306, t307;
  double t310, t317, t323, t331, t337, t349, t359, t374;
  double t376, t387, t392, t401, t408, t431, t435, t440;
  double t446, t472, t491, t509;
#endif

#endif

#endif


  gga_k_ol2_params *params;

  assert(p->params != NULL);
  params = (gga_k_ol2_params * )(p->params);

  t1 = 0.101e1 * p->threshold_dens;
  t2 = rho[0] <= t1;
  t3 = M_CBRT6;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = t7 * rho[0];
  t9 = rho[0] + rho[1];
  t10 = POW_1_3(t9);
  t11 = 0.1e1 / t10;
  t12 = 0.1e1 / t9;
  t13 = rho[0] * t12;
  t14 = POW_1_3(t13);
  t15 = t14 * t14;
  t16 = t11 * t15;
  t17 = params->bb * sigma[0];
  t18 = rho[0] * rho[0];
  t19 = POW_1_3(rho[0]);
  t20 = t19 * t19;
  t22 = 0.1e1 / t20 / t18;
  t25 = sqrt(sigma[0]);
  t26 = params->cc * t25;
  t28 = 0.1e1 / t19 / rho[0];
  t29 = M_CBRT2;
  t32 = 0.4e1 * t25 * t28 + t29;
  t33 = 0.1e1 / t32;
  t34 = t28 * t33;
  t36 = params->aa + 0.13888888888888888889e-1 * t17 * t22 + t26 * t34;
  t37 = t16 * t36;
  t40 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t8 * t37);
  t41 = rho[1] <= t1;
  t42 = t7 * rho[1];
  t43 = rho[1] * t12;
  t44 = POW_1_3(t43);
  t45 = t44 * t44;
  t46 = t11 * t45;
  t47 = params->bb * sigma[2];
  t48 = rho[1] * rho[1];
  t49 = POW_1_3(rho[1]);
  t50 = t49 * t49;
  t52 = 0.1e1 / t50 / t48;
  t55 = sqrt(sigma[2]);
  t56 = params->cc * t55;
  t58 = 0.1e1 / t49 / rho[1];
  t61 = 0.4e1 * t55 * t58 + t29;
  t62 = 0.1e1 / t61;
  t63 = t58 * t62;
  t65 = params->aa + 0.13888888888888888889e-1 * t47 * t52 + t56 * t63;
  t66 = t46 * t65;
  t69 = my_piecewise3(t41, 0, 0.3e1 / 0.10e2 * t42 * t66);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = t40 + t69;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t73 = 0.1e1 / t10 / t9;
  t74 = t73 * t15;
  t75 = t74 * t36;
  t77 = t8 * t75 / 0.10e2;
  t78 = 0.1e1 / t14;
  t79 = t11 * t78;
  t80 = t9 * t9;
  t81 = 0.1e1 / t80;
  t83 = -rho[0] * t81 + t12;
  t84 = t36 * t83;
  t88 = t18 * rho[0];
  t90 = 0.1e1 / t20 / t88;
  t95 = 0.1e1 / t19 / t18 * t33;
  t98 = params->cc * sigma[0];
  t99 = t32 * t32;
  t100 = 0.1e1 / t99;
  t104 = -0.37037037037037037037e-1 * t17 * t90 - 0.4e1 / 0.3e1 * t26 * t95 + 0.16e2 / 0.3e1 * t98 * t90 * t100;
  t105 = t16 * t104;
  t109 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t7 * t37 - t77 + t8 * t79 * t84 / 0.5e1 + 0.3e1 / 0.10e2 * t8 * t105);
  t110 = t73 * t45;
  t111 = t110 * t65;
  t113 = t42 * t111 / 0.10e2;
  t114 = t7 * t48;
  t116 = 0.1e1 / t10 / t80;
  t117 = 0.1e1 / t44;
  t118 = t116 * t117;
  t123 = my_piecewise3(t41, 0, -t113 - t114 * t118 * t65 / 0.5e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t40 + t69 + t9 * (t109 + t123);

  t126 = t7 * t18;
  t127 = t116 * t78;
  t128 = t127 * t36;
  t132 = my_piecewise3(t2, 0, -t77 - t126 * t128 / 0.5e1);
  t135 = t11 * t117;
  t137 = -rho[1] * t81 + t12;
  t138 = t65 * t137;
  t142 = t48 * rho[1];
  t144 = 0.1e1 / t50 / t142;
  t149 = 0.1e1 / t49 / t48 * t62;
  t152 = params->cc * sigma[2];
  t153 = t61 * t61;
  t154 = 0.1e1 / t153;
  t158 = -0.37037037037037037037e-1 * t47 * t144 - 0.4e1 / 0.3e1 * t56 * t149 + 0.16e2 / 0.3e1 * t152 * t144 * t154;
  t159 = t46 * t158;
  t163 = my_piecewise3(t41, 0, 0.3e1 / 0.10e2 * t7 * t66 - t113 + t42 * t135 * t138 / 0.5e1 + 0.3e1 / 0.10e2 * t42 * t159);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t40 + t69 + t9 * (t132 + t163);

  t168 = 0.1e1 / t25;
  t169 = params->cc * t168;
  t175 = 0.13888888888888888889e-1 * params->bb * t22 + t169 * t34 / 0.2e1 - 0.2e1 * params->cc * t22 * t100;
  t176 = t16 * t175;
  t179 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t8 * t176);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = t9 * t179;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t182 = 0.1e1 / t55;
  t183 = params->cc * t182;
  t189 = 0.13888888888888888889e-1 * params->bb * t52 + t183 * t63 / 0.2e1 - 0.2e1 * params->cc * t52 * t154;
  t190 = t46 * t189;
  t193 = my_piecewise3(t41, 0, 0.3e1 / 0.10e2 * t42 * t190);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = t9 * t193;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t196 = t7 * t75;
  t198 = t7 * t11;
  t208 = 0.2e1 / 0.15e2 * t8 * t116 * t15 * t36;
  t211 = t8 * t73 * t78 * t84;
  t214 = t8 * t74 * t104;
  t217 = 0.1e1 / t14 / t13;
  t219 = t83 * t83;
  t228 = t80 * t9;
  t229 = 0.1e1 / t228;
  t237 = t18 * t18;
  t239 = 0.1e1 / t20 / t237;
  t250 = t25 * sigma[0];
  t255 = 0.1e1 / t99 / t32;
  t264 = my_piecewise3(t2, 0, -t196 / 0.5e1 + 0.2e1 / 0.5e1 * t198 * t78 * t36 * t83 + 0.3e1 / 0.5e1 * t7 * t105 + t208 - 0.2e1 / 0.15e2 * t211 - t214 / 0.5e1 - t8 * t11 * t217 * t36 * t219 / 0.15e2 + 0.2e1 / 0.5e1 * t8 * t79 * t104 * t83 + t8 * t79 * t36 * (0.2e1 * rho[0] * t229 - 0.2e1 * t81) / 0.5e1 + 0.3e1 / 0.10e2 * t8 * t16 * (0.13580246913580246914e0 * t17 * t239 + 0.28e2 / 0.9e1 * t26 / t19 / t88 * t33 - 0.80e2 / 0.3e1 * t98 * t239 * t100 + 0.512e3 / 0.9e1 * params->cc * t250 / t237 / t18 * t255));
  t268 = 0.2e1 / 0.15e2 * t42 * t116 * t45 * t65;
  t270 = 0.1e1 / t10 / t228;
  t273 = t114 * t270 * t117 * t65;
  t276 = t80 * t80;
  t278 = 0.1e1 / t10 / t276;
  t280 = 0.1e1 / t44 / t43;
  t286 = my_piecewise3(t41, 0, t268 + 0.8e1 / 0.15e2 * t273 - t7 * t142 * t278 * t280 * t65 / 0.15e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * t109 + 0.2e1 * t123 + t9 * (t264 + t286);

  t296 = t126 * t270 * t78 * t36;
  t306 = my_piecewise3(t2, 0, -t196 / 0.10e2 + t208 - t211 / 0.15e2 - t214 / 0.10e2 - 0.2e1 / 0.5e1 * t8 * t128 + 0.7e1 / 0.15e2 * t296 + t126 * t116 * t217 * t84 / 0.15e2 - t126 * t127 * t104 / 0.5e1);
  t307 = t7 * t111;
  t310 = t117 * t65;
  t317 = t42 * t73 * t117 * t138;
  t323 = rho[1] * t229;
  t331 = t42 * t110 * t158;
  t337 = my_piecewise3(t41, 0, -t307 / 0.10e2 - t7 * t116 * t310 * rho[1] / 0.5e1 + t268 + t273 / 0.15e2 - t317 / 0.15e2 + t114 * t116 * t280 * t138 / 0.15e2 + t42 * t135 * t65 * (-t81 + 0.2e1 * t323) / 0.5e1 - t331 / 0.10e2 - t114 * t118 * t158 / 0.5e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t109 + t123 + t132 + t163 + t9 * (t306 + t337);

  t349 = my_piecewise3(t2, 0, t208 + 0.8e1 / 0.15e2 * t296 - t7 * t88 * t278 * t217 * t36 / 0.15e2);
  t359 = t137 * t137;
  t374 = t48 * t48;
  t376 = 0.1e1 / t50 / t374;
  t387 = t55 * sigma[2];
  t392 = 0.1e1 / t153 / t61;
  t401 = my_piecewise3(t41, 0, -t307 / 0.5e1 + 0.2e1 / 0.5e1 * t198 * t310 * t137 + 0.3e1 / 0.5e1 * t7 * t159 + t268 - 0.2e1 / 0.15e2 * t317 - t331 / 0.5e1 - t42 * t11 * t280 * t65 * t359 / 0.15e2 + 0.2e1 / 0.5e1 * t42 * t135 * t158 * t137 + t42 * t135 * t65 * (-0.2e1 * t81 + 0.2e1 * t323) / 0.5e1 + 0.3e1 / 0.10e2 * t42 * t46 * (0.13580246913580246914e0 * t47 * t376 + 0.28e2 / 0.9e1 * t56 / t49 / t142 * t62 - 0.80e2 / 0.3e1 * t152 * t376 * t154 + 0.512e3 / 0.9e1 * params->cc * t387 / t374 / t48 * t392));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = 0.2e1 * t132 + 0.2e1 * t163 + t9 * (t349 + t401);

  t408 = t8 * t74 * t175 / 0.10e2;
  t431 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t7 * t176 - t408 + t8 * t79 * t175 * t83 / 0.5e1 + 0.3e1 / 0.10e2 * t8 * t16 * (-0.37037037037037037037e-1 * params->bb * t90 - 0.2e1 / 0.3e1 * t169 * t95 + 0.8e1 * params->cc * t90 * t100 - 0.64e2 / 0.3e1 * params->cc / t237 / rho[0] * t255 * t25));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t9 * t431 + t179;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  t435 = t42 * t110 * t189 / 0.10e2;
  t440 = my_piecewise3(t41, 0, -t435 - t114 * t118 * t189 / 0.5e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t9 * t440 + t193;

  t446 = my_piecewise3(t2, 0, -t408 - t126 * t127 * t175 / 0.5e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t9 * t446 + t179;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t472 = my_piecewise3(t41, 0, 0.3e1 / 0.10e2 * t7 * t190 - t435 + t42 * t135 * t189 * t137 / 0.5e1 + 0.3e1 / 0.10e2 * t42 * t46 * (-0.37037037037037037037e-1 * params->bb * t144 - 0.2e1 / 0.3e1 * t183 * t149 + 0.8e1 * params->cc * t144 * t154 - 0.64e2 / 0.3e1 * params->cc / t374 / rho[1] * t392 * t55));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t9 * t472 + t193;

  t491 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t8 * t16 * (-params->cc / t250 * t34 / 0.4e1 - params->cc / sigma[0] * t22 * t100 + 0.8e1 * params->cc / t237 * t255 * t168));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = t9 * t491;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  t509 = my_piecewise3(t41, 0, 0.3e1 / 0.10e2 * t42 * t46 * (-params->cc / t387 * t63 / 0.4e1 - params->cc / sigma[2] * t52 * t154 + 0.8e1 * params->cc / t374 * t392 * t182));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = t9 * t509;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}

