/* 
  This file was generated automatically with ./scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_k_pearson.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 2
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC)


static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t3, t4, t5, t6, t8, t9, t10, t11;
  double t12, t13, t14, t16, t17, t18, t19, t20;
  double t24, t25, t26, t27, t28, t29, t30, t34;
  double t35, t36, t39, t43;

#ifndef XC_DONT_COMPILE_VXC
  double t44, t48, t52, t55, t56, t59, t61, t62;
  double t63, t67, t72, t80, t85, t89;

#ifndef XC_DONT_COMPILE_FXC
  double t115, t122, t124, t133, t141, t160, t181;
#endif

#endif

#endif



  t3 = rho[0] / 0.2e1 <= 0.101e1 * p->threshold_dens;
  t4 = M_CBRT3;
  t5 = t4 * t4;
  t6 = M_CBRTPI;
  t8 = t5 * t6 * M_PI;
  t9 = POW_1_3(rho[0]);
  t10 = t9 * t9;
  t11 = M_CBRT6;
  t12 = M_PI * M_PI;
  t13 = POW_1_3(t12);
  t14 = t13 * t13;
  t16 = t11 / t14;
  t17 = t16 * sigma[0];
  t18 = M_CBRT2;
  t19 = t18 * t18;
  t20 = rho[0] * rho[0];
  t24 = t12 * t12;
  t25 = 0.1e1 / t24;
  t26 = sigma[0] * sigma[0];
  t27 = t26 * sigma[0];
  t28 = t25 * t27;
  t29 = t20 * t20;
  t30 = t29 * t29;
  t34 = 0.1e1 + t28 / t30 / 0.576e3;
  t35 = 0.1e1 / t34;
  t36 = t19 / t10 / t20 * t35;
  t39 = 0.1e1 + 0.5e1 / 0.648e3 * t17 * t36;
  t43 = my_piecewise3(t3, 0, 0.3e1 / 0.20e2 * t8 * t10 * t39);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = 0.2e1 * t43;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t44 = 0.1e1 / t9;
  t48 = t20 * rho[0];
  t52 = t19 / t10 / t48 * t35;
  t55 = t26 * t26;
  t56 = t16 * t55;
  t59 = 0.1e1 / t10 / t30 / t48;
  t61 = t34 * t34;
  t62 = 0.1e1 / t61;
  t63 = t62 * t25;
  t67 = -0.5e1 / 0.243e3 * t17 * t52 + 0.5e1 / 0.46656e5 * t56 * t19 * t59 * t63;
  t72 = my_piecewise3(t3, 0, t8 * t44 * t39 / 0.10e2 + 0.3e1 / 0.20e2 * t8 * t10 * t67);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.2e1 * rho[0] * t72 + 0.2e1 * t43;

  t80 = 0.1e1 / t10 / t30 / t20;
  t85 = 0.5e1 / 0.648e3 * t16 * t36 - 0.5e1 / 0.124416e6 * t16 * t27 * t19 * t80 * t63;
  t89 = my_piecewise3(t3, 0, 0.3e1 / 0.20e2 * t8 * t10 * t85);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.2e1 * rho[0] * t89;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t115 = t30 * t30;
  t122 = t24 * t24;
  t124 = 0.1e1 / t61 / t34 / t122;
  t133 = my_piecewise3(t3, 0, -t8 / t9 / rho[0] * t39 / 0.30e2 + t8 * t44 * t67 / 0.5e1 + 0.3e1 / 0.20e2 * t8 * t10 * (0.55e2 / 0.729e3 * t17 * t19 / t10 / t29 * t35 - 0.215e3 / 0.139968e6 * t56 * t19 / t10 / t30 / t29 * t63 + 0.5e1 / 0.1679616e7 * t16 * t55 * t27 * t19 / t10 / t115 / t29 * t124));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * rho[0] * t133 + 0.4e1 * t72;

  t141 = t16 * t19;
  t160 = my_piecewise3(t3, 0, t8 * t44 * t85 / 0.10e2 + 0.3e1 / 0.20e2 * t8 * t10 * (-0.5e1 / 0.243e3 * t16 * t52 + 0.25e2 / 0.46656e5 * t141 * t59 * t62 * t28 - 0.5e1 / 0.4478976e7 * t16 * t55 * t26 * t19 / t10 / t115 / t48 * t124));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.2e1 * rho[0] * t160 + 0.2e1 * t89;

  t181 = my_piecewise3(t3, 0, 0.3e1 / 0.20e2 * t8 * t10 * (-0.5e1 / 0.31104e5 * t141 * t80 * t62 * t25 * t26 + 0.5e1 / 0.11943936e8 * t16 * t55 * sigma[0] * t19 / t10 / t115 / t20 * t124));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.2e1 * rho[0] * t181;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t1, t2, t3, t4, t5, t7, t8, t9;
  double t10, t11, t12, t13, t14, t15, t16, t17;
  double t18, t19, t21, t22, t23, t24, t26, t28;
  double t29, t30, t31, t33, t34, t38, t39, t43;
  double t44, t47, t48, t49, t50, t51, t52, t53;
  double t54, t55, t56, t58, t60, t61, t63, t64;
  double t68, t69, t73, t74, t77;

#ifndef XC_DONT_COMPILE_VXC
  double t81, t82, t83, t85, t86, t87, t88, t89;
  double t91, t92, t96, t98, t103, t104, t107, t108;
  double t109, t114, t115, t119, t120, t121, t123, t124;
  double t126, t127, t128, t133, t136, t137, t138, t142;
  double t145, t147, t148, t152, t154, t159, t160, t163;
  double t164, t165, t170, t171, t175, t184, t189, t190;
  double t193, t200, t205, t206, t209;

#ifndef XC_DONT_COMPILE_FXC
  double t212, t214, t224, t227, t230, t233, t235, t244;
  double t245, t268, t273, t275, t276, t285, t289, t291;
  double t294, t297, t299, t301, t307, t317, t327, t328;
  double t331, t338, t344, t352, t358, t370, t380, t410;
  double t415, t425, t432, t441, t459, t463, t468, t474;
  double t486, t504, t523, t541;
#endif

#endif

#endif



  t1 = 0.101e1 * p->threshold_dens;
  t2 = rho[0] <= t1;
  t3 = M_CBRT6;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = t7 * rho[0];
  t9 = rho[0] + rho[1];
  t10 = POW_1_3(t9);
  t11 = 0.1e1 / t10;
  t12 = 0.1e1 / t9;
  t13 = rho[0] * t12;
  t14 = POW_1_3(t13);
  t15 = t14 * t14;
  t16 = t11 * t15;
  t17 = M_PI * M_PI;
  t18 = POW_1_3(t17);
  t19 = t18 * t18;
  t21 = t3 / t19;
  t22 = rho[0] * rho[0];
  t23 = POW_1_3(rho[0]);
  t24 = t23 * t23;
  t26 = 0.1e1 / t24 / t22;
  t28 = t17 * t17;
  t29 = 0.1e1 / t28;
  t30 = sigma[0] * sigma[0];
  t31 = t30 * sigma[0];
  t33 = t22 * t22;
  t34 = t33 * t33;
  t38 = 0.1e1 + t29 * t31 / t34 / 0.2304e4;
  t39 = 0.1e1 / t38;
  t43 = 0.1e1 + 0.5e1 / 0.648e3 * t21 * sigma[0] * t26 * t39;
  t44 = t16 * t43;
  t47 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t8 * t44);
  t48 = rho[1] <= t1;
  t49 = t7 * rho[1];
  t50 = rho[1] * t12;
  t51 = POW_1_3(t50);
  t52 = t51 * t51;
  t53 = t11 * t52;
  t54 = rho[1] * rho[1];
  t55 = POW_1_3(rho[1]);
  t56 = t55 * t55;
  t58 = 0.1e1 / t56 / t54;
  t60 = sigma[2] * sigma[2];
  t61 = t60 * sigma[2];
  t63 = t54 * t54;
  t64 = t63 * t63;
  t68 = 0.1e1 + t29 * t61 / t64 / 0.2304e4;
  t69 = 0.1e1 / t68;
  t73 = 0.1e1 + 0.5e1 / 0.648e3 * t21 * sigma[2] * t58 * t69;
  t74 = t53 * t73;
  t77 = my_piecewise3(t48, 0, 0.3e1 / 0.10e2 * t49 * t74);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = t47 + t77;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t81 = 0.1e1 / t10 / t9;
  t82 = t81 * t15;
  t83 = t82 * t43;
  t85 = t8 * t83 / 0.10e2;
  t86 = 0.1e1 / t14;
  t87 = t11 * t86;
  t88 = t9 * t9;
  t89 = 0.1e1 / t88;
  t91 = -rho[0] * t89 + t12;
  t92 = t43 * t91;
  t96 = t22 * rho[0];
  t98 = 0.1e1 / t24 / t96;
  t103 = t30 * t30;
  t104 = t21 * t103;
  t107 = 0.1e1 / t24 / t34 / t96;
  t108 = t38 * t38;
  t109 = 0.1e1 / t108;
  t114 = -0.5e1 / 0.243e3 * t21 * sigma[0] * t98 * t39 + 0.5e1 / 0.186624e6 * t104 * t107 * t109 * t29;
  t115 = t16 * t114;
  t119 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t7 * t44 - t85 + t8 * t87 * t92 / 0.5e1 + 0.3e1 / 0.10e2 * t8 * t115);
  t120 = t81 * t52;
  t121 = t120 * t73;
  t123 = t49 * t121 / 0.10e2;
  t124 = t7 * t54;
  t126 = 0.1e1 / t10 / t88;
  t127 = 0.1e1 / t51;
  t128 = t126 * t127;
  t133 = my_piecewise3(t48, 0, -t123 - t124 * t128 * t73 / 0.5e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t47 + t77 + t9 * (t119 + t133);

  t136 = t7 * t22;
  t137 = t126 * t86;
  t138 = t137 * t43;
  t142 = my_piecewise3(t2, 0, -t85 - t136 * t138 / 0.5e1);
  t145 = t11 * t127;
  t147 = -rho[1] * t89 + t12;
  t148 = t73 * t147;
  t152 = t54 * rho[1];
  t154 = 0.1e1 / t56 / t152;
  t159 = t60 * t60;
  t160 = t21 * t159;
  t163 = 0.1e1 / t56 / t64 / t152;
  t164 = t68 * t68;
  t165 = 0.1e1 / t164;
  t170 = -0.5e1 / 0.243e3 * t21 * sigma[2] * t154 * t69 + 0.5e1 / 0.186624e6 * t160 * t163 * t165 * t29;
  t171 = t53 * t170;
  t175 = my_piecewise3(t48, 0, 0.3e1 / 0.10e2 * t7 * t74 - t123 + t49 * t145 * t148 / 0.5e1 + 0.3e1 / 0.10e2 * t49 * t171);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t47 + t77 + t9 * (t142 + t175);

  t184 = 0.1e1 / t24 / t34 / t22;
  t189 = 0.5e1 / 0.648e3 * t21 * t26 * t39 - 0.5e1 / 0.497664e6 * t21 * t31 * t184 * t109 * t29;
  t190 = t16 * t189;
  t193 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t8 * t190);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = t9 * t193;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t200 = 0.1e1 / t56 / t64 / t54;
  t205 = 0.5e1 / 0.648e3 * t21 * t58 * t69 - 0.5e1 / 0.497664e6 * t21 * t61 * t200 * t165 * t29;
  t206 = t53 * t205;
  t209 = my_piecewise3(t48, 0, 0.3e1 / 0.10e2 * t49 * t206);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = t9 * t209;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t212 = t7 * t83;
  t214 = t7 * t11;
  t224 = 0.2e1 / 0.15e2 * t8 * t126 * t15 * t43;
  t227 = t8 * t81 * t86 * t92;
  t230 = t8 * t82 * t114;
  t233 = 0.1e1 / t14 / t13;
  t235 = t91 * t91;
  t244 = t88 * t9;
  t245 = 0.1e1 / t244;
  t268 = t34 * t34;
  t273 = 0.1e1 / t108 / t38;
  t275 = t28 * t28;
  t276 = 0.1e1 / t275;
  t285 = my_piecewise3(t2, 0, -t212 / 0.5e1 + 0.2e1 / 0.5e1 * t214 * t86 * t43 * t91 + 0.3e1 / 0.5e1 * t7 * t115 + t224 - 0.2e1 / 0.15e2 * t227 - t230 / 0.5e1 - t8 * t11 * t233 * t43 * t235 / 0.15e2 + 0.2e1 / 0.5e1 * t8 * t87 * t114 * t91 + t8 * t87 * t43 * (0.2e1 * rho[0] * t245 - 0.2e1 * t89) / 0.5e1 + 0.3e1 / 0.10e2 * t8 * t16 * (0.55e2 / 0.729e3 * t21 * sigma[0] / t24 / t33 * t39 - 0.215e3 / 0.559872e6 * t104 / t24 / t34 / t33 * t109 * t29 + 0.5e1 / 0.26873856e8 * t21 * t103 * t31 / t24 / t268 / t33 * t273 * t276));
  t289 = 0.2e1 / 0.15e2 * t49 * t126 * t52 * t73;
  t291 = 0.1e1 / t10 / t244;
  t294 = t124 * t291 * t127 * t73;
  t297 = t88 * t88;
  t299 = 0.1e1 / t10 / t297;
  t301 = 0.1e1 / t51 / t50;
  t307 = my_piecewise3(t48, 0, t289 + 0.8e1 / 0.15e2 * t294 - t7 * t152 * t299 * t301 * t73 / 0.15e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * t119 + 0.2e1 * t133 + t9 * (t285 + t307);

  t317 = t136 * t291 * t86 * t43;
  t327 = my_piecewise3(t2, 0, -t212 / 0.10e2 + t224 - t227 / 0.15e2 - t230 / 0.10e2 - 0.2e1 / 0.5e1 * t8 * t138 + 0.7e1 / 0.15e2 * t317 + t136 * t126 * t233 * t92 / 0.15e2 - t136 * t137 * t114 / 0.5e1);
  t328 = t7 * t121;
  t331 = t127 * t73;
  t338 = t49 * t81 * t127 * t148;
  t344 = rho[1] * t245;
  t352 = t49 * t120 * t170;
  t358 = my_piecewise3(t48, 0, -t328 / 0.10e2 - t7 * t126 * t331 * rho[1] / 0.5e1 + t289 + t294 / 0.15e2 - t338 / 0.15e2 + t124 * t126 * t301 * t148 / 0.15e2 + t49 * t145 * t73 * (-t89 + 0.2e1 * t344) / 0.5e1 - t352 / 0.10e2 - t124 * t128 * t170 / 0.5e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t119 + t133 + t142 + t175 + t9 * (t327 + t358);

  t370 = my_piecewise3(t2, 0, t224 + 0.8e1 / 0.15e2 * t317 - t7 * t96 * t299 * t233 * t43 / 0.15e2);
  t380 = t147 * t147;
  t410 = t64 * t64;
  t415 = 0.1e1 / t164 / t68;
  t425 = my_piecewise3(t48, 0, -t328 / 0.5e1 + 0.2e1 / 0.5e1 * t214 * t331 * t147 + 0.3e1 / 0.5e1 * t7 * t171 + t289 - 0.2e1 / 0.15e2 * t338 - t352 / 0.5e1 - t49 * t11 * t301 * t73 * t380 / 0.15e2 + 0.2e1 / 0.5e1 * t49 * t145 * t170 * t147 + t49 * t145 * t73 * (-0.2e1 * t89 + 0.2e1 * t344) / 0.5e1 + 0.3e1 / 0.10e2 * t49 * t53 * (0.55e2 / 0.729e3 * t21 * sigma[2] / t56 / t63 * t69 - 0.215e3 / 0.559872e6 * t160 / t56 / t64 / t63 * t165 * t29 + 0.5e1 / 0.26873856e8 * t21 * t159 * t61 / t56 / t410 / t63 * t415 * t276));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = 0.2e1 * t142 + 0.2e1 * t175 + t9 * (t370 + t425);

  t432 = t8 * t82 * t189 / 0.10e2;
  t441 = t109 * t29;
  t459 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t7 * t190 - t432 + t8 * t87 * t189 * t91 / 0.5e1 + 0.3e1 / 0.10e2 * t8 * t16 * (-0.5e1 / 0.243e3 * t21 * t98 * t39 + 0.25e2 / 0.186624e6 * t21 * t107 * t441 * t31 - 0.5e1 / 0.71663616e8 * t21 * t103 * t30 / t24 / t268 / t96 * t273 * t276));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t9 * t459 + t193;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  t463 = t49 * t120 * t205 / 0.10e2;
  t468 = my_piecewise3(t48, 0, -t463 - t124 * t128 * t205 / 0.5e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t9 * t468 + t209;

  t474 = my_piecewise3(t2, 0, -t432 - t136 * t137 * t189 / 0.5e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t9 * t474 + t193;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t486 = t165 * t29;
  t504 = my_piecewise3(t48, 0, 0.3e1 / 0.10e2 * t7 * t206 - t463 + t49 * t145 * t205 * t147 / 0.5e1 + 0.3e1 / 0.10e2 * t49 * t53 * (-0.5e1 / 0.243e3 * t21 * t154 * t69 + 0.25e2 / 0.186624e6 * t21 * t163 * t486 * t61 - 0.5e1 / 0.71663616e8 * t21 * t159 * t60 / t56 / t410 / t152 * t415 * t276));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t9 * t504 + t209;

  t523 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t8 * t16 * (-0.5e1 / 0.124416e6 * t21 * t184 * t441 * t30 + 0.5e1 / 0.191102976e9 * t21 * t103 * sigma[0] / t24 / t268 / t22 * t273 * t276));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = t9 * t523;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  t541 = my_piecewise3(t48, 0, 0.3e1 / 0.10e2 * t49 * t53 * (-0.5e1 / 0.124416e6 * t21 * t200 * t486 * t60 + 0.5e1 / 0.191102976e9 * t21 * t159 * sigma[2] / t56 / t410 / t54 * t415 * t276));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = t9 * t541;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}

