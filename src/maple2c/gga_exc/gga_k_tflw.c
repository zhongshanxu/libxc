/* 
  This file was generated automatically with ./scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_k_tflw.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 2
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC)


static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t3, t4, t5, t6, t8, t9, t10, t12;
  double t13, t15, t18, t20, t21, t22, t23, t27;
  double t31;

#ifndef XC_DONT_COMPILE_VXC
  double t37, t41, t42, t46, t52, t55;

#ifndef XC_DONT_COMPILE_FXC
  double t63, t70, t76;
#endif

#endif

#endif


  gga_k_tflw_params *params;

  assert(p->params != NULL);
  params = (gga_k_tflw_params * )(p->params);

  t3 = rho[0] / 0.2e1 <= 0.101e1 * p->threshold_dens;
  t4 = M_CBRT3;
  t5 = t4 * t4;
  t6 = M_CBRTPI;
  t8 = t5 * t6 * M_PI;
  t9 = POW_1_3(rho[0]);
  t10 = t9 * t9;
  t12 = M_CBRT2;
  t13 = t12 * t12;
  t15 = rho[0] * rho[0];
  t18 = M_CBRT6;
  t20 = M_PI * M_PI;
  t21 = POW_1_3(t20);
  t22 = t21 * t21;
  t23 = 0.1e1 / t22;
  t27 = params->gamma + 0.5e1 / 0.72e2 * params->lambda * sigma[0] * t13 / t10 / t15 * t18 * t23;
  t31 = my_piecewise3(t3, 0, 0.3e1 / 0.20e2 * t8 * t10 * t27);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = 0.2e1 * t31;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t37 = 0.1e1 / t15 / rho[0];
  t41 = t18 * t23;
  t42 = sigma[0] * t13 * t41;
  t46 = my_piecewise3(t3, 0, t8 / t9 * t27 / 0.10e2 - t8 * t37 * params->lambda * t42 / 0.36e2);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.2e1 * rho[0] * t46 + 0.2e1 * t31;

  t52 = params->lambda * t13 * t41;
  t55 = my_piecewise3(t3, 0, t8 / t15 * t52 / 0.96e2);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.2e1 * rho[0] * t55;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t63 = t15 * t15;
  t70 = my_piecewise3(t3, 0, -t8 / t9 / rho[0] * t27 / 0.30e2 + 0.7e1 / 0.108e3 * t8 / t63 * params->lambda * t42);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * rho[0] * t70 + 0.4e1 * t46;

  t76 = my_piecewise3(t3, 0, -t8 * t37 * t52 / 0.48e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.2e1 * rho[0] * t76 + 0.2e1 * t55;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.0e0;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t13, t14, t15, t17;
  double t18, t19, t20, t22, t24, t25, t26, t27;
  double t31, t32, t35, t36, t37, t38, t39, t40;
  double t42, t43, t44, t45, t47, t52, t53, t56;

#ifndef XC_DONT_COMPILE_VXC
  double t60, t62, t64, t65, t66, t67, t68, t70;
  double t71, t75, t76, t77, t78, t79, t83, t85;
  double t87, t88, t90, t91, t97, t100, t102, t106;
  double t109, t111, t112, t116, t117, t118, t119, t120;
  double t124, t129, t130, t131, t134, t137, t138, t139;
  double t142;

#ifndef XC_DONT_COMPILE_FXC
  double t145, t147, t152, t154, t164, t167, t170, t173;
  double t175, t181, t185, t186, t195, t199, t201, t204;
  double t206, t208, t210, t212, t218, t228, t235, t240;
  double t241, t244, t251, t257, t265, t268, t273, t285;
  double t300, t306, t317, t324, t329, t333, t341, t350;
  double t358;
#endif

#endif

#endif


  gga_k_tflw_params *params;

  assert(p->params != NULL);
  params = (gga_k_tflw_params * )(p->params);

  t1 = 0.101e1 * p->threshold_dens;
  t2 = rho[0] <= t1;
  t3 = M_CBRT6;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t6 = t5 * M_PI;
  t7 = t4 * t6;
  t8 = t7 * rho[0];
  t9 = rho[0] + rho[1];
  t10 = POW_1_3(t9);
  t11 = 0.1e1 / t10;
  t12 = 0.1e1 / t9;
  t13 = rho[0] * t12;
  t14 = POW_1_3(t13);
  t15 = t14 * t14;
  t17 = params->lambda * sigma[0];
  t18 = rho[0] * rho[0];
  t19 = POW_1_3(rho[0]);
  t20 = t19 * t19;
  t22 = 0.1e1 / t20 / t18;
  t24 = M_PI * M_PI;
  t25 = POW_1_3(t24);
  t26 = t25 * t25;
  t27 = 0.1e1 / t26;
  t31 = params->gamma + 0.5e1 / 0.72e2 * t17 * t22 * t3 * t27;
  t32 = t11 * t15 * t31;
  t35 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t8 * t32);
  t36 = rho[1] <= t1;
  t37 = t7 * rho[1];
  t38 = rho[1] * t12;
  t39 = POW_1_3(t38);
  t40 = t39 * t39;
  t42 = params->lambda * sigma[2];
  t43 = rho[1] * rho[1];
  t44 = POW_1_3(rho[1]);
  t45 = t44 * t44;
  t47 = 0.1e1 / t45 / t43;
  t52 = params->gamma + 0.5e1 / 0.72e2 * t42 * t47 * t3 * t27;
  t53 = t11 * t40 * t52;
  t56 = my_piecewise3(t36, 0, 0.3e1 / 0.10e2 * t37 * t53);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = t35 + t56;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t60 = 0.1e1 / t10 / t9;
  t62 = t60 * t15 * t31;
  t64 = t8 * t62 / 0.10e2;
  t65 = 0.1e1 / t14;
  t66 = t11 * t65;
  t67 = t9 * t9;
  t68 = 0.1e1 / t67;
  t70 = -rho[0] * t68 + t12;
  t71 = t31 * t70;
  t75 = t6 * t22;
  t76 = t75 * t11;
  t77 = t15 * params->lambda;
  t78 = sigma[0] * t27;
  t79 = t77 * t78;
  t83 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t7 * t32 - t64 + t8 * t66 * t71 / 0.5e1 - t76 * t79 / 0.3e1);
  t85 = t60 * t40 * t52;
  t87 = t37 * t85 / 0.10e2;
  t88 = t7 * t43;
  t90 = 0.1e1 / t10 / t67;
  t91 = 0.1e1 / t39;
  t97 = my_piecewise3(t36, 0, -t87 - t88 * t90 * t91 * t52 / 0.5e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t35 + t56 + t9 * (t83 + t97);

  t100 = t7 * t18;
  t102 = t90 * t65 * t31;
  t106 = my_piecewise3(t2, 0, -t64 - t100 * t102 / 0.5e1);
  t109 = t11 * t91;
  t111 = -rho[1] * t68 + t12;
  t112 = t52 * t111;
  t116 = t6 * t47;
  t117 = t116 * t11;
  t118 = t40 * params->lambda;
  t119 = sigma[2] * t27;
  t120 = t118 * t119;
  t124 = my_piecewise3(t36, 0, 0.3e1 / 0.10e2 * t7 * t53 - t87 + t37 * t109 * t112 / 0.5e1 - t117 * t120 / 0.3e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t35 + t56 + t9 * (t106 + t124);

  t129 = t6 / t20 / rho[0];
  t130 = t129 * t11;
  t131 = t77 * t27;
  t134 = my_piecewise3(t2, 0, t130 * t131 / 0.8e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = t9 * t134;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t137 = t6 / t45 / rho[1];
  t138 = t137 * t11;
  t139 = t118 * t27;
  t142 = my_piecewise3(t36, 0, t138 * t139 / 0.8e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = t9 * t142;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t145 = t7 * t62;
  t147 = t7 * t11;
  t152 = t6 * t11;
  t154 = t18 * rho[0];
  t164 = 0.2e1 / 0.15e2 * t8 * t90 * t15 * t31;
  t167 = t8 * t60 * t65 * t71;
  t170 = t75 * t60 * t79;
  t173 = 0.1e1 / t14 / t13;
  t175 = t70 * t70;
  t181 = t27 * t70;
  t185 = t67 * t9;
  t186 = 0.1e1 / t185;
  t195 = my_piecewise3(t2, 0, -t145 / 0.5e1 + 0.2e1 / 0.5e1 * t147 * t65 * t31 * t70 + 0.5e1 / 0.9e1 * t152 * t15 * t17 / t20 / t154 * t27 + t164 - 0.2e1 / 0.15e2 * t167 + 0.2e1 / 0.9e1 * t170 - t8 * t11 * t173 * t31 * t175 / 0.15e2 - 0.4e1 / 0.9e1 * t75 * t66 * t17 * t181 + t8 * t66 * t31 * (0.2e1 * rho[0] * t186 - 0.2e1 * t68) / 0.5e1);
  t199 = 0.2e1 / 0.15e2 * t37 * t90 * t40 * t52;
  t201 = 0.1e1 / t10 / t185;
  t204 = t88 * t201 * t91 * t52;
  t206 = t43 * rho[1];
  t208 = t67 * t67;
  t210 = 0.1e1 / t10 / t208;
  t212 = 0.1e1 / t39 / t38;
  t218 = my_piecewise3(t36, 0, t199 + 0.8e1 / 0.15e2 * t204 - t7 * t206 * t210 * t212 * t52 / 0.15e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * t83 + 0.2e1 * t97 + t9 * (t195 + t218);

  t228 = t100 * t201 * t65 * t31;
  t235 = t65 * params->lambda;
  t240 = my_piecewise3(t2, 0, -t145 / 0.10e2 + t164 - t167 / 0.15e2 + t170 / 0.9e1 - 0.2e1 / 0.5e1 * t8 * t102 + 0.7e1 / 0.15e2 * t228 + t100 * t90 * t173 * t71 / 0.15e2 + 0.2e1 / 0.9e1 * t129 * t90 * t235 * t78);
  t241 = t7 * t85;
  t244 = t91 * t52;
  t251 = t37 * t60 * t91 * t112;
  t257 = rho[1] * t186;
  t265 = t116 * t60 * t120;
  t268 = t91 * params->lambda;
  t273 = my_piecewise3(t36, 0, -t241 / 0.10e2 - t7 * t90 * t244 * rho[1] / 0.5e1 + t199 + t204 / 0.15e2 - t251 / 0.15e2 + t88 * t90 * t212 * t112 / 0.15e2 + t37 * t109 * t52 * (-t68 + 0.2e1 * t257) / 0.5e1 + t265 / 0.9e1 + 0.2e1 / 0.9e1 * t137 * t90 * t268 * t119);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t83 + t97 + t106 + t124 + t9 * (t240 + t273);

  t285 = my_piecewise3(t2, 0, t164 + 0.8e1 / 0.15e2 * t228 - t7 * t154 * t210 * t173 * t31 / 0.15e2);
  t300 = t111 * t111;
  t306 = t27 * t111;
  t317 = my_piecewise3(t36, 0, -t241 / 0.5e1 + 0.2e1 / 0.5e1 * t147 * t244 * t111 + 0.5e1 / 0.9e1 * t152 * t40 * t42 / t45 / t206 * t27 + t199 - 0.2e1 / 0.15e2 * t251 + 0.2e1 / 0.9e1 * t265 - t37 * t11 * t212 * t52 * t300 / 0.15e2 - 0.4e1 / 0.9e1 * t116 * t109 * t42 * t306 + t37 * t109 * t52 * (-0.2e1 * t68 + 0.2e1 * t257) / 0.5e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = 0.2e1 * t106 + 0.2e1 * t124 + t9 * (t285 + t317);

  t324 = t129 * t60 * t131 / 0.24e2;
  t329 = my_piecewise3(t2, 0, -0.5e1 / 0.24e2 * t76 * t131 - t324 + t130 * t235 * t181 / 0.12e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t9 * t329 + t134;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  t333 = t137 * t60 * t139 / 0.24e2;
  t341 = my_piecewise3(t36, 0, -t333 - t6 / t45 * t90 * t268 * t27 / 0.12e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t9 * t341 + t142;

  t350 = my_piecewise3(t2, 0, -t324 - t6 / t20 * t90 * t235 * t27 / 0.12e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t9 * t350 + t134;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t358 = my_piecewise3(t36, 0, -0.5e1 / 0.24e2 * t117 * t139 - t333 + t138 * t268 * t306 / 0.12e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t9 * t358 + t142;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = 0.0e0;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}

