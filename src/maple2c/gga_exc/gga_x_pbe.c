/* 
  This file was generated automatically with ./scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_pbe.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 2
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC)


static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t3, t4, t5, t7, t8, t9, t10, t11;
  double t12, t13, t14, t16, t17, t19, t20, t26;
  double t31, t35;

#ifndef XC_DONT_COMPILE_VXC
  double t40, t43, t44, t45, t46, t51, t55, t65;
  double t68;

#ifndef XC_DONT_COMPILE_FXC
  double t76, t88, t91, t92, t93, t95, t96, t103;
  double t120, t133;
#endif

#endif

#endif


  gga_x_pbe_params *params;

  assert(p->params != NULL);
  params = (gga_x_pbe_params * )(p->params);

  t3 = rho[0] / 0.2e1 <= 0.101e1 * p->threshold_dens;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t7 = t4 / t5;
  t8 = POW_1_3(rho[0]);
  t9 = M_CBRT6;
  t10 = params->mu * t9;
  t11 = M_PI * M_PI;
  t12 = POW_1_3(t11);
  t13 = t12 * t12;
  t14 = 0.1e1 / t13;
  t16 = M_CBRT2;
  t17 = t16 * t16;
  t19 = rho[0] * rho[0];
  t20 = t8 * t8;
  t26 = params->kappa + t10 * t14 * sigma[0] * t17 / t20 / t19 / 0.24e2;
  t31 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t26);
  t35 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t8 * t31);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = 0.2e1 * t35;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t40 = t19 * rho[0];
  t43 = params->kappa * params->kappa;
  t44 = 0.1e1 / t8 / t40 * t43;
  t45 = t26 * t26;
  t46 = 0.1e1 / t45;
  t51 = t10 * t14 * sigma[0] * t17;
  t55 = my_piecewise3(t3, 0, -t7 / t20 * t31 / 0.8e1 + t7 * t44 * t46 * t51 / 0.24e2);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.2e1 * rho[0] * t55 + 0.2e1 * t35;

  t65 = t46 * params->mu * t9 * t14 * t17;
  t68 = my_piecewise3(t3, 0, -t7 / t8 / t19 * t43 * t65 / 0.64e2);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.2e1 * rho[0] * t68;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t76 = t19 * t19;
  t88 = 0.1e1 / t45 / t26;
  t91 = params->mu * params->mu;
  t92 = t9 * t9;
  t93 = t91 * t92;
  t95 = 0.1e1 / t12 / t11;
  t96 = sigma[0] * sigma[0];
  t103 = my_piecewise3(t3, 0, t7 / t20 / rho[0] * t31 / 0.12e2 - t7 / t8 / t76 * t43 * t46 * t51 / 0.8e1 + t7 / t76 / t40 * t43 * t88 * t93 * t95 * t96 * t16 / 0.54e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * rho[0] * t103 + 0.4e1 * t55;

  t120 = my_piecewise3(t3, 0, 0.7e1 / 0.192e3 * t7 * t44 * t65 - t7 / t76 / t19 * t43 * t88 * t93 * t95 * t16 * sigma[0] / 0.144e3);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.2e1 * rho[0] * t120 + 0.2e1 * t68;

  t133 = my_piecewise3(t3, 0, t7 / t76 / rho[0] * t43 * t88 * t91 * t92 * t95 * t16 / 0.384e3);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.2e1 * rho[0] * t133;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t1, t2, t3, t4, t6, t7, t8, t9;
  double t10, t11, t12, t14, t15, t16, t17, t18;
  double t19, t20, t21, t22, t23, t24, t25, t26;
  double t28, t32, t37, t38, t42, t43, t45, t46;
  double t47, t48, t49, t50, t52, t56, t61, t62;
  double t66;

#ifndef XC_DONT_COMPILE_VXC
  double t67, t72, t76, t78, t79, t80, t81, t82;
  double t83, t85, t86, t87, t90, t93, t94, t95;
  double t97, t98, t100, t104, t108, t110, t112, t113;
  double t114, t119, t123, t128, t129, t134, t135, t137;
  double t138, t139, t142, t145, t146, t148, t150, t154;
  double t158, t159, t162, t164, t165, t168, t170, t171;
  double t174, t176, t179;

#ifndef XC_DONT_COMPILE_FXC
  double t184, t191, t198, t201, t204, t209, t212, t214;
  double t226, t227, t235, t243, t245, t246, t247, t249;
  double t250, t251, t257, t261, t263, t266, t268, t269;
  double t271, t274, t280, t291, t305, t308, t318, t326;
  double t336, t344, t356, t372, t390, t398, t400, t401;
  double t407, t418, t437, t442, t453, t465, t490, t499;
  double t503, t513;
#endif

#endif

#endif


  gga_x_pbe_params *params;

  assert(p->params != NULL);
  params = (gga_x_pbe_params * )(p->params);

  t1 = 0.101e1 * p->threshold_dens;
  t2 = rho[0] <= t1;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = M_CBRT2;
  t8 = t6 * t7;
  t9 = rho[0] + rho[1];
  t10 = POW_1_3(t9);
  t11 = t10 * t10;
  t12 = 0.1e1 / t11;
  t14 = 0.1e1 / t9;
  t15 = rho[0] * t14;
  t16 = POW_1_3(t15);
  t17 = M_CBRT6;
  t18 = params->mu * t17;
  t19 = M_PI * M_PI;
  t20 = POW_1_3(t19);
  t21 = t20 * t20;
  t22 = 0.1e1 / t21;
  t23 = t22 * sigma[0];
  t24 = rho[0] * rho[0];
  t25 = POW_1_3(rho[0]);
  t26 = t25 * t25;
  t28 = 0.1e1 / t26 / t24;
  t32 = params->kappa + t18 * t23 * t28 / 0.24e2;
  t37 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t32);
  t38 = t16 * t37;
  t42 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * rho[0] * t12 * t38);
  t43 = rho[1] <= t1;
  t45 = rho[1] * t14;
  t46 = POW_1_3(t45);
  t47 = t22 * sigma[2];
  t48 = rho[1] * rho[1];
  t49 = POW_1_3(rho[1]);
  t50 = t49 * t49;
  t52 = 0.1e1 / t50 / t48;
  t56 = params->kappa + t18 * t47 * t52 / 0.24e2;
  t61 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t56);
  t62 = t46 * t61;
  t66 = my_piecewise3(t43, 0, -0.3e1 / 0.4e1 * t8 * rho[1] * t12 * t62);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = t42 + t66;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t67 = t12 * t16;
  t72 = 0.1e1 / t11 / t9;
  t76 = t8 * rho[0] * t72 * t38 / 0.2e1;
  t78 = t6 * t7 * rho[0];
  t79 = t16 * t16;
  t80 = 0.1e1 / t79;
  t81 = t12 * t80;
  t82 = t9 * t9;
  t83 = 0.1e1 / t82;
  t85 = -rho[0] * t83 + t14;
  t86 = t37 * t85;
  t87 = t81 * t86;
  t90 = t28 * t12;
  t93 = params->kappa * params->kappa;
  t94 = t32 * t32;
  t95 = 0.1e1 / t94;
  t97 = t93 * t95 * params->mu;
  t98 = t17 * t22;
  t100 = t97 * t98 * sigma[0];
  t104 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t67 * t37 + t76 - t78 * t87 / 0.4e1 + t8 * t90 * t16 * t100 / 0.12e2);
  t108 = t8 * rho[1] * t72 * t62 / 0.2e1;
  t110 = 0.1e1 / t11 / t82;
  t112 = t46 * t46;
  t113 = 0.1e1 / t112;
  t114 = t113 * t61;
  t119 = my_piecewise3(t43, 0, t108 + t8 * t48 * t110 * t114 / 0.4e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t42 + t66 + t9 * (t104 + t119);

  t123 = t80 * t37;
  t128 = my_piecewise3(t2, 0, t76 + t8 * t24 * t110 * t123 / 0.4e1);
  t129 = t12 * t46;
  t134 = t6 * t7 * rho[1];
  t135 = t12 * t113;
  t137 = -rho[1] * t83 + t14;
  t138 = t61 * t137;
  t139 = t135 * t138;
  t142 = t52 * t12;
  t145 = t56 * t56;
  t146 = 0.1e1 / t145;
  t148 = t93 * t146 * params->mu;
  t150 = t148 * t98 * sigma[2];
  t154 = my_piecewise3(t43, 0, -0.3e1 / 0.4e1 * t8 * t129 * t61 + t108 - t134 * t139 / 0.4e1 + t8 * t142 * t46 * t150 / 0.12e2);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t42 + t66 + t9 * (t128 + t154);

  t158 = 0.1e1 / t26 / rho[0];
  t159 = t7 * t158;
  t162 = t16 * t93;
  t164 = t18 * t22;
  t165 = t162 * t95 * t164;
  t168 = my_piecewise3(t2, 0, -t6 * t159 * t12 * t165 / 0.32e2);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = t9 * t168;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t170 = 0.1e1 / t50 / rho[1];
  t171 = t7 * t170;
  t174 = t46 * t93;
  t176 = t174 * t146 * t164;
  t179 = my_piecewise3(t43, 0, -t6 * t171 * t12 * t176 / 0.32e2);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = t9 * t179;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t184 = t8 * t72 * t16 * t37;
  t191 = t24 * rho[0];
  t198 = rho[0] * t110;
  t201 = 0.5e1 / 0.6e1 * t8 * t198 * t38;
  t204 = t78 * t72 * t80 * t86;
  t209 = t8 * t28 * t72 * t16 * t100;
  t212 = 0.1e1 / t79 / t15;
  t214 = t85 * t85;
  t226 = t82 * t9;
  t227 = 0.1e1 / t226;
  t235 = t24 * t24;
  t243 = 0.1e1 / t94 / t32;
  t245 = params->mu * params->mu;
  t246 = t93 * t243 * t245;
  t247 = t17 * t17;
  t249 = 0.1e1 / t20 / t19;
  t250 = t247 * t249;
  t251 = sigma[0] * sigma[0];
  t257 = my_piecewise3(t2, 0, t184 - t8 * t87 / 0.2e1 - 0.5e1 / 0.36e2 * t8 * t67 * t93 * t95 * params->mu * t17 * t23 / t26 / t191 - t201 + t204 / 0.3e1 - t209 / 0.9e1 + t78 * t12 * t212 * t37 * t214 / 0.6e1 + t8 * t90 * t80 * t97 * t98 * sigma[0] * t85 / 0.18e2 - t78 * t81 * t37 * (0.2e1 * rho[0] * t227 - 0.2e1 * t83) / 0.4e1 + t8 / t25 / t235 / t24 * t12 * t16 * t246 * t250 * t251 / 0.54e2);
  t261 = 0.5e1 / 0.6e1 * t8 * rho[1] * t110 * t62;
  t263 = 0.1e1 / t11 / t226;
  t266 = t8 * t48 * t263 * t114;
  t268 = t48 * rho[1];
  t269 = t82 * t82;
  t271 = 0.1e1 / t11 / t269;
  t274 = 0.1e1 / t112 / t45;
  t280 = my_piecewise3(t43, 0, -t261 - 0.5e1 / 0.6e1 * t266 + t8 * t268 * t271 * t274 * t61 / 0.6e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * t104 + 0.2e1 * t119 + t9 * (t257 + t280);

  t291 = t8 * t24 * t263 * t123;
  t305 = my_piecewise3(t2, 0, t184 / 0.2e1 - t201 + t204 / 0.6e1 - t209 / 0.18e2 + t8 * t198 * t123 / 0.2e1 - 0.2e1 / 0.3e1 * t291 - t6 * t7 * t24 * t110 * t212 * t86 / 0.6e1 - t8 * t158 * t110 * t80 * t100 / 0.36e2);
  t308 = t8 * t72 * t46 * t61;
  t318 = t134 * t72 * t113 * t138;
  t326 = rho[1] * t227;
  t336 = t8 * t52 * t72 * t46 * t150;
  t344 = my_piecewise3(t43, 0, t308 / 0.2e1 + t8 * t110 * t113 * t61 * rho[1] / 0.4e1 - t261 - t266 / 0.6e1 + t318 / 0.6e1 - t6 * t7 * t48 * t110 * t274 * t138 / 0.6e1 - t134 * t135 * t61 * (-t83 + 0.2e1 * t326) / 0.4e1 - t336 / 0.18e2 - t8 * t170 * t110 * t113 * t150 / 0.36e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t104 + t119 + t128 + t154 + t9 * (t305 + t344);

  t356 = my_piecewise3(t2, 0, -t201 - 0.5e1 / 0.6e1 * t291 + t8 * t191 * t271 * t212 * t37 / 0.6e1);
  t372 = t137 * t137;
  t390 = t48 * t48;
  t398 = 0.1e1 / t145 / t56;
  t400 = t93 * t398 * t245;
  t401 = sigma[2] * sigma[2];
  t407 = my_piecewise3(t43, 0, t308 - t8 * t139 / 0.2e1 - 0.5e1 / 0.36e2 * t8 * t129 * t93 * t146 * params->mu * t17 * t47 / t50 / t268 - t261 + t318 / 0.3e1 - t336 / 0.9e1 + t134 * t12 * t274 * t61 * t372 / 0.6e1 + t8 * t142 * t113 * t148 * t98 * sigma[2] * t137 / 0.18e2 - t134 * t135 * t61 * (-0.2e1 * t83 + 0.2e1 * t326) / 0.4e1 + t8 / t49 / t390 / t48 * t12 * t46 * t400 * t250 * t401 / 0.54e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = 0.2e1 * t128 + 0.2e1 * t154 + t9 * (t356 + t407);

  t418 = t6 * t159 * t72 * t165 / 0.48e2;
  t437 = my_piecewise3(t2, 0, 0.5e1 / 0.96e2 * t6 * t7 * t28 * t12 * t165 + t418 - t8 * t158 * t12 * t80 * t97 * t98 * t85 / 0.96e2 - t8 / t25 / t235 / rho[0] * t12 * t16 * t246 * t250 * sigma[0] / 0.144e3);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t9 * t437 + t168;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  t442 = t6 * t171 * t72 * t176 / 0.48e2;
  t453 = my_piecewise3(t43, 0, t442 + t6 * t7 / t50 * t110 * t113 * t93 * t146 * t164 / 0.96e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t9 * t453 + t179;

  t465 = my_piecewise3(t2, 0, t418 + t6 * t7 / t26 * t110 * t80 * t93 * t95 * t164 / 0.96e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t9 * t465 + t168;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t490 = my_piecewise3(t43, 0, 0.5e1 / 0.96e2 * t6 * t7 * t52 * t12 * t176 + t442 - t8 * t170 * t12 * t113 * t148 * t98 * t137 / 0.96e2 - t8 / t49 / t390 / rho[1] * t12 * t46 * t400 * t250 * sigma[2] / 0.144e3);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t9 * t490 + t179;

  t499 = t245 * t247 * t249;
  t503 = my_piecewise3(t2, 0, t6 * t7 / t25 / t235 * t12 * t162 * t243 * t499 / 0.384e3);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = t9 * t503;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  t513 = my_piecewise3(t43, 0, t6 * t7 / t49 / t390 * t12 * t174 * t398 * t499 / 0.384e3);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = t9 * t513;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}

