/* 
  This file was generated automatically with ./scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_k_pw86.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 2
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC)


static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t3, t4, t5, t6, t8, t9, t10, t11;
  double t12, t13, t14, t16, t17, t18, t19, t20;
  double t22, t26, t29, t30, t31, t32, t35, t39;
  double t40, t41, t44, t45, t49;

#ifndef XC_DONT_COMPILE_VXC
  double t50, t54, t55, t57, t58, t59, t60, t61;
  double t63, t69, t74, t77, t82, t88, t94, t98;

#ifndef XC_DONT_COMPILE_FXC
  double t106, t111, t112, t113, t137, t161, t164, t178;
#endif

#endif

#endif



  t3 = rho[0] / 0.2e1 <= 0.101e1 * p->threshold_dens;
  t4 = M_CBRT3;
  t5 = t4 * t4;
  t6 = M_CBRTPI;
  t8 = t5 * t6 * M_PI;
  t9 = POW_1_3(rho[0]);
  t10 = t9 * t9;
  t11 = M_CBRT6;
  t12 = M_PI * M_PI;
  t13 = POW_1_3(t12);
  t14 = t13 * t13;
  t16 = t11 / t14;
  t17 = M_CBRT2;
  t18 = t17 * t17;
  t19 = sigma[0] * t18;
  t20 = rho[0] * rho[0];
  t22 = 0.1e1 / t10 / t20;
  t26 = t11 * t11;
  t29 = t26 / t13 / t12;
  t30 = sigma[0] * sigma[0];
  t31 = t30 * t17;
  t32 = t20 * t20;
  t35 = 0.1e1 / t9 / t32 / rho[0];
  t39 = t30 * sigma[0];
  t40 = t32 * t32;
  t41 = 0.1e1 / t40;
  t44 = 0.1e1 + 0.91999999999999999998e-1 * t16 * t19 * t22 + 0.32187500000000000000e-1 * t29 * t31 * t35 + 0.35645771717653941627e-5 * t39 * t41;
  t45 = pow(t44, 0.1e1 / 0.15e2);
  t49 = my_piecewise3(t3, 0, 0.3e1 / 0.20e2 * t8 * t10 * t45);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = 0.2e1 * t49;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t50 = 0.1e1 / t9;
  t54 = t45 * t45;
  t55 = t54 * t54;
  t57 = t55 * t55;
  t58 = t57 * t55 * t54;
  t59 = 0.1e1 / t58;
  t60 = t10 * t59;
  t61 = t20 * rho[0];
  t63 = 0.1e1 / t10 / t61;
  t69 = 0.1e1 / t9 / t32 / t20;
  t74 = 0.1e1 / t40 / rho[0];
  t77 = -0.24533333333333333333e0 * t16 * t19 * t63 - 0.17166666666666666667e0 * t29 * t31 * t69 - 0.28516617374123153302e-4 * t39 * t74;
  t82 = my_piecewise3(t3, 0, t8 * t50 * t45 / 0.10e2 + t8 * t60 * t77 / 0.100e3);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.2e1 * rho[0] * t82 + 0.2e1 * t49;

  t88 = sigma[0] * t17;
  t94 = 0.91999999999999999998e-1 * t16 * t18 * t22 + 0.64375000000000000000e-1 * t29 * t88 * t35 + 0.10693731515296182488e-4 * t30 * t41;
  t98 = my_piecewise3(t3, 0, t8 * t60 * t94 / 0.100e3);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.2e1 * rho[0] * t98;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t106 = t50 * t59;
  t111 = 0.1e1 / t58 / t44;
  t112 = t10 * t111;
  t113 = t77 * t77;
  t137 = my_piecewise3(t3, 0, -t8 / t9 / rho[0] * t45 / 0.30e2 + t8 * t106 * t77 / 0.75e2 - 0.7e1 / 0.750e3 * t8 * t112 * t113 + t8 * t60 * (0.89955555555555555554e0 * t16 * t19 / t10 / t32 + 0.10872222222222222222e1 * t29 * t31 / t9 / t32 / t61 + 0.25664955636710837972e-3 * t39 / t40 / t20) / 0.100e3);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * rho[0] * t137 + 0.4e1 * t82;

  t161 = my_piecewise3(t3, 0, t8 * t106 * t94 / 0.150e3 - 0.7e1 / 0.750e3 * t8 * t10 * t111 * t94 * t77 + t8 * t60 * (-0.24533333333333333333e0 * t16 * t18 * t63 - 0.34333333333333333333e0 * t29 * t88 * t69 - 0.85549852122369459904e-4 * t30 * t74) / 0.100e3);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.2e1 * rho[0] * t161 + 0.2e1 * t98;

  t164 = t94 * t94;
  t178 = my_piecewise3(t3, 0, -0.7e1 / 0.750e3 * t8 * t112 * t164 + t8 * t60 * (0.64375000000000000000e-1 * t29 * t17 * t35 + 0.21387463030592364976e-4 * sigma[0] * t41) / 0.100e3);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.2e1 * rho[0] * t178;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t1, t2, t3, t4, t5, t7, t8, t9;
  double t10, t11, t12, t13, t14, t15, t16, t17;
  double t18, t19, t21, t22, t23, t24, t26, t32;
  double t33, t34, t37, t41, t42, t43, t46, t47;
  double t48, t51, t52, t53, t54, t55, t56, t57;
  double t58, t59, t60, t62, t66, t67, t70, t74;
  double t75, t76, t79, t80, t81, t84;

#ifndef XC_DONT_COMPILE_VXC
  double t88, t89, t90, t92, t93, t94, t95, t96;
  double t98, t99, t103, t104, t106, t107, t108, t109;
  double t111, t117, t122, t125, t126, t131, t132, t133;
  double t135, t136, t138, t139, t140, t145, t148, t149;
  double t150, t154, t157, t159, t160, t164, t165, t167;
  double t168, t169, t170, t172, t178, t183, t186, t187;
  double t192, t202, t203, t207, t215, t216, t220;

#ifndef XC_DONT_COMPILE_FXC
  double t223, t225, t230, t237, t240, t243, t246, t248;
  double t254, t255, t260, t261, t270, t271, t296, t297;
  double t301, t303, t306, t309, t311, t313, t319, t329;
  double t339, t340, t343, t350, t356, t364, t370, t382;
  double t387, t394, t400, t401, t413, t414, t439, t440;
  double t448, t471, t475, t480, t486, t513, t515, t530;
  double t531, t546;
#endif

#endif

#endif



  t1 = 0.101e1 * p->threshold_dens;
  t2 = rho[0] <= t1;
  t3 = M_CBRT6;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = t7 * rho[0];
  t9 = rho[0] + rho[1];
  t10 = POW_1_3(t9);
  t11 = 0.1e1 / t10;
  t12 = 0.1e1 / t9;
  t13 = rho[0] * t12;
  t14 = POW_1_3(t13);
  t15 = t14 * t14;
  t16 = t11 * t15;
  t17 = M_PI * M_PI;
  t18 = POW_1_3(t17);
  t19 = t18 * t18;
  t21 = t3 / t19;
  t22 = rho[0] * rho[0];
  t23 = POW_1_3(rho[0]);
  t24 = t23 * t23;
  t26 = 0.1e1 / t24 / t22;
  t32 = t4 / t18 / t17;
  t33 = sigma[0] * sigma[0];
  t34 = t22 * t22;
  t37 = 0.1e1 / t23 / t34 / rho[0];
  t41 = t33 * sigma[0];
  t42 = t34 * t34;
  t43 = 0.1e1 / t42;
  t46 = 0.1e1 + 0.91999999999999999998e-1 * t21 * sigma[0] * t26 + 0.16093750000000000000e-1 * t32 * t33 * t37 + 0.89114429294134854068e-6 * t41 * t43;
  t47 = pow(t46, 0.1e1 / 0.15e2);
  t48 = t16 * t47;
  t51 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t8 * t48);
  t52 = rho[1] <= t1;
  t53 = t7 * rho[1];
  t54 = rho[1] * t12;
  t55 = POW_1_3(t54);
  t56 = t55 * t55;
  t57 = t11 * t56;
  t58 = rho[1] * rho[1];
  t59 = POW_1_3(rho[1]);
  t60 = t59 * t59;
  t62 = 0.1e1 / t60 / t58;
  t66 = sigma[2] * sigma[2];
  t67 = t58 * t58;
  t70 = 0.1e1 / t59 / t67 / rho[1];
  t74 = t66 * sigma[2];
  t75 = t67 * t67;
  t76 = 0.1e1 / t75;
  t79 = 0.1e1 + 0.91999999999999999998e-1 * t21 * sigma[2] * t62 + 0.16093750000000000000e-1 * t32 * t66 * t70 + 0.89114429294134854068e-6 * t74 * t76;
  t80 = pow(t79, 0.1e1 / 0.15e2);
  t81 = t57 * t80;
  t84 = my_piecewise3(t52, 0, 0.3e1 / 0.10e2 * t53 * t81);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = t51 + t84;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t88 = 0.1e1 / t10 / t9;
  t89 = t88 * t15;
  t90 = t89 * t47;
  t92 = t8 * t90 / 0.10e2;
  t93 = 0.1e1 / t14;
  t94 = t11 * t93;
  t95 = t9 * t9;
  t96 = 0.1e1 / t95;
  t98 = -rho[0] * t96 + t12;
  t99 = t47 * t98;
  t103 = t47 * t47;
  t104 = t103 * t103;
  t106 = t104 * t104;
  t107 = t106 * t104 * t103;
  t108 = 0.1e1 / t107;
  t109 = t22 * rho[0];
  t111 = 0.1e1 / t24 / t109;
  t117 = 0.1e1 / t23 / t34 / t22;
  t122 = 0.1e1 / t42 / rho[0];
  t125 = -0.24533333333333333333e0 * t21 * sigma[0] * t111 - 0.85833333333333333333e-1 * t32 * t33 * t117 - 0.71291543435307883254e-5 * t41 * t122;
  t126 = t108 * t125;
  t131 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t7 * t48 - t92 + t8 * t94 * t99 / 0.5e1 + t8 * t16 * t126 / 0.50e2);
  t132 = t88 * t56;
  t133 = t132 * t80;
  t135 = t53 * t133 / 0.10e2;
  t136 = t7 * t58;
  t138 = 0.1e1 / t10 / t95;
  t139 = 0.1e1 / t55;
  t140 = t138 * t139;
  t145 = my_piecewise3(t52, 0, -t135 - t136 * t140 * t80 / 0.5e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t51 + t84 + t9 * (t131 + t145);

  t148 = t7 * t22;
  t149 = t138 * t93;
  t150 = t149 * t47;
  t154 = my_piecewise3(t2, 0, -t92 - t148 * t150 / 0.5e1);
  t157 = t11 * t139;
  t159 = -rho[1] * t96 + t12;
  t160 = t80 * t159;
  t164 = t80 * t80;
  t165 = t164 * t164;
  t167 = t165 * t165;
  t168 = t167 * t165 * t164;
  t169 = 0.1e1 / t168;
  t170 = t58 * rho[1];
  t172 = 0.1e1 / t60 / t170;
  t178 = 0.1e1 / t59 / t67 / t58;
  t183 = 0.1e1 / t75 / rho[1];
  t186 = -0.24533333333333333333e0 * t21 * sigma[2] * t172 - 0.85833333333333333333e-1 * t32 * t66 * t178 - 0.71291543435307883254e-5 * t74 * t183;
  t187 = t169 * t186;
  t192 = my_piecewise3(t52, 0, 0.3e1 / 0.10e2 * t7 * t81 - t135 + t53 * t157 * t160 / 0.5e1 + t53 * t57 * t187 / 0.50e2);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t51 + t84 + t9 * (t154 + t192);

  t202 = 0.91999999999999999998e-1 * t21 * t26 + 0.32187500000000000000e-1 * t32 * sigma[0] * t37 + 0.26734328788240456220e-5 * t33 * t43;
  t203 = t108 * t202;
  t207 = my_piecewise3(t2, 0, t8 * t16 * t203 / 0.50e2);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = t9 * t207;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t215 = 0.91999999999999999998e-1 * t21 * t62 + 0.32187500000000000000e-1 * t32 * sigma[2] * t70 + 0.26734328788240456220e-5 * t66 * t76;
  t216 = t169 * t215;
  t220 = my_piecewise3(t52, 0, t53 * t57 * t216 / 0.50e2);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = t9 * t220;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t223 = t7 * t90;
  t225 = t7 * t11;
  t230 = t15 * t108;
  t237 = 0.2e1 / 0.15e2 * t8 * t138 * t15 * t47;
  t240 = t8 * t88 * t93 * t99;
  t243 = t8 * t89 * t126;
  t246 = 0.1e1 / t14 / t13;
  t248 = t98 * t98;
  t254 = t7 * rho[0] * t11;
  t255 = t93 * t108;
  t260 = t95 * t9;
  t261 = 0.1e1 / t260;
  t270 = 0.1e1 / t107 / t46;
  t271 = t125 * t125;
  t296 = -t223 / 0.5e1 + 0.2e1 / 0.5e1 * t225 * t93 * t47 * t98 + t225 * t230 * t125 / 0.25e2 + t237 - 0.2e1 / 0.15e2 * t240 - t243 / 0.75e2 - t8 * t11 * t246 * t47 * t248 / 0.15e2 + 0.2e1 / 0.75e2 * t254 * t255 * t98 * t125 + t8 * t94 * t47 * (0.2e1 * rho[0] * t261 - 0.2e1 * t96) / 0.5e1 - 0.7e1 / 0.375e3 * t8 * t16 * t270 * t271 + t8 * t16 * t108 * (0.89955555555555555554e0 * t21 * sigma[0] / t24 / t34 + 0.54361111111111111111e0 * t32 * t33 / t23 / t34 / t109 + 0.64162389091777094929e-4 * t41 / t42 / t22) / 0.50e2;
  t297 = my_piecewise3(t2, 0, t296);
  t301 = 0.2e1 / 0.15e2 * t53 * t138 * t56 * t80;
  t303 = 0.1e1 / t10 / t260;
  t306 = t136 * t303 * t139 * t80;
  t309 = t95 * t95;
  t311 = 0.1e1 / t10 / t309;
  t313 = 0.1e1 / t55 / t54;
  t319 = my_piecewise3(t52, 0, t301 + 0.8e1 / 0.15e2 * t306 - t7 * t170 * t311 * t313 * t80 / 0.15e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * t131 + 0.2e1 * t145 + t9 * (t297 + t319);

  t329 = t148 * t303 * t93 * t47;
  t339 = my_piecewise3(t2, 0, -t223 / 0.10e2 + t237 - t240 / 0.15e2 - t243 / 0.150e3 - 0.2e1 / 0.5e1 * t8 * t150 + 0.7e1 / 0.15e2 * t329 + t148 * t138 * t246 * t99 / 0.15e2 - t148 * t149 * t126 / 0.75e2);
  t340 = t7 * t133;
  t343 = t139 * t80;
  t350 = t53 * t88 * t139 * t160;
  t356 = rho[1] * t261;
  t364 = t53 * t132 * t187;
  t370 = my_piecewise3(t52, 0, -t340 / 0.10e2 - t7 * t138 * t343 * rho[1] / 0.5e1 + t301 + t306 / 0.15e2 - t350 / 0.15e2 + t136 * t138 * t313 * t160 / 0.15e2 + t53 * t157 * t80 * (-t96 + 0.2e1 * t356) / 0.5e1 - t364 / 0.150e3 - t136 * t140 * t187 / 0.75e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t131 + t145 + t154 + t192 + t9 * (t339 + t370);

  t382 = my_piecewise3(t2, 0, t237 + 0.8e1 / 0.15e2 * t329 - t7 * t109 * t311 * t246 * t47 / 0.15e2);
  t387 = t56 * t169;
  t394 = t159 * t159;
  t400 = t7 * rho[1] * t11;
  t401 = t139 * t169;
  t413 = 0.1e1 / t168 / t79;
  t414 = t186 * t186;
  t439 = -t340 / 0.5e1 + 0.2e1 / 0.5e1 * t225 * t343 * t159 + t225 * t387 * t186 / 0.25e2 + t301 - 0.2e1 / 0.15e2 * t350 - t364 / 0.75e2 - t53 * t11 * t313 * t80 * t394 / 0.15e2 + 0.2e1 / 0.75e2 * t400 * t401 * t159 * t186 + t53 * t157 * t80 * (-0.2e1 * t96 + 0.2e1 * t356) / 0.5e1 - 0.7e1 / 0.375e3 * t53 * t57 * t413 * t414 + t53 * t57 * t169 * (0.89955555555555555554e0 * t21 * sigma[2] / t60 / t67 + 0.54361111111111111111e0 * t32 * t66 / t59 / t67 / t170 + 0.64162389091777094929e-4 * t74 / t75 / t58) / 0.50e2;
  t440 = my_piecewise3(t52, 0, t439);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = 0.2e1 * t154 + 0.2e1 * t192 + t9 * (t382 + t440);

  t448 = t8 * t89 * t203 / 0.150e3;
  t471 = my_piecewise3(t2, 0, t225 * t230 * t202 / 0.50e2 - t448 + t254 * t255 * t202 * t98 / 0.75e2 - 0.7e1 / 0.375e3 * t254 * t15 * t270 * t202 * t125 + t8 * t16 * t108 * (-0.24533333333333333333e0 * t21 * t111 - 0.17166666666666666667e0 * t32 * sigma[0] * t117 - 0.21387463030592364976e-4 * t33 * t122) / 0.50e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t9 * t471 + t207;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  t475 = t53 * t132 * t216 / 0.150e3;
  t480 = my_piecewise3(t52, 0, -t475 - t136 * t140 * t216 / 0.75e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t9 * t480 + t220;

  t486 = my_piecewise3(t2, 0, -t448 - t148 * t149 * t203 / 0.75e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t9 * t486 + t207;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t513 = my_piecewise3(t52, 0, t225 * t387 * t215 / 0.50e2 - t475 + t400 * t401 * t215 * t159 / 0.75e2 - 0.7e1 / 0.375e3 * t400 * t56 * t413 * t215 * t186 + t53 * t57 * t169 * (-0.24533333333333333333e0 * t21 * t172 - 0.17166666666666666667e0 * t32 * sigma[2] * t178 - 0.21387463030592364976e-4 * t66 * t183) / 0.50e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t9 * t513 + t220;

  t515 = t202 * t202;
  t530 = my_piecewise3(t2, 0, -0.7e1 / 0.375e3 * t8 * t16 * t270 * t515 + t8 * t16 * t108 * (0.32187500000000000000e-1 * t32 * t37 + 0.53468657576480912440e-5 * sigma[0] * t43) / 0.50e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = t9 * t530;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  t531 = t215 * t215;
  t546 = my_piecewise3(t52, 0, -0.7e1 / 0.375e3 * t53 * t57 * t413 * t531 + t53 * t57 * t169 * (0.32187500000000000000e-1 * t32 * t70 + 0.53468657576480912440e-5 * sigma[2] * t76) / 0.50e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = t9 * t546;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}

