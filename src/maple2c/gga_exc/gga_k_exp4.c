/* 
  This file was generated automatically with ./scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_k_exp4.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 2
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC)


static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t3, t4, t5, t6, t8, t9, t10, t11;
  double t12, t13, t14, t16, t17, t18, t20, t22;
  double t26, t28, t31, t32, t34, t37, t41, t43;
  double t47;

#ifndef XC_DONT_COMPILE_VXC
  double t48, t52, t53, t57, t60, t63, t65, t68;
  double t73, t80, t81, t82, t85, t89;

#ifndef XC_DONT_COMPILE_FXC
  double t109, t116, t119, t120, t122, t135, t164, t184;
#endif

#endif

#endif



  t3 = rho[0] / 0.2e1 <= 0.101e1 * p->threshold_dens;
  t4 = M_CBRT3;
  t5 = t4 * t4;
  t6 = M_CBRTPI;
  t8 = t5 * t6 * M_PI;
  t9 = POW_1_3(rho[0]);
  t10 = t9 * t9;
  t11 = M_CBRT6;
  t12 = M_PI * M_PI;
  t13 = POW_1_3(t12);
  t14 = t13 * t13;
  t16 = t11 / t14;
  t17 = M_CBRT2;
  t18 = t17 * t17;
  t20 = rho[0] * rho[0];
  t22 = 0.1e1 / t10 / t20;
  t26 = exp(-0.83254166666666666664e1 * t16 * sigma[0] * t18 * t22);
  t28 = t11 * t11;
  t31 = t28 / t13 / t12;
  t32 = sigma[0] * sigma[0];
  t34 = t20 * t20;
  t37 = 0.1e1 / t9 / t34 / rho[0];
  t41 = exp(-0.15095833333333333333e-1 * t31 * t32 * t17 * t37);
  t43 = 0.20788e1 - 0.8524e0 * t26 - 0.12264e1 * t41;
  t47 = my_piecewise3(t3, 0, 0.3e1 / 0.20e2 * t8 * t10 * t43);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = 0.2e1 * t47;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t48 = 0.1e1 / t9;
  t52 = t16 * sigma[0];
  t53 = t20 * rho[0];
  t57 = t18 / t10 / t53 * t26;
  t60 = t31 * t32;
  t63 = 0.1e1 / t9 / t34 / t20;
  t65 = t17 * t63 * t41;
  t68 = -0.18924227111111111110e2 * t52 * t57 - 0.98738826666666666664e-1 * t60 * t65;
  t73 = my_piecewise3(t3, 0, t8 * t48 * t43 / 0.10e2 + 0.3e1 / 0.20e2 * t8 * t10 * t68);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.2e1 * rho[0] * t73 + 0.2e1 * t47;

  t80 = t31 * sigma[0];
  t81 = t17 * t37;
  t82 = t81 * t41;
  t85 = 0.70965851666666666664e1 * t16 * t18 * t22 * t26 + 0.37027059999999999999e-1 * t80 * t82;
  t89 = my_piecewise3(t3, 0, 0.3e1 / 0.20e2 * t8 * t10 * t85);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.2e1 * rho[0] * t89;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t109 = t17 / t9 / t34 / t53;
  t116 = t12 * t12;
  t119 = t11 / t14 / t116;
  t120 = t32 * t32;
  t122 = t34 * t34;
  t135 = my_piecewise3(t3, 0, -t8 / t9 / rho[0] * t43 / 0.30e2 + t8 * t48 * t68 / 0.5e1 + 0.3e1 / 0.20e2 * t8 * t10 * (0.69388832740740740737e2 * t52 * t18 / t10 / t34 * t26 - 0.84027773757135802460e3 * t60 * t109 * t26 + 0.62534590222222222221e0 * t60 * t109 * t41 - 0.47697435868444444442e-1 * t119 * t120 * t18 / t10 / t122 / t34 * t41));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * rho[0] * t135 + 0.4e1 * t73;

  t164 = my_piecewise3(t3, 0, t8 * t48 * t85 / 0.10e2 + 0.3e1 / 0.20e2 * t8 * t10 * (-0.18924227111111111110e2 * t16 * t57 + 0.31510415158925925923e3 * t31 * t17 * t63 * sigma[0] * t26 - 0.19747765333333333333e0 * t80 * t65 + 0.17886538450666666666e-1 * t119 * t32 * sigma[0] * t18 / t10 / t122 / t53 * t41));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.2e1 * rho[0] * t164 + 0.2e1 * t89;

  t184 = my_piecewise3(t3, 0, 0.3e1 / 0.20e2 * t8 * t10 * (-0.11816405684597222222e3 * t31 * t81 * t26 + 0.37027059999999999999e-1 * t31 * t82 - 0.67074519189999999998e-2 * t119 * t32 * t18 / t10 / t122 / t20 * t41));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.2e1 * rho[0] * t184;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t1, t2, t3, t4, t5, t7, t8, t9;
  double t10, t11, t12, t13, t14, t15, t16, t17;
  double t18, t19, t21, t22, t23, t24, t26, t30;
  double t34, t35, t36, t39, t43, t45, t46, t49;
  double t50, t51, t52, t53, t54, t55, t56, t57;
  double t58, t60, t64, t66, t67, t70, t74, t76;
  double t77, t80;

#ifndef XC_DONT_COMPILE_VXC
  double t84, t85, t86, t88, t89, t90, t91, t92;
  double t94, t95, t99, t101, t108, t113, t114, t118;
  double t119, t120, t122, t123, t125, t126, t127, t132;
  double t135, t136, t137, t141, t144, t146, t147, t151;
  double t153, t160, t165, t166, t170, t180, t181, t184;
  double t192, t193, t196;

#ifndef XC_DONT_COMPILE_FXC
  double t199, t201, t211, t214, t217, t220, t222, t231;
  double t232, t249, t256, t259, t260, t261, t274, t278;
  double t280, t283, t286, t288, t290, t296, t306, t316;
  double t317, t320, t327, t333, t341, t347, t359, t369;
  double t393, t400, t401, t414, t421, t429, t449, t453;
  double t458, t464, t475, t495, t514, t532;
#endif

#endif

#endif



  t1 = 0.101e1 * p->threshold_dens;
  t2 = rho[0] <= t1;
  t3 = M_CBRT6;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = t7 * rho[0];
  t9 = rho[0] + rho[1];
  t10 = POW_1_3(t9);
  t11 = 0.1e1 / t10;
  t12 = 0.1e1 / t9;
  t13 = rho[0] * t12;
  t14 = POW_1_3(t13);
  t15 = t14 * t14;
  t16 = t11 * t15;
  t17 = M_PI * M_PI;
  t18 = POW_1_3(t17);
  t19 = t18 * t18;
  t21 = t3 / t19;
  t22 = rho[0] * rho[0];
  t23 = POW_1_3(rho[0]);
  t24 = t23 * t23;
  t26 = 0.1e1 / t24 / t22;
  t30 = exp(-0.83254166666666666664e1 * t21 * sigma[0] * t26);
  t34 = t4 / t18 / t17;
  t35 = sigma[0] * sigma[0];
  t36 = t22 * t22;
  t39 = 0.1e1 / t23 / t36 / rho[0];
  t43 = exp(-0.75479166666666666666e-2 * t34 * t35 * t39);
  t45 = 0.20788e1 - 0.8524e0 * t30 - 0.12264e1 * t43;
  t46 = t16 * t45;
  t49 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t8 * t46);
  t50 = rho[1] <= t1;
  t51 = t7 * rho[1];
  t52 = rho[1] * t12;
  t53 = POW_1_3(t52);
  t54 = t53 * t53;
  t55 = t11 * t54;
  t56 = rho[1] * rho[1];
  t57 = POW_1_3(rho[1]);
  t58 = t57 * t57;
  t60 = 0.1e1 / t58 / t56;
  t64 = exp(-0.83254166666666666664e1 * t21 * sigma[2] * t60);
  t66 = sigma[2] * sigma[2];
  t67 = t56 * t56;
  t70 = 0.1e1 / t57 / t67 / rho[1];
  t74 = exp(-0.75479166666666666666e-2 * t34 * t66 * t70);
  t76 = 0.20788e1 - 0.8524e0 * t64 - 0.12264e1 * t74;
  t77 = t55 * t76;
  t80 = my_piecewise3(t50, 0, 0.3e1 / 0.10e2 * t51 * t77);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = t49 + t80;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t84 = 0.1e1 / t10 / t9;
  t85 = t84 * t15;
  t86 = t85 * t45;
  t88 = t8 * t86 / 0.10e2;
  t89 = 0.1e1 / t14;
  t90 = t11 * t89;
  t91 = t9 * t9;
  t92 = 0.1e1 / t91;
  t94 = -rho[0] * t92 + t12;
  t95 = t45 * t94;
  t99 = t22 * rho[0];
  t101 = 0.1e1 / t24 / t99;
  t108 = 0.1e1 / t23 / t36 / t22;
  t113 = -0.18924227111111111110e2 * t21 * sigma[0] * t101 * t30 - 0.49369413333333333333e-1 * t34 * t35 * t108 * t43;
  t114 = t16 * t113;
  t118 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t7 * t46 - t88 + t8 * t90 * t95 / 0.5e1 + 0.3e1 / 0.10e2 * t8 * t114);
  t119 = t84 * t54;
  t120 = t119 * t76;
  t122 = t51 * t120 / 0.10e2;
  t123 = t7 * t56;
  t125 = 0.1e1 / t10 / t91;
  t126 = 0.1e1 / t53;
  t127 = t125 * t126;
  t132 = my_piecewise3(t50, 0, -t122 - t123 * t127 * t76 / 0.5e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t49 + t80 + t9 * (t118 + t132);

  t135 = t7 * t22;
  t136 = t125 * t89;
  t137 = t136 * t45;
  t141 = my_piecewise3(t2, 0, -t88 - t135 * t137 / 0.5e1);
  t144 = t11 * t126;
  t146 = -rho[1] * t92 + t12;
  t147 = t76 * t146;
  t151 = t56 * rho[1];
  t153 = 0.1e1 / t58 / t151;
  t160 = 0.1e1 / t57 / t67 / t56;
  t165 = -0.18924227111111111110e2 * t21 * sigma[2] * t153 * t64 - 0.49369413333333333333e-1 * t34 * t66 * t160 * t74;
  t166 = t55 * t165;
  t170 = my_piecewise3(t50, 0, 0.3e1 / 0.10e2 * t7 * t77 - t122 + t51 * t144 * t147 / 0.5e1 + 0.3e1 / 0.10e2 * t51 * t166);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t49 + t80 + t9 * (t141 + t170);

  t180 = 0.70965851666666666664e1 * t21 * t26 * t30 + 0.18513530000000000000e-1 * t34 * sigma[0] * t39 * t43;
  t181 = t16 * t180;
  t184 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t8 * t181);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = t9 * t184;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t192 = 0.70965851666666666664e1 * t21 * t60 * t64 + 0.18513530000000000000e-1 * t34 * sigma[2] * t70 * t74;
  t193 = t55 * t192;
  t196 = my_piecewise3(t50, 0, 0.3e1 / 0.10e2 * t51 * t193);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = t9 * t196;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t199 = t7 * t86;
  t201 = t7 * t11;
  t211 = 0.2e1 / 0.15e2 * t8 * t125 * t15 * t45;
  t214 = t8 * t84 * t89 * t95;
  t217 = t8 * t85 * t113;
  t220 = 0.1e1 / t14 / t13;
  t222 = t94 * t94;
  t231 = t91 * t9;
  t232 = 0.1e1 / t231;
  t249 = t35 / t23 / t36 / t99;
  t256 = t17 * t17;
  t259 = t3 / t19 / t256;
  t260 = t35 * t35;
  t261 = t36 * t36;
  t274 = my_piecewise3(t2, 0, -t199 / 0.5e1 + 0.2e1 / 0.5e1 * t201 * t89 * t45 * t94 + 0.3e1 / 0.5e1 * t7 * t114 + t211 - 0.2e1 / 0.15e2 * t214 - t217 / 0.5e1 - t8 * t11 * t220 * t45 * t222 / 0.15e2 + 0.2e1 / 0.5e1 * t8 * t90 * t113 * t94 + t8 * t90 * t45 * (0.2e1 * rho[0] * t232 - 0.2e1 * t92) / 0.5e1 + 0.3e1 / 0.10e2 * t8 * t16 * (0.69388832740740740737e2 * t21 * sigma[0] / t24 / t36 * t30 - 0.42013886878567901230e3 * t34 * t249 * t30 + 0.31267295111111111111e0 * t34 * t249 * t43 - 0.11924358967111111111e-1 * t259 * t260 / t24 / t261 / t36 * t43));
  t278 = 0.2e1 / 0.15e2 * t51 * t125 * t54 * t76;
  t280 = 0.1e1 / t10 / t231;
  t283 = t123 * t280 * t126 * t76;
  t286 = t91 * t91;
  t288 = 0.1e1 / t10 / t286;
  t290 = 0.1e1 / t53 / t52;
  t296 = my_piecewise3(t50, 0, t278 + 0.8e1 / 0.15e2 * t283 - t7 * t151 * t288 * t290 * t76 / 0.15e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * t118 + 0.2e1 * t132 + t9 * (t274 + t296);

  t306 = t135 * t280 * t89 * t45;
  t316 = my_piecewise3(t2, 0, -t199 / 0.10e2 + t211 - t214 / 0.15e2 - t217 / 0.10e2 - 0.2e1 / 0.5e1 * t8 * t137 + 0.7e1 / 0.15e2 * t306 + t135 * t125 * t220 * t95 / 0.15e2 - t135 * t136 * t113 / 0.5e1);
  t317 = t7 * t120;
  t320 = t126 * t76;
  t327 = t51 * t84 * t126 * t147;
  t333 = rho[1] * t232;
  t341 = t51 * t119 * t165;
  t347 = my_piecewise3(t50, 0, -t317 / 0.10e2 - t7 * t125 * t320 * rho[1] / 0.5e1 + t278 + t283 / 0.15e2 - t327 / 0.15e2 + t123 * t125 * t290 * t147 / 0.15e2 + t51 * t144 * t76 * (-t92 + 0.2e1 * t333) / 0.5e1 - t341 / 0.10e2 - t123 * t127 * t165 / 0.5e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t118 + t132 + t141 + t170 + t9 * (t316 + t347);

  t359 = my_piecewise3(t2, 0, t211 + 0.8e1 / 0.15e2 * t306 - t7 * t99 * t288 * t220 * t45 / 0.15e2);
  t369 = t146 * t146;
  t393 = t66 / t57 / t67 / t151;
  t400 = t66 * t66;
  t401 = t67 * t67;
  t414 = my_piecewise3(t50, 0, -t317 / 0.5e1 + 0.2e1 / 0.5e1 * t201 * t320 * t146 + 0.3e1 / 0.5e1 * t7 * t166 + t278 - 0.2e1 / 0.15e2 * t327 - t341 / 0.5e1 - t51 * t11 * t290 * t76 * t369 / 0.15e2 + 0.2e1 / 0.5e1 * t51 * t144 * t165 * t146 + t51 * t144 * t76 * (-0.2e1 * t92 + 0.2e1 * t333) / 0.5e1 + 0.3e1 / 0.10e2 * t51 * t55 * (0.69388832740740740737e2 * t21 * sigma[2] / t58 / t67 * t64 - 0.42013886878567901230e3 * t34 * t393 * t64 + 0.31267295111111111111e0 * t34 * t393 * t74 - 0.11924358967111111111e-1 * t259 * t400 / t58 / t401 / t67 * t74));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = 0.2e1 * t141 + 0.2e1 * t170 + t9 * (t359 + t414);

  t421 = t8 * t85 * t180 / 0.10e2;
  t429 = t108 * sigma[0];
  t449 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t7 * t181 - t421 + t8 * t90 * t180 * t94 / 0.5e1 + 0.3e1 / 0.10e2 * t8 * t16 * (-0.18924227111111111110e2 * t21 * t101 * t30 + 0.15755207579462962962e3 * t34 * t429 * t30 - 0.98738826666666666667e-1 * t34 * t429 * t43 + 0.44716346126666666666e-2 * t259 * t35 * sigma[0] / t24 / t261 / t99 * t43));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t9 * t449 + t184;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  t453 = t51 * t119 * t192 / 0.10e2;
  t458 = my_piecewise3(t50, 0, -t453 - t123 * t127 * t192 / 0.5e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t9 * t458 + t196;

  t464 = my_piecewise3(t2, 0, -t421 - t135 * t136 * t180 / 0.5e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t9 * t464 + t184;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t475 = t160 * sigma[2];
  t495 = my_piecewise3(t50, 0, 0.3e1 / 0.10e2 * t7 * t193 - t453 + t51 * t144 * t192 * t146 / 0.5e1 + 0.3e1 / 0.10e2 * t51 * t55 * (-0.18924227111111111110e2 * t21 * t153 * t64 + 0.15755207579462962962e3 * t34 * t475 * t64 - 0.98738826666666666667e-1 * t34 * t475 * t74 + 0.44716346126666666666e-2 * t259 * t66 * sigma[2] / t58 / t401 / t151 * t74));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t9 * t495 + t196;

  t514 = my_piecewise3(t2, 0, 0.3e1 / 0.10e2 * t8 * t16 * (-0.59082028422986111107e2 * t34 * t39 * t30 + 0.18513530000000000000e-1 * t34 * t39 * t43 - 0.16768629797500000000e-2 * t259 * t35 / t24 / t261 / t22 * t43));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = t9 * t514;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  t532 = my_piecewise3(t50, 0, 0.3e1 / 0.10e2 * t51 * t55 * (-0.59082028422986111107e2 * t34 * t70 * t64 + 0.18513530000000000000e-1 * t34 * t70 * t74 - 0.16768629797500000000e-2 * t259 * t66 / t58 / t401 / t56 * t74));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = t9 * t532;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}

