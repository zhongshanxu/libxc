/* 
  This file was generated automatically with ./scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_pw86.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 2
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC)


static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t3, t4, t5, t7, t8, t9, t10, t11;
  double t12, t13, t14, t15, t16, t17, t18, t19;
  double t20, t22, t26, t27, t29, t30, t31, t32;
  double t33, t36, t40, t42, t43, t44, t45, t49;
  double t50, t54;

#ifndef XC_DONT_COMPILE_VXC
  double t55, t59, t60, t62, t63, t64, t65, t66;
  double t68, t74, t79, t83, t88, t91, t95, t102;
  double t106;

#ifndef XC_DONT_COMPILE_FXC
  double t114, t119, t120, t121, t146, t171, t174, t190;
#endif

#endif

#endif


  gga_x_pw86_params *params;
 
  assert(p->params != NULL);
  params = (gga_x_pw86_params * )(p->params);

  t3 = rho[0] / 0.2e1 <= 0.101e1 * p->threshold_dens;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t7 = t4 / t5;
  t8 = POW_1_3(rho[0]);
  t9 = M_CBRT6;
  t10 = params->aa * t9;
  t11 = M_PI * M_PI;
  t12 = POW_1_3(t11);
  t13 = t12 * t12;
  t14 = 0.1e1 / t13;
  t15 = t10 * t14;
  t16 = M_CBRT2;
  t17 = t16 * t16;
  t18 = sigma[0] * t17;
  t19 = rho[0] * rho[0];
  t20 = t8 * t8;
  t22 = 0.1e1 / t20 / t19;
  t26 = t9 * t9;
  t27 = params->bb * t26;
  t29 = 0.1e1 / t12 / t11;
  t30 = t27 * t29;
  t31 = sigma[0] * sigma[0];
  t32 = t31 * t16;
  t33 = t19 * t19;
  t36 = 0.1e1 / t8 / t33 / rho[0];
  t40 = t11 * t11;
  t42 = params->cc / t40;
  t43 = t31 * sigma[0];
  t44 = t33 * t33;
  t45 = 0.1e1 / t44;
  t49 = 0.1e1 + t15 * t18 * t22 / 0.24e2 + t30 * t32 * t36 / 0.288e3 + t42 * t43 * t45 / 0.576e3;
  t50 = pow(t49, 0.1e1 / 0.15e2);
  t54 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t8 * t50);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = 0.2e1 * t54;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t55 = 0.1e1 / t20;
  t59 = t50 * t50;
  t60 = t59 * t59;
  t62 = t60 * t60;
  t63 = t62 * t60 * t59;
  t64 = 0.1e1 / t63;
  t65 = t8 * t64;
  t66 = t19 * rho[0];
  t68 = 0.1e1 / t20 / t66;
  t74 = 0.1e1 / t8 / t33 / t19;
  t79 = 0.1e1 / t44 / rho[0];
  t83 = -t15 * t18 * t68 / 0.9e1 - t30 * t32 * t74 / 0.54e2 - t42 * t43 * t79 / 0.72e2;
  t88 = my_piecewise3(t3, 0, -t7 * t55 * t50 / 0.8e1 - t7 * t65 * t83 / 0.40e2);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.2e1 * rho[0] * t88 + 0.2e1 * t54;

  t91 = t14 * t17;
  t95 = sigma[0] * t16;
  t102 = t10 * t91 * t22 / 0.24e2 + t30 * t95 * t36 / 0.144e3 + t42 * t31 * t45 / 0.192e3;
  t106 = my_piecewise3(t3, 0, -t7 * t65 * t102 / 0.40e2);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.2e1 * rho[0] * t106;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t114 = t55 * t64;
  t119 = 0.1e1 / t63 / t49;
  t120 = t8 * t119;
  t121 = t83 * t83;
  t146 = my_piecewise3(t3, 0, t7 / t20 / rho[0] * t50 / 0.12e2 - t7 * t114 * t83 / 0.60e2 + 0.7e1 / 0.300e3 * t7 * t120 * t121 - t7 * t65 * (0.11e2 / 0.27e2 * t15 * t18 / t20 / t33 + 0.19e2 / 0.162e3 * t30 * t32 / t8 / t33 / t66 + t42 * t43 / t44 / t19 / 0.8e1) / 0.40e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * rho[0] * t146 + 0.4e1 * t88;

  t171 = my_piecewise3(t3, 0, -t7 * t114 * t102 / 0.120e3 + 0.7e1 / 0.300e3 * t7 * t8 * t119 * t102 * t83 - t7 * t65 * (-t10 * t91 * t68 / 0.9e1 - t30 * t95 * t74 / 0.27e2 - t42 * t31 * t79 / 0.24e2) / 0.40e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.2e1 * rho[0] * t171 + 0.2e1 * t106;

  t174 = t102 * t102;
  t190 = my_piecewise3(t3, 0, 0.7e1 / 0.300e3 * t7 * t120 * t174 - t7 * t65 * (t27 * t29 * t16 * t36 / 0.144e3 + t42 * sigma[0] * t45 / 0.96e2) / 0.40e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.2e1 * rho[0] * t190;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma , double *zk GGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t1, t2, t3, t4, t6, t7, t8, t9;
  double t10, t11, t12, t14, t15, t16, t17, t18;
  double t19, t20, t21, t22, t23, t24, t25, t26;
  double t28, t32, t33, t35, t36, t37, t38, t41;
  double t45, t47, t48, t49, t50, t54, t55, t56;
  double t60, t61, t63, t64, t65, t66, t67, t68;
  double t70, t74, t75, t76, t79, t83, t84, t85;
  double t89, t90, t91, t95;

#ifndef XC_DONT_COMPILE_VXC
  double t96, t101, t105, t107, t108, t109, t110, t111;
  double t112, t114, t115, t116, t119, t120, t122, t123;
  double t124, t125, t127, t133, t138, t142, t143, t144;
  double t148, t152, t154, t156, t157, t158, t163, t167;
  double t172, t173, t178, t179, t181, t182, t183, t186;
  double t187, t189, t190, t191, t192, t194, t200, t205;
  double t209, t210, t211, t215, t221, t228, t229, t230;
  double t233, t237, t244, t245, t246, t249;

#ifndef XC_DONT_COMPILE_FXC
  double t252, t254, t259, t262, t265, t268, t271, t273;
  double t283, t284, t293, t294, t320, t321, t325, t327;
  double t330, t332, t334, t337, t343, t354, t357, t362;
  double t367, t368, t370, t372, t380, t383, t388, t396;
  double t402, t414, t422, t439, t440, t466, t467, t474;
  double t499, t503, t508, t514, t542, t544, t561, t562;
  double t579;
#endif

#endif

#endif


  gga_x_pw86_params *params;
 
  assert(p->params != NULL);
  params = (gga_x_pw86_params * )(p->params);

  t1 = 0.101e1 * p->threshold_dens;
  t2 = rho[0] <= t1;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = M_CBRT2;
  t8 = t6 * t7;
  t9 = rho[0] + rho[1];
  t10 = POW_1_3(t9);
  t11 = t10 * t10;
  t12 = 0.1e1 / t11;
  t14 = 0.1e1 / t9;
  t15 = rho[0] * t14;
  t16 = POW_1_3(t15);
  t17 = M_CBRT6;
  t18 = params->aa * t17;
  t19 = M_PI * M_PI;
  t20 = POW_1_3(t19);
  t21 = t20 * t20;
  t22 = 0.1e1 / t21;
  t23 = t22 * sigma[0];
  t24 = rho[0] * rho[0];
  t25 = POW_1_3(rho[0]);
  t26 = t25 * t25;
  t28 = 0.1e1 / t26 / t24;
  t32 = t17 * t17;
  t33 = params->bb * t32;
  t35 = 0.1e1 / t20 / t19;
  t36 = sigma[0] * sigma[0];
  t37 = t35 * t36;
  t38 = t24 * t24;
  t41 = 0.1e1 / t25 / t38 / rho[0];
  t45 = t19 * t19;
  t47 = params->cc / t45;
  t48 = t36 * sigma[0];
  t49 = t38 * t38;
  t50 = 0.1e1 / t49;
  t54 = 0.1e1 + t18 * t23 * t28 / 0.24e2 + t33 * t37 * t41 / 0.576e3 + t47 * t48 * t50 / 0.2304e4;
  t55 = pow(t54, 0.1e1 / 0.15e2);
  t56 = t16 * t55;
  t60 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * rho[0] * t12 * t56);
  t61 = rho[1] <= t1;
  t63 = rho[1] * t14;
  t64 = POW_1_3(t63);
  t65 = t22 * sigma[2];
  t66 = rho[1] * rho[1];
  t67 = POW_1_3(rho[1]);
  t68 = t67 * t67;
  t70 = 0.1e1 / t68 / t66;
  t74 = sigma[2] * sigma[2];
  t75 = t35 * t74;
  t76 = t66 * t66;
  t79 = 0.1e1 / t67 / t76 / rho[1];
  t83 = t74 * sigma[2];
  t84 = t76 * t76;
  t85 = 0.1e1 / t84;
  t89 = 0.1e1 + t18 * t65 * t70 / 0.24e2 + t33 * t75 * t79 / 0.576e3 + t47 * t83 * t85 / 0.2304e4;
  t90 = pow(t89, 0.1e1 / 0.15e2);
  t91 = t64 * t90;
  t95 = my_piecewise3(t61, 0, -0.3e1 / 0.4e1 * t8 * rho[1] * t12 * t91);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = t60 + t95;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t96 = t12 * t16;
  t101 = 0.1e1 / t11 / t9;
  t105 = t8 * rho[0] * t101 * t56 / 0.2e1;
  t107 = t6 * t7 * rho[0];
  t108 = t16 * t16;
  t109 = 0.1e1 / t108;
  t110 = t12 * t109;
  t111 = t9 * t9;
  t112 = 0.1e1 / t111;
  t114 = -rho[0] * t112 + t14;
  t115 = t55 * t114;
  t116 = t110 * t115;
  t119 = t55 * t55;
  t120 = t119 * t119;
  t122 = t120 * t120;
  t123 = t122 * t120 * t119;
  t124 = 0.1e1 / t123;
  t125 = t24 * rho[0];
  t127 = 0.1e1 / t26 / t125;
  t133 = 0.1e1 / t25 / t38 / t24;
  t138 = 0.1e1 / t49 / rho[0];
  t142 = -t18 * t23 * t127 / 0.9e1 - t33 * t37 * t133 / 0.108e3 - t47 * t48 * t138 / 0.288e3;
  t143 = t124 * t142;
  t144 = t96 * t143;
  t148 = my_piecewise3(t2, 0, -0.3e1 / 0.4e1 * t8 * t96 * t55 + t105 - t107 * t116 / 0.4e1 - t107 * t144 / 0.20e2);
  t152 = t8 * rho[1] * t101 * t91 / 0.2e1;
  t154 = 0.1e1 / t11 / t111;
  t156 = t64 * t64;
  t157 = 0.1e1 / t156;
  t158 = t157 * t90;
  t163 = my_piecewise3(t61, 0, t152 + t8 * t66 * t154 * t158 / 0.4e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t60 + t95 + t9 * (t148 + t163);

  t167 = t109 * t55;
  t172 = my_piecewise3(t2, 0, t105 + t8 * t24 * t154 * t167 / 0.4e1);
  t173 = t12 * t64;
  t178 = t6 * t7 * rho[1];
  t179 = t12 * t157;
  t181 = -rho[1] * t112 + t14;
  t182 = t90 * t181;
  t183 = t179 * t182;
  t186 = t90 * t90;
  t187 = t186 * t186;
  t189 = t187 * t187;
  t190 = t189 * t187 * t186;
  t191 = 0.1e1 / t190;
  t192 = t66 * rho[1];
  t194 = 0.1e1 / t68 / t192;
  t200 = 0.1e1 / t67 / t76 / t66;
  t205 = 0.1e1 / t84 / rho[1];
  t209 = -t18 * t65 * t194 / 0.9e1 - t33 * t75 * t200 / 0.108e3 - t47 * t83 * t205 / 0.288e3;
  t210 = t191 * t209;
  t211 = t173 * t210;
  t215 = my_piecewise3(t61, 0, -0.3e1 / 0.4e1 * t8 * t173 * t90 + t152 - t178 * t183 / 0.4e1 - t178 * t211 / 0.20e2);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t60 + t95 + t9 * (t172 + t215);

  t221 = t35 * sigma[0];
  t228 = t18 * t22 * t28 / 0.24e2 + t33 * t221 * t41 / 0.288e3 + t47 * t36 * t50 / 0.768e3;
  t229 = t124 * t228;
  t230 = t96 * t229;
  t233 = my_piecewise3(t2, 0, -t107 * t230 / 0.20e2);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = t9 * t233;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t237 = t35 * sigma[2];
  t244 = t18 * t22 * t70 / 0.24e2 + t33 * t237 * t79 / 0.288e3 + t47 * t74 * t85 / 0.768e3;
  t245 = t191 * t244;
  t246 = t173 * t245;
  t249 = my_piecewise3(t61, 0, -t178 * t246 / 0.20e2);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = t9 * t249;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t252 = t101 * t16;
  t254 = t8 * t252 * t55;
  t259 = rho[0] * t154;
  t262 = 0.5e1 / 0.6e1 * t8 * t259 * t56;
  t265 = t107 * t101 * t109 * t115;
  t268 = t107 * t252 * t143;
  t271 = 0.1e1 / t108 / t15;
  t273 = t114 * t114;
  t283 = t111 * t9;
  t284 = 0.1e1 / t283;
  t293 = 0.1e1 / t123 / t54;
  t294 = t142 * t142;
  t320 = t254 - t8 * t116 / 0.2e1 - t8 * t144 / 0.10e2 - t262 + t265 / 0.3e1 + t268 / 0.15e2 + t107 * t12 * t271 * t55 * t273 / 0.6e1 - t107 * t110 * t124 * t114 * t142 / 0.30e2 - t107 * t110 * t55 * (0.2e1 * rho[0] * t284 - 0.2e1 * t112) / 0.4e1 + 0.7e1 / 0.150e3 * t107 * t96 * t293 * t294 - t107 * t96 * t124 * (0.11e2 / 0.27e2 * t18 * t23 / t26 / t38 + 0.19e2 / 0.324e3 * t33 * t37 / t25 / t38 / t125 + t47 * t48 / t49 / t24 / 0.32e2) / 0.20e2;
  t321 = my_piecewise3(t2, 0, t320);
  t325 = 0.5e1 / 0.6e1 * t8 * rho[1] * t154 * t91;
  t327 = 0.1e1 / t11 / t283;
  t330 = t8 * t66 * t327 * t158;
  t332 = t111 * t111;
  t334 = 0.1e1 / t11 / t332;
  t337 = 0.1e1 / t156 / t63;
  t343 = my_piecewise3(t61, 0, -t325 - 0.5e1 / 0.6e1 * t330 + t8 * t192 * t334 * t337 * t90 / 0.6e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * t148 + 0.2e1 * t163 + t9 * (t321 + t343);

  t354 = t8 * t24 * t327 * t167;
  t357 = t6 * t7 * t24;
  t362 = t154 * t109;
  t367 = my_piecewise3(t2, 0, t254 / 0.2e1 - t262 + t265 / 0.6e1 + t268 / 0.30e2 + t8 * t259 * t167 / 0.2e1 - 0.2e1 / 0.3e1 * t354 - t357 * t154 * t271 * t115 / 0.6e1 + t357 * t362 * t143 / 0.60e2);
  t368 = t101 * t64;
  t370 = t8 * t368 * t90;
  t372 = t154 * t157;
  t380 = t178 * t101 * t157 * t182;
  t383 = t6 * t7 * t66;
  t388 = rho[1] * t284;
  t396 = t178 * t368 * t210;
  t402 = my_piecewise3(t61, 0, t370 / 0.2e1 + t8 * t372 * t90 * rho[1] / 0.4e1 - t325 - t330 / 0.6e1 + t380 / 0.6e1 - t383 * t154 * t337 * t182 / 0.6e1 - t178 * t179 * t90 * (-t112 + 0.2e1 * t388) / 0.4e1 + t396 / 0.30e2 + t383 * t372 * t210 / 0.60e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t148 + t163 + t172 + t215 + t9 * (t367 + t402);

  t414 = my_piecewise3(t2, 0, -t262 - 0.5e1 / 0.6e1 * t354 + t8 * t125 * t334 * t271 * t55 / 0.6e1);
  t422 = t181 * t181;
  t439 = 0.1e1 / t190 / t89;
  t440 = t209 * t209;
  t466 = t370 - t8 * t183 / 0.2e1 - t8 * t211 / 0.10e2 - t325 + t380 / 0.3e1 + t396 / 0.15e2 + t178 * t12 * t337 * t90 * t422 / 0.6e1 - t178 * t179 * t191 * t181 * t209 / 0.30e2 - t178 * t179 * t90 * (-0.2e1 * t112 + 0.2e1 * t388) / 0.4e1 + 0.7e1 / 0.150e3 * t178 * t173 * t439 * t440 - t178 * t173 * t191 * (0.11e2 / 0.27e2 * t18 * t65 / t68 / t76 + 0.19e2 / 0.324e3 * t33 * t75 / t67 / t76 / t192 + t47 * t83 / t84 / t66 / 0.32e2) / 0.20e2;
  t467 = my_piecewise3(t61, 0, t466);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = 0.2e1 * t172 + 0.2e1 * t215 + t9 * (t414 + t467);

  t474 = t107 * t252 * t229 / 0.30e2;
  t499 = my_piecewise3(t2, 0, -t8 * t230 / 0.20e2 + t474 - t107 * t110 * t229 * t114 / 0.60e2 + 0.7e1 / 0.150e3 * t107 * t96 * t293 * t228 * t142 - t107 * t96 * t124 * (-t18 * t22 * t127 / 0.9e1 - t33 * t221 * t133 / 0.54e2 - t47 * t36 * t138 / 0.96e2) / 0.20e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t9 * t499 + t233;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  t503 = t178 * t368 * t245 / 0.30e2;
  t508 = my_piecewise3(t61, 0, t503 + t383 * t372 * t245 / 0.60e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t9 * t508 + t249;

  t514 = my_piecewise3(t2, 0, t474 + t357 * t362 * t229 / 0.60e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t9 * t514 + t233;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t542 = my_piecewise3(t61, 0, -t8 * t246 / 0.20e2 + t503 - t178 * t179 * t245 * t181 / 0.60e2 + 0.7e1 / 0.150e3 * t178 * t173 * t439 * t244 * t209 - t178 * t173 * t191 * (-t18 * t22 * t194 / 0.9e1 - t33 * t237 * t200 / 0.54e2 - t47 * t74 * t205 / 0.96e2) / 0.20e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t9 * t542 + t249;

  t544 = t228 * t228;
  t561 = my_piecewise3(t2, 0, 0.7e1 / 0.150e3 * t107 * t96 * t293 * t544 - t107 * t96 * t124 * (t33 * t35 * t41 / 0.288e3 + t47 * sigma[0] * t50 / 0.384e3) / 0.20e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = t9 * t561;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  t562 = t244 * t244;
  t579 = my_piecewise3(t61, 0, 0.7e1 / 0.150e3 * t178 * t173 * t439 * t562 - t178 * t173 * t191 * (t33 * t35 * t79 / 0.288e3 + t47 * sigma[2] * t85 / 0.384e3) / 0.20e2);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = t9 * t579;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}

