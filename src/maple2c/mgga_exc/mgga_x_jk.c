/* 
  This file was generated automatically with ./scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : ./maple/mgga_exc/mgga_x_jk.mpl
  Type of functional: mgga_exc
*/

#define maple2c_order 2
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC)


static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma, const double *lapl, const double *tau , double *zk MGGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t4, t5, t6, t7, t8, t9, t10, t11;
  double t13, t14, t15, t16, t17, t18, t19, t20;
  double t21, t22, t23, t24, t25, t26, t27, t29;
  double t33, t34, t36, t37, t39, t40, t41, t42;
  double t44, t45, t46, t47, t49, t50, t55, t59;

#ifndef XC_DONT_COMPILE_VXC
  double t60, t64, t66, t73, t74, t75, t76, t77;
  double t79, t81, t83, t84, t85, t86, t87, t88;
  double t91, t92, t93, t96, t97, t98, t103, t104;
  double t106, t109, t110, t111, t114, t119, t122, t126;
  double t128, t131, t132, t133, t136, t137, t138, t140;
  double t141, t142, t145, t149, t152, t153, t154, t155;
  double t158;

#ifndef XC_DONT_COMPILE_FXC
  double t167, t169, t182, t183, t184, t189, t211, t221;
  double t222, t223, t250, t272, t317, t322, t329, t338;
  double t345, t374, t394, t404, t413;
#endif

#endif

#endif


  mgga_x_jk_params *params;

  assert(p->params != NULL);
  params = (mgga_x_jk_params * ) (p->params);

  t4 = rho[0] / 0.2e1 <= 0.101e1 * p->threshold_dens;
  t5 = M_CBRT3;
  t6 = M_CBRTPI;
  t7 = 0.1e1 / t6;
  t8 = t5 * t7;
  t9 = POW_1_3(rho[0]);
  t10 = t5 * t5;
  t11 = params->beta * t10;
  t13 = POW_1_3(0.1e1 / M_PI);
  t14 = 0.1e1 / t13;
  t15 = M_CBRT4;
  t16 = t14 * t15;
  t17 = t11 * t16;
  t18 = M_CBRT2;
  t19 = t18 * t18;
  t20 = sigma[0] * t19;
  t21 = rho[0] * rho[0];
  t22 = t9 * t9;
  t23 = t22 * t21;
  t24 = 0.1e1 / t23;
  t25 = params->gamma * params->beta;
  t26 = sqrt(sigma[0]);
  t27 = t25 * t26;
  t29 = 0.1e1 / t9 / rho[0];
  t33 = log(t26 * t18 * t29 + sqrt(POW_2(t26 * t18 * t29) + 0.1e1));
  t34 = t18 * t29 * t33;
  t36 = t27 * t34 + 0.1e1;
  t37 = 0.1e1 / t36;
  t39 = t20 * t24;
  t40 = lapl[0] * t19;
  t41 = t22 * rho[0];
  t42 = 0.1e1 / t41;
  t44 = -t40 * t42 + t39;
  t45 = 0.1e1 / sigma[0];
  t46 = t44 * t45;
  t47 = t18 * t23;
  t49 = t46 * t47 + 0.1e1;
  t50 = 0.1e1 / t49;
  t55 = 0.1e1 + 0.2e1 / 0.9e1 * t17 * t20 * t24 * t37 * t50;
  t59 = my_piecewise3(t4, 0, -0.3e1 / 0.8e1 * t8 * t9 * t55);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = 0.2e1 * t59;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t60 = 0.1e1 / t22;
  t64 = t21 * rho[0];
  t66 = 0.1e1 / t22 / t64;
  t73 = t11 * t16 * sigma[0];
  t74 = t19 * t24;
  t75 = t36 * t36;
  t76 = 0.1e1 / t75;
  t77 = t76 * t50;
  t79 = 0.1e1 / t9 / t21;
  t81 = t18 * t79 * t33;
  t83 = t25 * sigma[0];
  t84 = t19 * t66;
  t85 = t39 + 0.1e1;
  t86 = sqrt(t85);
  t87 = 0.1e1 / t86;
  t88 = t84 * t87;
  t91 = -0.4e1 / 0.3e1 * t27 * t81 - 0.4e1 / 0.3e1 * t83 * t88;
  t92 = t77 * t91;
  t93 = t74 * t92;
  t96 = t49 * t49;
  t97 = 0.1e1 / t96;
  t98 = t37 * t97;
  t103 = -0.8e1 / 0.3e1 * t20 * t66 + 0.5e1 / 0.3e1 * t40 * t24;
  t104 = t103 * t45;
  t106 = t18 * t41;
  t109 = t104 * t47 + 0.8e1 / 0.3e1 * t46 * t106;
  t110 = t98 * t109;
  t111 = t74 * t110;
  t114 = -0.16e2 / 0.27e2 * t17 * t20 * t66 * t37 * t50 - 0.2e1 / 0.9e1 * t73 * t93 - 0.2e1 / 0.9e1 * t73 * t111;
  t119 = my_piecewise3(t4, 0, -t8 * t60 * t55 / 0.8e1 - 0.3e1 / 0.8e1 * t8 * t9 * t114);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = 0.2e1 * rho[0] * t119 + 0.2e1 * t59;

  t122 = t37 * t50;
  t126 = t25 / t26;
  t128 = t74 * t87;
  t131 = t126 * t34 / 0.2e1 + t25 * t128 / 0.2e1;
  t132 = t77 * t131;
  t133 = t74 * t132;
  t136 = sigma[0] * sigma[0];
  t137 = 0.1e1 / t136;
  t138 = t44 * t137;
  t140 = -t138 * t47 + 0.2e1 * t45;
  t141 = t98 * t140;
  t142 = t74 * t141;
  t145 = 0.2e1 / 0.9e1 * t17 * t74 * t122 - 0.2e1 / 0.9e1 * t73 * t133 - 0.2e1 / 0.9e1 * t73 * t142;
  t149 = my_piecewise3(t4, 0, -0.3e1 / 0.8e1 * t8 * t9 * t145);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = 0.2e1 * rho[0] * t149;

  t152 = params->beta * t14;
  t153 = t7 * t29 * t152;
  t154 = t15 * t19;
  t155 = t154 * t98;
  t158 = my_piecewise3(t4, 0, -t153 * t155 / 0.2e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vlapl[0] = 0.2e1 * rho[0] * t158;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vtau[0] = 0.0e0;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t167 = t21 * t21;
  t169 = 0.1e1 / t22 / t167;
  t182 = 0.1e1 / t75 / t36;
  t183 = t182 * t50;
  t184 = t91 * t91;
  t189 = t74 * t76;
  t211 = 0.1e1 / t86 / t85;
  t221 = 0.1e1 / t96 / t49;
  t222 = t37 * t221;
  t223 = t109 * t109;
  t250 = my_piecewise3(t4, 0, t8 * t42 * t55 / 0.12e2 - t8 * t60 * t114 / 0.4e1 - 0.3e1 / 0.8e1 * t8 * t9 * (0.176e3 / 0.81e2 * t17 * t20 * t169 * t37 * t50 + 0.32e2 / 0.27e2 * t73 * t84 * t92 + 0.32e2 / 0.27e2 * t73 * t84 * t110 + 0.4e1 / 0.9e1 * t73 * t74 * t183 * t184 + 0.4e1 / 0.9e1 * t73 * t189 * t97 * t91 * t109 - 0.2e1 / 0.9e1 * t73 * t74 * t77 * (0.28e2 / 0.9e1 * t27 * t18 / t9 / t64 * t33 + 0.20e2 / 0.3e1 * t83 * t19 * t169 * t87 - 0.32e2 / 0.9e1 * t25 * t136 * t18 / t9 / t167 / t64 * t211) + 0.4e1 / 0.9e1 * t73 * t74 * t222 * t223 - 0.2e1 / 0.9e1 * t73 * t74 * t98 * ((0.88e2 / 0.9e1 * t20 * t169 - 0.40e2 / 0.9e1 * t40 * t66) * t45 * t47 + 0.16e2 / 0.3e1 * t104 * t106 + 0.40e2 / 0.9e1 * t46 * t18 * t22)));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * rho[0] * t250 + 0.4e1 * t119;

  t272 = t97 * t131;
  t317 = -0.16e2 / 0.27e2 * t17 * t84 * t122 - 0.2e1 / 0.9e1 * t17 * t93 - 0.2e1 / 0.9e1 * t17 * t111 + 0.16e2 / 0.27e2 * t73 * t84 * t132 + 0.4e1 / 0.9e1 * t73 * t74 * t182 * t50 * t131 * t91 + 0.2e1 / 0.9e1 * t73 * t189 * t272 * t109 - 0.2e1 / 0.9e1 * t73 * t74 * t77 * (-0.2e1 / 0.3e1 * t126 * t81 - 0.2e1 * t25 * t88 + 0.4e1 / 0.3e1 * t25 * t18 / t9 / t167 / t21 * t211 * sigma[0]) + 0.16e2 / 0.27e2 * t73 * t84 * t141 + 0.2e1 / 0.9e1 * t73 * t189 * t97 * t140 * t91 + 0.4e1 / 0.9e1 * t73 * t74 * t37 * t221 * t140 * t109 - 0.2e1 / 0.9e1 * t73 * t74 * t98 * (-t103 * t137 * t47 - 0.8e1 / 0.3e1 * t138 * t106);
  t322 = my_piecewise3(t4, 0, -t8 * t60 * t145 / 0.8e1 - 0.3e1 / 0.8e1 * t8 * t9 * t317);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.2e1 * rho[0] * t322 + 0.2e1 * t149;

  t329 = t76 * t97;
  t338 = my_piecewise3(t4, 0, 0.2e1 / 0.3e1 * t7 * t79 * t152 * t155 + t153 * t154 * t329 * t91 / 0.2e1 + t153 * t154 * t222 * t109);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[0] = 0.2e1 * rho[0] * t338 + 0.2e1 * t158;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[0] = 0.0e0;

  t345 = t131 * t131;
  t374 = t140 * t140;
  t394 = my_piecewise3(t4, 0, -0.3e1 / 0.8e1 * t8 * t9 * (-0.4e1 / 0.9e1 * t17 * t133 - 0.4e1 / 0.9e1 * t17 * t142 + 0.4e1 / 0.9e1 * t73 * t74 * t183 * t345 + 0.4e1 / 0.9e1 * t73 * t189 * t272 * t140 - 0.2e1 / 0.9e1 * t73 * t74 * t77 * (-t25 / t26 / sigma[0] * t34 / 0.4e1 + t25 * t45 * t128 / 0.4e1 - t25 * t18 / t9 / t167 / rho[0] * t211 / 0.2e1) + 0.4e1 / 0.9e1 * t73 * t74 * t222 * t374 - 0.2e1 / 0.9e1 * t73 * t74 * t98 * (-0.4e1 * t137 + 0.2e1 * t44 / t136 / sigma[0] * t47)));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.2e1 * rho[0] * t394;

  t404 = my_piecewise3(t4, 0, t153 * t154 * t329 * t131 / 0.2e1 + t153 * t154 * t222 * t140);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmalapl[0] = 0.2e1 * rho[0] * t404;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmatau[0] = 0.0e0;

  t413 = my_piecewise3(t4, 0, -0.2e1 * t7 / t9 * t152 * t154 * t222 * t45);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapl2[0] = 0.2e1 * rho[0] * t413;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapltau[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2tau2[0] = 0.0e0;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma, const double *lapl, const double *tau , double *zk MGGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t2, t3, t4, t5, t6, t7, t8, t9;
  double t10, t11, t12, t13, t14, t15, t16, t17;
  double t18, t19, t21, t22, t23, t24, t25, t26;
  double t27, t28, t29, t30, t31, t32, t33, t35;
  double t36, t37, t40, t41, t42, t43, t45, t46;
  double t47, t50, t51, t52, t56, t57, t61, t62;
  double t63, t64, t65, t66, t67, t68, t69, t70;
  double t71, t72, t74, t75, t76, t79, t80, t81;
  double t82, t84, t85, t86, t89, t90, t91, t95;
  double t96, t100;

#ifndef XC_DONT_COMPILE_VXC
  double t101, t106, t107, t110, t112, t113, t114, t115;
  double t116, t117, t119, t120, t121, t124, t126, t127;
  double t131, t132, t133, t135, t139, t140, t141, t145;
  double t146, t150, t151, t152, t156, t157, t162, t163;
  double t167, t168, t173, t174, t177, t179, t180, t181;
  double t182, t183, t188, t191, t192, t197, t198, t203;
  double t204, t206, t207, t208, t211, t213, t214, t218;
  double t219, t220, t222, t226, t227, t228, t232, t233;
  double t237, t238, t239, t243, t244, t249, t250, t254;
  double t255, t260, t263, t267, t274, t275, t278, t279;
  double t280, t283, t284, t288, t289, t293, t297, t304;
  double t305, t308, t309, t310, t313, t314, t318, t319;
  double t323, t324, t325, t326, t328, t329, t332, t334;
  double t335, t336, t338, t341, t343;

#ifndef XC_DONT_COMPILE_FXC
  double t348, t354, t357, t360, t363, t365, t367, t376;
  double t377, t385, t388, t399, t400, t401, t407, t408;
  double t428, t438, t439, t440, t467, t471, t473, t476;
  double t478, t480, t483, t489, t500, t513, t516, t526;
  double t534, t542, t549, t561, t569, t584, t587, t598;
  double t599, t600, t606, t607, t627, t637, t638, t639;
  double t666, t674, t687, t696, t701, t728, t748, t754;
  double t758, t764, t771, t788, t797, t802, t829, t849;
  double t855, t866, t869, t874, t883, t889, t896, t904;
  double t917, t926, t934, t962, t982, t989, t1017, t1037;
  double t1046, t1055, t1063, t1071;
#endif

#endif

#endif


  mgga_x_jk_params *params;

  assert(p->params != NULL);
  params = (mgga_x_jk_params * ) (p->params);

  t2 = 0.101e1 * p->threshold_dens;
  t3 = rho[0] <= t2;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t6 = 0.1e1 / t5;
  t7 = t4 * t6;
  t8 = M_CBRT2;
  t9 = t7 * t8;
  t10 = rho[0] + rho[1];
  t11 = POW_1_3(t10);
  t12 = t11 * t11;
  t13 = 0.1e1 / t12;
  t14 = rho[0] * t13;
  t15 = 0.1e1 / t10;
  t16 = rho[0] * t15;
  t17 = POW_1_3(t16);
  t18 = t4 * t4;
  t19 = params->beta * t18;
  t21 = POW_1_3(0.1e1 / M_PI);
  t22 = 0.1e1 / t21;
  t23 = M_CBRT4;
  t24 = t22 * t23;
  t25 = t19 * t24;
  t26 = rho[0] * rho[0];
  t27 = POW_1_3(rho[0]);
  t28 = t27 * t27;
  t29 = t28 * t26;
  t30 = 0.1e1 / t29;
  t31 = sigma[0] * t30;
  t32 = params->gamma * params->beta;
  t33 = sqrt(sigma[0]);
  t35 = 0.1e1 / t27 / rho[0];
  t36 = t33 * t35;
  t37 = log(t36 + sqrt(t36 * t36 + 0.1e1));
  t40 = t32 * t36 * t37 + 0.1e1;
  t41 = 0.1e1 / t40;
  t42 = t28 * rho[0];
  t43 = 0.1e1 / t42;
  t45 = -lapl[0] * t43 + t31;
  t46 = 0.1e1 / sigma[0];
  t47 = t45 * t46;
  t50 = 0.2e1 * t47 * t29 + 0.1e1;
  t51 = 0.1e1 / t50;
  t52 = t41 * t51;
  t56 = 0.1e1 + 0.2e1 / 0.9e1 * t25 * t31 * t52;
  t57 = t17 * t56;
  t61 = my_piecewise3(t3, 0, -0.3e1 / 0.4e1 * t9 * t14 * t57);
  t62 = rho[1] <= t2;
  t63 = rho[1] * t13;
  t64 = rho[1] * t15;
  t65 = POW_1_3(t64);
  t66 = rho[1] * rho[1];
  t67 = POW_1_3(rho[1]);
  t68 = t67 * t67;
  t69 = t68 * t66;
  t70 = 0.1e1 / t69;
  t71 = sigma[2] * t70;
  t72 = sqrt(sigma[2]);
  t74 = 0.1e1 / t67 / rho[1];
  t75 = t72 * t74;
  t76 = log(t75 + sqrt(t75 * t75 + 0.1e1));
  t79 = t32 * t75 * t76 + 0.1e1;
  t80 = 0.1e1 / t79;
  t81 = t68 * rho[1];
  t82 = 0.1e1 / t81;
  t84 = -lapl[1] * t82 + t71;
  t85 = 0.1e1 / sigma[2];
  t86 = t84 * t85;
  t89 = 0.2e1 * t86 * t69 + 0.1e1;
  t90 = 0.1e1 / t89;
  t91 = t80 * t90;
  t95 = 0.1e1 + 0.2e1 / 0.9e1 * t25 * t71 * t91;
  t96 = t65 * t95;
  t100 = my_piecewise3(t62, 0, -0.3e1 / 0.4e1 * t9 * t63 * t96);
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = t61 + t100;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t101 = t13 * t17;
  t106 = 0.1e1 / t12 / t10;
  t107 = rho[0] * t106;
  t110 = t9 * t107 * t57 / 0.2e1;
  t112 = t7 * t8 * rho[0];
  t113 = t17 * t17;
  t114 = 0.1e1 / t113;
  t115 = t13 * t114;
  t116 = t10 * t10;
  t117 = 0.1e1 / t116;
  t119 = -rho[0] * t117 + t15;
  t120 = t56 * t119;
  t121 = t115 * t120;
  t124 = t26 * rho[0];
  t126 = 0.1e1 / t28 / t124;
  t127 = sigma[0] * t126;
  t131 = t40 * t40;
  t132 = 0.1e1 / t131;
  t133 = t132 * t51;
  t135 = 0.1e1 / t27 / t26;
  t139 = t31 + 0.1e1;
  t140 = sqrt(t139);
  t141 = 0.1e1 / t140;
  t145 = -0.4e1 / 0.3e1 * t32 * t33 * t135 * t37 - 0.4e1 / 0.3e1 * t32 * t127 * t141;
  t146 = t133 * t145;
  t150 = t50 * t50;
  t151 = 0.1e1 / t150;
  t152 = t41 * t151;
  t156 = -0.8e1 / 0.3e1 * t127 + 0.5e1 / 0.3e1 * lapl[0] * t30;
  t157 = t156 * t46;
  t162 = 0.2e1 * t157 * t29 + 0.16e2 / 0.3e1 * t47 * t42;
  t163 = t152 * t162;
  t167 = -0.16e2 / 0.27e2 * t25 * t127 * t52 - 0.2e1 / 0.9e1 * t25 * t31 * t146 - 0.2e1 / 0.9e1 * t25 * t31 * t163;
  t168 = t17 * t167;
  t173 = my_piecewise3(t3, 0, -0.3e1 / 0.4e1 * t9 * t101 * t56 + t110 - t112 * t121 / 0.4e1 - 0.3e1 / 0.4e1 * t9 * t14 * t168);
  t174 = rho[1] * t106;
  t177 = t9 * t174 * t96 / 0.2e1;
  t179 = 0.1e1 / t12 / t116;
  t180 = t66 * t179;
  t181 = t65 * t65;
  t182 = 0.1e1 / t181;
  t183 = t182 * t95;
  t188 = my_piecewise3(t62, 0, t177 + t9 * t180 * t183 / 0.4e1);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t61 + t100 + t10 * (t173 + t188);

  t191 = t26 * t179;
  t192 = t114 * t56;
  t197 = my_piecewise3(t3, 0, t110 + t9 * t191 * t192 / 0.4e1);
  t198 = t13 * t65;
  t203 = t7 * t8 * rho[1];
  t204 = t13 * t182;
  t206 = -rho[1] * t117 + t15;
  t207 = t95 * t206;
  t208 = t204 * t207;
  t211 = t66 * rho[1];
  t213 = 0.1e1 / t68 / t211;
  t214 = sigma[2] * t213;
  t218 = t79 * t79;
  t219 = 0.1e1 / t218;
  t220 = t219 * t90;
  t222 = 0.1e1 / t67 / t66;
  t226 = t71 + 0.1e1;
  t227 = sqrt(t226);
  t228 = 0.1e1 / t227;
  t232 = -0.4e1 / 0.3e1 * t32 * t72 * t222 * t76 - 0.4e1 / 0.3e1 * t32 * t214 * t228;
  t233 = t220 * t232;
  t237 = t89 * t89;
  t238 = 0.1e1 / t237;
  t239 = t80 * t238;
  t243 = -0.8e1 / 0.3e1 * t214 + 0.5e1 / 0.3e1 * lapl[1] * t70;
  t244 = t243 * t85;
  t249 = 0.2e1 * t244 * t69 + 0.16e2 / 0.3e1 * t86 * t81;
  t250 = t239 * t249;
  t254 = -0.16e2 / 0.27e2 * t25 * t214 * t91 - 0.2e1 / 0.9e1 * t25 * t71 * t233 - 0.2e1 / 0.9e1 * t25 * t71 * t250;
  t255 = t65 * t254;
  t260 = my_piecewise3(t62, 0, -0.3e1 / 0.4e1 * t9 * t198 * t95 + t177 - t203 * t208 / 0.4e1 - 0.3e1 / 0.4e1 * t9 * t63 * t255);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t61 + t100 + t10 * (t197 + t260);

  t263 = t19 * t22;
  t267 = 0.1e1 / t33;
  t274 = t32 * t267 * t35 * t37 / 0.2e1 + t32 * t30 * t141 / 0.2e1;
  t275 = t133 * t274;
  t278 = sigma[0] * sigma[0];
  t279 = 0.1e1 / t278;
  t280 = t45 * t279;
  t283 = -0.2e1 * t280 * t29 + 0.2e1 * t46;
  t284 = t152 * t283;
  t288 = 0.2e1 / 0.9e1 * t263 * t23 * t30 * t52 - 0.2e1 / 0.9e1 * t25 * t31 * t275 - 0.2e1 / 0.9e1 * t25 * t31 * t284;
  t289 = t17 * t288;
  t293 = my_piecewise3(t3, 0, -0.3e1 / 0.4e1 * t9 * t14 * t289);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = t10 * t293;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = 0.0e0;

  t297 = 0.1e1 / t72;
  t304 = t32 * t297 * t74 * t76 / 0.2e1 + t32 * t70 * t228 / 0.2e1;
  t305 = t220 * t304;
  t308 = sigma[2] * sigma[2];
  t309 = 0.1e1 / t308;
  t310 = t84 * t309;
  t313 = -0.2e1 * t310 * t69 + 0.2e1 * t85;
  t314 = t239 * t313;
  t318 = 0.2e1 / 0.9e1 * t263 * t23 * t70 * t91 - 0.2e1 / 0.9e1 * t25 * t71 * t305 - 0.2e1 / 0.9e1 * t25 * t71 * t314;
  t319 = t65 * t318;
  t323 = my_piecewise3(t62, 0, -0.3e1 / 0.4e1 * t9 * t63 * t319);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = t10 * t323;

  t324 = t6 * t8;
  t325 = 0.1e1 / t28;
  t326 = t325 * t13;
  t328 = t324 * t326 * t17;
  t329 = params->beta * t22;
  t332 = t329 * t23 * t41 * t151;
  t334 = my_piecewise3(t3, 0, -t328 * t332);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vlapl[0] = t10 * t334;

  t335 = 0.1e1 / t68;
  t336 = t335 * t13;
  t338 = t324 * t336 * t65;
  t341 = t329 * t23 * t80 * t238;
  t343 = my_piecewise3(t62, 0, -t338 * t341);
  if(vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vlapl[1] = t10 * t343;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vtau[0] = 0.0e0;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vtau[1] = 0.0e0;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t348 = t9 * t106 * t17 * t56;
  t354 = rho[0] * t179;
  t357 = 0.5e1 / 0.6e1 * t9 * t354 * t57;
  t360 = t112 * t106 * t114 * t120;
  t363 = t9 * t107 * t168;
  t365 = 0.1e1 / t113 / t16;
  t367 = t119 * t119;
  t376 = t116 * t10;
  t377 = 0.1e1 / t376;
  t385 = t26 * t26;
  t388 = sigma[0] / t28 / t385;
  t399 = 0.1e1 / t131 / t40;
  t400 = t399 * t51;
  t401 = t145 * t145;
  t407 = t19 * t24 * sigma[0];
  t408 = t30 * t132;
  t428 = 0.1e1 / t140 / t139;
  t438 = 0.1e1 / t150 / t50;
  t439 = t41 * t438;
  t440 = t162 * t162;
  t467 = my_piecewise3(t3, 0, t348 - t9 * t121 / 0.2e1 - 0.3e1 / 0.2e1 * t9 * t101 * t167 - t357 + t360 / 0.3e1 + t363 + t112 * t13 * t365 * t56 * t367 / 0.6e1 - t112 * t115 * t167 * t119 / 0.2e1 - t112 * t115 * t56 * (0.2e1 * rho[0] * t377 - 0.2e1 * t117) / 0.4e1 - 0.3e1 / 0.4e1 * t9 * t14 * t17 * (0.176e3 / 0.81e2 * t25 * t388 * t52 + 0.32e2 / 0.27e2 * t25 * t127 * t146 + 0.32e2 / 0.27e2 * t25 * t127 * t163 + 0.4e1 / 0.9e1 * t25 * t31 * t400 * t401 + 0.4e1 / 0.9e1 * t407 * t408 * t151 * t145 * t162 - 0.2e1 / 0.9e1 * t25 * t31 * t133 * (0.28e2 / 0.9e1 * t32 * t33 / t27 / t124 * t37 + 0.20e2 / 0.3e1 * t32 * t388 * t141 - 0.16e2 / 0.9e1 * t32 * t278 / t27 / t385 / t124 * t428) + 0.4e1 / 0.9e1 * t25 * t31 * t439 * t440 - 0.2e1 / 0.9e1 * t25 * t31 * t152 * (0.2e1 * (0.88e2 / 0.9e1 * t388 - 0.40e2 / 0.9e1 * lapl[0] * t126) * t46 * t29 + 0.32e2 / 0.3e1 * t157 * t42 + 0.80e2 / 0.9e1 * t47 * t28)));
  t471 = 0.5e1 / 0.6e1 * t9 * rho[1] * t179 * t96;
  t473 = 0.1e1 / t12 / t376;
  t476 = t9 * t66 * t473 * t183;
  t478 = t116 * t116;
  t480 = 0.1e1 / t12 / t478;
  t483 = 0.1e1 / t181 / t64;
  t489 = my_piecewise3(t62, 0, -t471 - 0.5e1 / 0.6e1 * t476 + t9 * t211 * t480 * t483 * t95 / 0.6e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = 0.2e1 * t173 + 0.2e1 * t188 + t10 * (t467 + t489);

  t500 = t9 * t26 * t473 * t192;
  t513 = my_piecewise3(t3, 0, t348 / 0.2e1 - t357 + t360 / 0.6e1 + t363 / 0.2e1 + t9 * t354 * t192 / 0.2e1 - 0.2e1 / 0.3e1 * t500 - t7 * t8 * t26 * t179 * t365 * t120 / 0.6e1 + t9 * t191 * t114 * t167 / 0.4e1);
  t516 = t9 * t106 * t65 * t95;
  t526 = t203 * t106 * t182 * t207;
  t534 = rho[1] * t377;
  t542 = t9 * t174 * t255;
  t549 = my_piecewise3(t62, 0, t516 / 0.2e1 + t9 * t179 * t182 * t95 * rho[1] / 0.4e1 - t471 - t476 / 0.6e1 + t526 / 0.6e1 - t7 * t8 * t66 * t179 * t483 * t207 / 0.6e1 - t203 * t204 * t95 * (-t117 + 0.2e1 * t534) / 0.4e1 + t542 / 0.2e1 + t9 * t180 * t182 * t254 / 0.4e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = t173 + t188 + t197 + t260 + t10 * (t513 + t549);

  t561 = my_piecewise3(t3, 0, -t357 - 0.5e1 / 0.6e1 * t500 + t9 * t124 * t480 * t365 * t56 / 0.6e1);
  t569 = t206 * t206;
  t584 = t66 * t66;
  t587 = sigma[2] / t68 / t584;
  t598 = 0.1e1 / t218 / t79;
  t599 = t598 * t90;
  t600 = t232 * t232;
  t606 = t19 * t24 * sigma[2];
  t607 = t70 * t219;
  t627 = 0.1e1 / t227 / t226;
  t637 = 0.1e1 / t237 / t89;
  t638 = t80 * t637;
  t639 = t249 * t249;
  t666 = my_piecewise3(t62, 0, t516 - t9 * t208 / 0.2e1 - 0.3e1 / 0.2e1 * t9 * t198 * t254 - t471 + t526 / 0.3e1 + t542 + t203 * t13 * t483 * t95 * t569 / 0.6e1 - t203 * t204 * t254 * t206 / 0.2e1 - t203 * t204 * t95 * (-0.2e1 * t117 + 0.2e1 * t534) / 0.4e1 - 0.3e1 / 0.4e1 * t9 * t63 * t65 * (0.176e3 / 0.81e2 * t25 * t587 * t91 + 0.32e2 / 0.27e2 * t25 * t214 * t233 + 0.32e2 / 0.27e2 * t25 * t214 * t250 + 0.4e1 / 0.9e1 * t25 * t71 * t599 * t600 + 0.4e1 / 0.9e1 * t606 * t607 * t238 * t232 * t249 - 0.2e1 / 0.9e1 * t25 * t71 * t220 * (0.28e2 / 0.9e1 * t32 * t72 / t67 / t211 * t76 + 0.20e2 / 0.3e1 * t32 * t587 * t228 - 0.16e2 / 0.9e1 * t32 * t308 / t67 / t584 / t211 * t627) + 0.4e1 / 0.9e1 * t25 * t71 * t638 * t639 - 0.2e1 / 0.9e1 * t25 * t71 * t239 * (0.2e1 * (0.88e2 / 0.9e1 * t587 - 0.40e2 / 0.9e1 * lapl[1] * t213) * t85 * t69 + 0.32e2 / 0.3e1 * t244 * t81 + 0.80e2 / 0.9e1 * t86 * t68)));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = 0.2e1 * t197 + 0.2e1 * t260 + t10 * (t561 + t666);

  t674 = t9 * t107 * t289 / 0.2e1;
  t687 = t30 * t41;
  t696 = t51 * t274;
  t701 = t151 * t274;
  t728 = t151 * t283;
  t748 = -0.16e2 / 0.27e2 * t263 * t23 * t126 * t52 - 0.2e1 / 0.9e1 * t25 * t408 * t51 * t145 - 0.2e1 / 0.9e1 * t25 * t687 * t151 * t162 + 0.16e2 / 0.27e2 * t25 * t127 * t275 + 0.4e1 / 0.9e1 * t407 * t30 * t399 * t696 * t145 + 0.2e1 / 0.9e1 * t407 * t408 * t701 * t162 - 0.2e1 / 0.9e1 * t25 * t31 * t133 * (-0.2e1 / 0.3e1 * t32 * t267 * t135 * t37 - 0.2e1 * t32 * t126 * t141 + 0.2e1 / 0.3e1 * t32 / t27 / t385 / t26 * t428 * sigma[0]) + 0.16e2 / 0.27e2 * t25 * t127 * t284 + 0.2e1 / 0.9e1 * t407 * t408 * t728 * t145 + 0.4e1 / 0.9e1 * t407 * t687 * t438 * t283 * t162 - 0.2e1 / 0.9e1 * t25 * t31 * t152 * (-0.2e1 * t156 * t279 * t29 - 0.16e2 / 0.3e1 * t280 * t42);
  t754 = my_piecewise3(t3, 0, -0.3e1 / 0.4e1 * t9 * t101 * t288 + t674 - t112 * t115 * t288 * t119 / 0.4e1 - 0.3e1 / 0.4e1 * t9 * t14 * t17 * t748);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = t10 * t754 + t293;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  t758 = t9 * t174 * t319 / 0.2e1;
  t764 = my_piecewise3(t62, 0, t758 + t9 * t180 * t182 * t318 / 0.4e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = t10 * t764 + t323;

  t771 = my_piecewise3(t3, 0, t674 + t9 * t191 * t114 * t288 / 0.4e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = t10 * t771 + t293;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t788 = t70 * t80;
  t797 = t90 * t304;
  t802 = t238 * t304;
  t829 = t238 * t313;
  t849 = -0.16e2 / 0.27e2 * t263 * t23 * t213 * t91 - 0.2e1 / 0.9e1 * t25 * t607 * t90 * t232 - 0.2e1 / 0.9e1 * t25 * t788 * t238 * t249 + 0.16e2 / 0.27e2 * t25 * t214 * t305 + 0.4e1 / 0.9e1 * t606 * t70 * t598 * t797 * t232 + 0.2e1 / 0.9e1 * t606 * t607 * t802 * t249 - 0.2e1 / 0.9e1 * t25 * t71 * t220 * (-0.2e1 / 0.3e1 * t32 * t297 * t222 * t76 - 0.2e1 * t32 * t213 * t228 + 0.2e1 / 0.3e1 * t32 / t67 / t584 / t66 * t627 * sigma[2]) + 0.16e2 / 0.27e2 * t25 * t214 * t314 + 0.2e1 / 0.9e1 * t606 * t607 * t829 * t232 + 0.4e1 / 0.9e1 * t606 * t788 * t637 * t313 * t249 - 0.2e1 / 0.9e1 * t25 * t71 * t239 * (-0.2e1 * t243 * t309 * t69 - 0.16e2 / 0.3e1 * t310 * t81);
  t855 = my_piecewise3(t62, 0, -0.3e1 / 0.4e1 * t9 * t198 * t318 + t758 - t203 * t204 * t318 * t206 / 0.4e1 - 0.3e1 / 0.4e1 * t9 * t63 * t65 * t849);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = t10 * t855 + t323;

  t866 = 0.2e1 / 0.3e1 * t324 * t325 * t106 * t17 * t332;
  t869 = t329 * t23;
  t874 = t132 * t151;
  t883 = my_piecewise3(t3, 0, 0.2e1 / 0.3e1 * t324 * t43 * t13 * t17 * t332 + t866 - t324 * t326 * t114 * t869 * t152 * t119 / 0.3e1 + t328 * t869 * t874 * t145 + 0.2e1 * t328 * t869 * t439 * t162);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[0] = t10 * t883 + t334;

  t889 = 0.2e1 / 0.3e1 * t324 * t335 * t106 * t65 * t341;
  t896 = my_piecewise3(t62, 0, t889 + t324 * t67 * t179 * t182 * t341 / 0.3e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[1] = t10 * t896 + t343;

  t904 = my_piecewise3(t3, 0, t866 + t324 * t27 * t179 * t114 * t332 / 0.3e1);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[2] = t10 * t904 + t334;

  t917 = t219 * t238;
  t926 = my_piecewise3(t62, 0, 0.2e1 / 0.3e1 * t324 * t82 * t13 * t65 * t341 + t889 - t324 * t336 * t182 * t869 * t239 * t206 / 0.3e1 + t338 * t869 * t917 * t232 + 0.2e1 * t338 * t869 * t638 * t249);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[3] = t10 * t926 + t343;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[3] = 0.0e0;

  t934 = t274 * t274;
  t962 = t283 * t283;
  t982 = my_piecewise3(t3, 0, -0.3e1 / 0.4e1 * t9 * t14 * t17 * (-0.4e1 / 0.9e1 * t25 * t408 * t696 - 0.4e1 / 0.9e1 * t25 * t687 * t728 + 0.4e1 / 0.9e1 * t25 * t31 * t400 * t934 + 0.4e1 / 0.9e1 * t407 * t408 * t701 * t283 - 0.2e1 / 0.9e1 * t25 * t31 * t133 * (-t32 / t33 / sigma[0] * t35 * t37 / 0.4e1 + t32 * t46 * t30 * t141 / 0.4e1 - t32 / t27 / t385 / rho[0] * t428 / 0.4e1) + 0.4e1 / 0.9e1 * t25 * t31 * t439 * t962 - 0.2e1 / 0.9e1 * t25 * t31 * t152 * (-0.4e1 * t279 + 0.4e1 * t45 / t278 / sigma[0] * t29)));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = t10 * t982;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  t989 = t304 * t304;
  t1017 = t313 * t313;
  t1037 = my_piecewise3(t62, 0, -0.3e1 / 0.4e1 * t9 * t63 * t65 * (-0.4e1 / 0.9e1 * t25 * t607 * t797 - 0.4e1 / 0.9e1 * t25 * t788 * t829 + 0.4e1 / 0.9e1 * t25 * t71 * t599 * t989 + 0.4e1 / 0.9e1 * t606 * t607 * t802 * t313 - 0.2e1 / 0.9e1 * t25 * t71 * t220 * (-t32 / t72 / sigma[2] * t74 * t76 / 0.4e1 + t32 * t85 * t70 * t228 / 0.4e1 - t32 / t67 / t584 / rho[1] * t627 / 0.4e1) + 0.4e1 / 0.9e1 * t25 * t71 * t638 * t1017 - 0.2e1 / 0.9e1 * t25 * t71 * t239 * (-0.4e1 * t309 + 0.4e1 * t84 / t308 / sigma[2] * t69)));
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = t10 * t1037;

  t1046 = my_piecewise3(t3, 0, t328 * t869 * t874 * t274 + 0.2e1 * t328 * t869 * t439 * t283);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmalapl[0] = t10 * t1046;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmalapl[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmalapl[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmalapl[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmalapl[4] = 0.0e0;

  t1055 = my_piecewise3(t62, 0, t338 * t869 * t917 * t304 + 0.2e1 * t338 * t869 * t638 * t313);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmalapl[5] = t10 * t1055;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmatau[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmatau[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmatau[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmatau[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmatau[4] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmatau[5] = 0.0e0;

  t1063 = my_piecewise3(t3, 0, -0.4e1 * t324 * t27 * t13 * t17 * t869 * t439 * t46);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapl2[0] = t10 * t1063;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapl2[1] = 0.0e0;

  t1071 = my_piecewise3(t62, 0, -0.4e1 * t324 * t67 * t13 * t65 * t869 * t638 * t85);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapl2[2] = t10 * t1071;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapltau[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapltau[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapltau[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapltau[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2tau2[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2tau2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2tau2[2] = 0.0e0;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}

