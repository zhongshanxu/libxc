/* 
  This file was generated automatically with ./scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : ./maple/mgga_exc/mgga_xc_lp90.mpl
  Type of functional: mgga_exc
*/

#define maple2c_order 2
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC)


static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma, const double *lapl, const double *tau , double *zk MGGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t2, t3, t4, t6, t10, t13, t14, t15;
  double t16;

#ifndef XC_DONT_COMPILE_VXC
  double t18, t20, t25, t29, t30, t33;

#ifndef XC_DONT_COMPILE_FXC
  double t44;
#endif

#endif

#endif



  t2 = rho[0] * rho[0];
  t3 = POW_1_3(rho[0]);
  t4 = t3 * t3;
  t6 = 0.1e1 / t4 / t2;
  t10 = 0.1e1 / t4 / rho[0];
  t13 = 0.80569e0 + 0.37655000000000000000e-3 * sigma[0] * t6 - 0.37655000000000000000e-3 * lapl[0] * t10;
  t14 = 0.1e1 / t3;
  t15 = t14 + 0.40743e-2;
  t16 = 0.1e1 / t15;
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = -t13 * t16;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t18 = t2 * rho[0];
  t20 = 0.1e1 / t4 / t18;
  t25 = -0.10041333333333333333e-2 * sigma[0] * t20 + 0.62758333333333333333e-3 * lapl[0] * t6;
  t29 = t15 * t15;
  t30 = 0.1e1 / t29;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = (-t13 * t16) - rho[0] * t25 * t16 - t14 * t13 * t30 / 0.3e1;

  t33 = t10 * t16;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = -0.37655000000000000000e-3 * t33;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vlapl[0] = 0.37655000000000000000e-3 / t4 * t16;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vtau[0] = 0.0e0;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t44 = t2 * t2;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = -0.2e1 * t25 * t16 - 0.2e1 / 0.9e1 * t13 * t30 / t3 / rho[0] - rho[0] * (0.36818222222222222221e-2 * sigma[0] / t4 / t44 - 0.16735555555555555555e-2 * lapl[0] * t20) * t16 - 0.2e1 / 0.3e1 * t14 * t25 * t30 - 0.2e1 / 0.9e1 * t10 * t13 / t29 / t15;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.62758333333333333333e-3 * t6 * t16 - 0.12551666666666666667e-3 / t18 * t30;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[0] = -0.25103333333333333333e-3 * t33 + 0.12551666666666666667e-3 / t2 * t30;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmalapl[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmatau[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapl2[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapltau[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2tau2[0] = 0.0e0;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma, const double *lapl, const double *tau , double *zk MGGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_EXC
  double t3, t4, t5, t6, t7, t9, t12, t13;
  double t15, t16, t17, t18, t19, t21, t22, t23;
  double t24, t27, t28, t30, t31, t33, t34, t35;
  double t36, t39, t40, t41, t42;

#ifndef XC_DONT_COMPILE_VXC
  double t44, t48, t49, t51, t52, t55, t56, t58;
  double t59, t62, t63, t66, t70, t71, t73, t75;
  double t76, t79, t81, t82, t85, t86, t89, t93;
  double t94, t97, t98, t100, t101;

#ifndef XC_DONT_COMPILE_FXC
  double t103, t109, t110, t114, t123, t124, t128, t129;
  double t130, t134, t135, t147, t153, t154, t179, t183;
  double t187, t199, t211, t213, t219, t223, t230, t233;
  double t234, t241;
#endif

#endif

#endif



  t3 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t4 = rho[0] + rho[1];
  t5 = t4 * t4;
  t6 = POW_1_3(t4);
  t7 = t6 * t6;
  t9 = 0.1e1 / t7 / t5;
  t12 = POW_1_3(rho[0]);
  t13 = t12 * t12;
  t15 = 0.1e1 / t13 / rho[0];
  t16 = lapl[0] * t15;
  t17 = rho[0] - rho[1];
  t18 = 0.1e1 / t4;
  t19 = t17 * t18;
  t21 = 0.1e1 / 0.2e1 + t19 / 0.2e1;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = t23 * t21;
  t27 = POW_1_3(rho[1]);
  t28 = t27 * t27;
  t30 = 0.1e1 / t28 / rho[1];
  t31 = lapl[1] * t30;
  t33 = 0.1e1 / 0.2e1 - t19 / 0.2e1;
  t34 = POW_1_3(t33);
  t35 = t34 * t34;
  t36 = t35 * t33;
  t39 = 0.80569e0 + 0.37655000000000000000e-3 * t3 * t9 - 0.37655000000000000000e-3 * t16 * t24 - 0.37655000000000000000e-3 * t31 * t36;
  t40 = 0.1e1 / t6;
  t41 = t40 + 0.40743e-2;
  t42 = 0.1e1 / t41;
  if(zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    zk[0] = -t39 * t42;

#ifndef XC_DONT_COMPILE_VXC

  if(order < 1) return;


  t44 = t5 * t4;
  t48 = 0.10041333333333333333e-2 * t3 / t7 / t44;
  t49 = rho[0] * rho[0];
  t51 = 0.1e1 / t13 / t49;
  t52 = lapl[0] * t51;
  t55 = 0.1e1 / t5;
  t56 = t17 * t55;
  t58 = t18 / 0.2e1 - t56 / 0.2e1;
  t59 = t23 * t58;
  t62 = -t58;
  t63 = t35 * t62;
  t66 = -t48 + 0.62758333333333333333e-3 * t52 * t24 - 0.62758333333333333333e-3 * t16 * t59 - 0.62758333333333333333e-3 * t31 * t63;
  t70 = t41 * t41;
  t71 = 0.1e1 / t70;
  t73 = t40 * t39 * t71 / 0.3e1;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = -t4 * t66 * t42 - t73 + (-t39 * t42);

  t75 = -t18 / 0.2e1 - t56 / 0.2e1;
  t76 = t23 * t75;
  t79 = rho[1] * rho[1];
  t81 = 0.1e1 / t28 / t79;
  t82 = lapl[1] * t81;
  t85 = -t75;
  t86 = t35 * t85;
  t89 = -t48 - 0.62758333333333333333e-3 * t16 * t76 + 0.62758333333333333333e-3 * t82 * t36 - 0.62758333333333333333e-3 * t31 * t86;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = -t4 * t89 * t42 - t73 + (-t39 * t42);

  t93 = 0.1e1 / t7 / t4;
  t94 = t93 * t42;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[0] = -0.37655000000000000000e-3 * t94;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[1] = -0.75310000000000000000e-3 * t94;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vsigma[2] = vsigma[0];

  t97 = t4 * t15;
  t98 = t24 * t42;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vlapl[0] = 0.37655000000000000000e-3 * t97 * t98;

  t100 = t4 * t30;
  t101 = t36 * t42;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vlapl[1] = 0.37655000000000000000e-3 * t100 * t101;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vtau[0] = 0.0e0;

  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vtau[1] = 0.0e0;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t103 = t66 * t42;
  t109 = 0.2e1 / 0.9e1 * t39 * t71 / t6 / t4;
  t110 = t5 * t5;
  t114 = 0.36818222222222222221e-2 * t3 / t7 / t110;
  t123 = 0.1e1 / t22;
  t124 = t58 * t58;
  t128 = 0.1e1 / t44;
  t129 = t17 * t128;
  t130 = -t55 + t129;
  t134 = 0.1e1 / t34;
  t135 = t62 * t62;
  t147 = t40 * t66 * t71;
  t153 = 0.2e1 / 0.9e1 * t93 * t39 / t70 / t41;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = -0.2e1 * t103 - t109 - t4 * (t114 - 0.16735555555555555555e-2 * lapl[0] / t13 / t49 / rho[0] * t24 + 0.20919444444444444444e-2 * t52 * t59 - 0.41838888888888888889e-3 * t16 * t123 * t124 - 0.62758333333333333333e-3 * t16 * t23 * t130 - 0.41838888888888888889e-3 * t31 * t134 * t135 + 0.62758333333333333333e-3 * t31 * t35 * t130) * t42 - 0.2e1 / 0.3e1 * t147 - t153;

  t154 = t89 * t42;
  t179 = t40 * t89 * t71;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = -t103 - t109 - t154 - t4 * (t114 + 0.10459722222222222222e-2 * t52 * t76 - 0.41838888888888888889e-3 * t16 * t123 * t75 * t58 - 0.62758333333333333333e-3 * t16 * t23 * t17 * t128 + 0.10459722222222222222e-2 * t82 * t63 - 0.41838888888888888889e-3 * t31 * t134 * t85 * t62 + 0.62758333333333333333e-3 * t31 * t35 * t17 * t128) * t42 - t179 / 0.3e1 - t147 / 0.3e1 - t153;

  t183 = t75 * t75;
  t187 = t55 + t129;
  t199 = t85 * t85;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = -0.2e1 * t154 - t109 - t4 * (t114 - 0.41838888888888888889e-3 * t16 * t123 * t183 - 0.62758333333333333333e-3 * t16 * t23 * t187 - 0.16735555555555555555e-2 * lapl[1] / t28 / t79 / rho[1] * t36 + 0.20919444444444444444e-2 * t82 * t86 - 0.41838888888888888889e-3 * t31 * t134 * t199 + 0.62758333333333333333e-3 * t31 * t35 * t187) * t42 - 0.2e1 / 0.3e1 * t179 - t153;

  t211 = t9 * t42;
  t213 = t128 * t71;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = 0.62758333333333333333e-3 * t211 - 0.12551666666666666667e-3 * t213;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.12551666666666666667e-2 * t211 - 0.25103333333333333333e-3 * t213;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = v2rhosigma[0];

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = v2rhosigma[2];

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = v2rhosigma[1];

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = v2rhosigma[3];

  t219 = 0.37655000000000000000e-3 * t15 * t24 * t42;
  t223 = t23 * t42;
  t230 = 0.12551666666666666667e-3 * t40 * t15 * t24 * t71;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[0] = t219 - 0.62758333333333333333e-3 * t4 * t51 * t98 + 0.62758333333333333333e-3 * t97 * t223 * t58 + t230;

  t233 = 0.37655000000000000000e-3 * t30 * t36 * t42;
  t234 = t35 * t42;
  t241 = 0.12551666666666666667e-3 * t40 * t30 * t36 * t71;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[1] = t233 + 0.62758333333333333333e-3 * t100 * t234 * t62 + t241;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[2] = t219 + 0.62758333333333333333e-3 * t97 * t223 * t75 + t230;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[3] = t233 - 0.62758333333333333333e-3 * t4 * t81 * t101 + 0.62758333333333333333e-3 * t100 * t234 * t85 + t241;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[4] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigma2[5] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmalapl[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmalapl[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmalapl[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmalapl[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmalapl[4] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmalapl[5] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmatau[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmatau[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmatau[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmatau[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmatau[4] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2sigmatau[5] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapl2[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapl2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapl2[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapltau[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapltau[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapltau[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2lapltau[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2tau2[0] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2tau2[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2tau2[2] = 0.0e0;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif

#endif


}

