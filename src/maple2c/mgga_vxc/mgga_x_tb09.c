/* 
  This file was generated automatically with ./scripts/maple2c.pl.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : ./maple/mgga_vxc/mgga_x_tb09.mpl
  Type of functional: mgga_vxc
*/

#define maple2c_order 2
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC)


static inline void
func_unpol(const xc_func_type *p, int order, const double *rho, const double *sigma, const double *lapl, const double *tau MGGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_VXC
  double t2, t3, t4, t5, t6, t7, t8, t10;
  double t13, t14, t16, t17, t19, t22, t23, t24;
  double t25, t26, t27, t28, t30, t31, t34, t36;
  double t37, t38, t43, t44, t45, t46, t48, t49;
  double t52, t53, t54, t55, t60;

#ifndef XC_DONT_COMPILE_FXC
  double t62, t63, t66, t70, t74, t75, t76, t77;
  double t79, t80, t83, t86, t88, t89, t90, t93;
  double t94, t95, t97, t100, t102, t112, t113, t117;
  double t119, t125, t137, t138, t143, t160, t167, t169;
  double t170, t175, t193, t194, t199, t213;
#endif

#endif


  mgga_x_tb09_params *params;

  assert(p->params != NULL);
  params = (mgga_x_tb09_params * ) (p->params);

  t2 = M_CBRTPI;
  t3 = params->c * t2;
  t4 = M_CBRT2;
  t5 = t4 * t4;
  t6 = lapl[0] * t5;
  t7 = POW_1_3(rho[0]);
  t8 = t7 * t7;
  t10 = 0.1e1 / t8 / rho[0];
  t13 = tau[0] * t5;
  t14 = t13 * t10;
  t16 = sigma[0] * t5;
  t17 = rho[0] * rho[0];
  t19 = 0.1e1 / t8 / t17;
  t22 = t6 * t10 / 0.6e1 - 0.53333333333333333333e0 * t14 + 0.66666666666666666667e-1 * t16 * t19;
  t23 = fabs(t22);
  t24 = t23 < 0.50e-12;
  t25 = 0.0e0 < t22;
  t26 = my_piecewise3(t25, 0.50e-12, -0.50e-12);
  t27 = my_piecewise3(t24, t26, t22);
  t28 = xc_mgga_x_br89_get_x(t27);
  t30 = exp(t28 / 0.3e1);
  t31 = exp(-t28);
  t34 = t31 * (0.1e1 + t28 / 0.2e1);
  t36 = t30 * (0.1e1 - t34);
  t37 = 0.1e1 / t28;
  t38 = t36 * t37;
  t43 = sqrt(0.15e2);
  t44 = (0.3e1 * params->c - 0.2e1) * t43;
  t45 = 0.1e1 / M_PI;
  t46 = M_SQRT2;
  t48 = params->alpha * sigma[0];
  t49 = t5 * t19;
  t52 = t14 - t48 * t49 / 0.8e1;
  t53 = 0.1e-9 < t52;
  t54 = my_piecewise3(t53, t52, 0.1e-9);
  t55 = sqrt(t54);
  t60 = (-0.2e1 * t3 * t38 + t44 * t45 * t46 * t55 / 0.6e1) * t5;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t60 * t7 / 0.2e1;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t62 = params->c * M_PI;
  t63 = my_piecewise3(t25, 0, 0);
  t66 = t13 * t19;
  t70 = 0.1e1 / t8 / t17 / rho[0];
  t74 = my_piecewise3(t24, t63, -0.5e1 / 0.18e2 * t6 * t19 + 0.88888888888888888889e0 * t66 - 0.17777777777777777778e0 * t16 * t70);
  t75 = t27 * t27;
  t76 = 0.1e1 / t75;
  t77 = t74 * t76;
  t79 = exp(-0.2e1 / 0.3e1 * t28);
  t80 = 0.1e1 / t79;
  t83 = t28 * t28;
  t86 = 0.1e1 / (t83 - 0.2e1 * t28 + 0.3e1);
  t88 = POW_2(t28 - 0.2e1);
  t89 = t86 * t88;
  t90 = t89 * t38;
  t93 = t2 * t2;
  t94 = t93 * t74;
  t95 = t76 * t80;
  t97 = t89 * t34;
  t100 = t80 * t86;
  t102 = t100 * t88 * t31;
  t112 = t62 * t36 / t83;
  t113 = t100 * t88;
  t117 = t44 * t45;
  t119 = t46 / t55;
  t125 = my_piecewise3(t53, -0.5e1 / 0.3e1 * t66 + t48 * t5 * t70 / 0.3e1, 0);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = (-0.2e1 / 0.3e1 * t62 * t77 * t80 * t90 - 0.2e1 * t3 * t30 * (t94 * t95 * t97 - t94 * t76 * t102 / 0.2e1) * t37 + 0.2e1 * t112 * t77 * t113 + t117 * t119 * t125 / 0.12e2) * t5 * t7 / 0.2e1 + t60 / t8 / 0.6e1;

  t137 = my_piecewise3(t24, t63, 0.66666666666666666667e-1 * t49);
  t138 = t137 * t76;
  t143 = t93 * t137;
  t160 = my_piecewise3(t53, -params->alpha * t5 * t19 / 0.8e1, 0);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = (-0.2e1 / 0.3e1 * t62 * t138 * t80 * t90 - 0.2e1 * t3 * t30 * (t143 * t95 * t97 - t143 * t76 * t102 / 0.2e1) * t37 + 0.2e1 * t112 * t138 * t113 + t117 * t119 * t160 / 0.12e2) * t5 * t7 / 0.2e1;

  t167 = t5 * t10;
  t169 = my_piecewise3(t24, t63, t167 / 0.6e1);
  t170 = t169 * t76;
  t175 = t93 * t169;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[0] = (-0.2e1 / 0.3e1 * t62 * t170 * t80 * t90 - 0.2e1 * t3 * t30 * (t175 * t95 * t97 - t175 * t76 * t102 / 0.2e1) * t37 + 0.2e1 * t112 * t170 * t113) * t5 * t7 / 0.2e1;

  t193 = my_piecewise3(t24, t63, -0.53333333333333333333e0 * t167);
  t194 = t193 * t76;
  t199 = t93 * t193;
  t213 = my_piecewise3(t53, t167, 0);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[0] = (-0.2e1 / 0.3e1 * t62 * t194 * t80 * t90 - 0.2e1 * t3 * t30 * (t199 * t95 * t97 - t199 * t76 * t102 / 0.2e1) * t37 + 0.2e1 * t112 * t194 * t113 + t117 * t119 * t213 / 0.12e2) * t5 * t7 / 0.2e1;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif


}


static inline void
func_pol(const xc_func_type *p, int order, const double *rho, const double *sigma, const double *lapl, const double *tau MGGA_OUT_PARAMS_NO_EXC(XC_COMMA double *, ))
{

#ifndef XC_DONT_COMPILE_VXC
  double t2, t3, t4, t5, t7, t10, t12, t14;
  double t17, t18, t19, t20, t21, t22, t23, t25;
  double t26, t29, t31, t32, t33, t38, t39, t40;
  double t41, t42, t43, t46, t47, t48, t49, t53;
  double t54, t55, t57, t60, t62, t64, t67, t68;
  double t69, t70, t71, t72, t73, t75, t76, t79;
  double t81, t82, t83, t86, t89, t90, t91, t92;
  double t96;

#ifndef XC_DONT_COMPILE_FXC
  double t97, t98, t101, t105, t109, t110, t111, t112;
  double t114, t115, t118, t121, t123, t124, t125, t128;
  double t129, t130, t132, t135, t137, t147, t148, t152;
  double t154, t159, t168, t171, t175, t179, t180, t181;
  double t182, t184, t185, t188, t191, t193, t194, t195;
  double t198, t199, t201, t204, t206, t216, t217, t222;
  double t227, t237, t238, t243, t259, t260, t265, t281;
  double t282, t287, t303, t309, t310, t315, t331, t337;
  double t338, t343, t357, t363, t364, t369, t383;
#endif

#endif


  mgga_x_tb09_params *params;

  assert(p->params != NULL);
  params = (mgga_x_tb09_params * ) (p->params);

  t2 = M_CBRTPI;
  t3 = params->c * t2;
  t4 = POW_1_3(rho[0]);
  t5 = t4 * t4;
  t7 = 0.1e1 / t5 / rho[0];
  t10 = tau[0] * t7;
  t12 = rho[0] * rho[0];
  t14 = 0.1e1 / t5 / t12;
  t17 = lapl[0] * t7 / 0.6e1 - 0.53333333333333333333e0 * t10 + 0.66666666666666666667e-1 * sigma[0] * t14;
  t18 = fabs(t17);
  t19 = t18 < 0.50e-12;
  t20 = 0.0e0 < t17;
  t21 = my_piecewise3(t20, 0.50e-12, -0.50e-12);
  t22 = my_piecewise3(t19, t21, t17);
  t23 = xc_mgga_x_br89_get_x(t22);
  t25 = exp(t23 / 0.3e1);
  t26 = exp(-t23);
  t29 = t26 * (0.1e1 + t23 / 0.2e1);
  t31 = t25 * (0.1e1 - t29);
  t32 = 0.1e1 / t23;
  t33 = t31 * t32;
  t38 = sqrt(0.15e2);
  t39 = (0.3e1 * params->c - 0.2e1) * t38;
  t40 = 0.1e1 / M_PI;
  t41 = M_SQRT2;
  t42 = t40 * t41;
  t43 = params->alpha * sigma[0];
  t46 = t10 - t43 * t14 / 0.8e1;
  t47 = 0.1e-9 < t46;
  t48 = my_piecewise3(t47, t46, 0.1e-9);
  t49 = sqrt(t48);
  t53 = -0.2e1 * t3 * t33 + t39 * t42 * t49 / 0.6e1;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[0] = t53 * t4;

  t54 = POW_1_3(rho[1]);
  t55 = t54 * t54;
  t57 = 0.1e1 / t55 / rho[1];
  t60 = tau[1] * t57;
  t62 = rho[1] * rho[1];
  t64 = 0.1e1 / t55 / t62;
  t67 = lapl[1] * t57 / 0.6e1 - 0.53333333333333333333e0 * t60 + 0.66666666666666666667e-1 * sigma[2] * t64;
  t68 = fabs(t67);
  t69 = t68 < 0.50e-12;
  t70 = 0.0e0 < t67;
  t71 = my_piecewise3(t70, 0.50e-12, -0.50e-12);
  t72 = my_piecewise3(t69, t71, t67);
  t73 = xc_mgga_x_br89_get_x(t72);
  t75 = exp(t73 / 0.3e1);
  t76 = exp(-t73);
  t79 = t76 * (0.1e1 + t73 / 0.2e1);
  t81 = t75 * (0.1e1 - t79);
  t82 = 0.1e1 / t73;
  t83 = t81 * t82;
  t86 = params->alpha * sigma[2];
  t89 = t60 - t86 * t64 / 0.8e1;
  t90 = 0.1e-9 < t89;
  t91 = my_piecewise3(t90, t89, 0.1e-9);
  t92 = sqrt(t91);
  t96 = -0.2e1 * t3 * t83 + t39 * t42 * t92 / 0.6e1;
  if(vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    vrho[1] = t96 * t54;

#ifndef XC_DONT_COMPILE_FXC

  if(order < 2) return;


  t97 = params->c * M_PI;
  t98 = my_piecewise3(t20, 0, 0);
  t101 = tau[0] * t14;
  t105 = 0.1e1 / t5 / t12 / rho[0];
  t109 = my_piecewise3(t19, t98, -0.5e1 / 0.18e2 * lapl[0] * t14 + 0.88888888888888888889e0 * t101 - 0.17777777777777777778e0 * sigma[0] * t105);
  t110 = t22 * t22;
  t111 = 0.1e1 / t110;
  t112 = t109 * t111;
  t114 = exp(-0.2e1 / 0.3e1 * t23);
  t115 = 0.1e1 / t114;
  t118 = t23 * t23;
  t121 = 0.1e1 / (t118 - 0.2e1 * t23 + 0.3e1);
  t123 = POW_2(t23 - 0.2e1);
  t124 = t121 * t123;
  t125 = t124 * t33;
  t128 = t2 * t2;
  t129 = t128 * t109;
  t130 = t111 * t115;
  t132 = t124 * t29;
  t135 = t115 * t121;
  t137 = t135 * t123 * t26;
  t147 = t97 * t31 / t118;
  t148 = t135 * t123;
  t152 = t39 * t40;
  t154 = t41 / t49;
  t159 = my_piecewise3(t47, -0.5e1 / 0.3e1 * t101 + t43 * t105 / 0.3e1, 0);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[0] = (-0.2e1 / 0.3e1 * t97 * t112 * t115 * t125 - 0.2e1 * t3 * t25 * (t129 * t130 * t132 - t129 * t111 * t137 / 0.2e1) * t32 + 0.2e1 * t147 * t112 * t148 + t152 * t154 * t159 / 0.12e2) * t4 + t53 / t5 / 0.3e1;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[1] = 0.0e0;

  t168 = my_piecewise3(t70, 0, 0);
  t171 = tau[1] * t64;
  t175 = 0.1e1 / t55 / t62 / rho[1];
  t179 = my_piecewise3(t69, t168, -0.5e1 / 0.18e2 * lapl[1] * t64 + 0.88888888888888888889e0 * t171 - 0.17777777777777777778e0 * sigma[2] * t175);
  t180 = t72 * t72;
  t181 = 0.1e1 / t180;
  t182 = t179 * t181;
  t184 = exp(-0.2e1 / 0.3e1 * t73);
  t185 = 0.1e1 / t184;
  t188 = t73 * t73;
  t191 = 0.1e1 / (t188 - 0.2e1 * t73 + 0.3e1);
  t193 = POW_2(t73 - 0.2e1);
  t194 = t191 * t193;
  t195 = t194 * t83;
  t198 = t128 * t179;
  t199 = t181 * t185;
  t201 = t194 * t79;
  t204 = t185 * t191;
  t206 = t204 * t193 * t76;
  t216 = t97 * t81 / t188;
  t217 = t204 * t193;
  t222 = t41 / t92;
  t227 = my_piecewise3(t90, -0.5e1 / 0.3e1 * t171 + t86 * t175 / 0.3e1, 0);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rho2[2] = (-0.2e1 / 0.3e1 * t97 * t182 * t185 * t195 - 0.2e1 * t3 * t75 * (t198 * t199 * t201 - t198 * t181 * t206 / 0.2e1) * t82 + 0.2e1 * t216 * t182 * t217 + t152 * t222 * t227 / 0.12e2) * t54 + t96 / t55 / 0.3e1;

  t237 = my_piecewise3(t19, t98, t7 / 0.6e1);
  t238 = t237 * t111;
  t243 = t128 * t237;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[0] = (-0.2e1 / 0.3e1 * t97 * t238 * t115 * t125 - 0.2e1 * t3 * t25 * (t243 * t130 * t132 - t243 * t111 * t137 / 0.2e1) * t32 + 0.2e1 * t147 * t238 * t148) * t4;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[2] = 0.0e0;

  t259 = my_piecewise3(t69, t168, t57 / 0.6e1);
  t260 = t259 * t181;
  t265 = t128 * t259;
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rholapl[3] = (-0.2e1 / 0.3e1 * t97 * t260 * t185 * t195 - 0.2e1 * t3 * t75 * (t265 * t199 * t201 - t265 * t181 * t206 / 0.2e1) * t82 + 0.2e1 * t216 * t260 * t217) * t54;

  t281 = my_piecewise3(t19, t98, 0.66666666666666666667e-1 * t14);
  t282 = t281 * t111;
  t287 = t128 * t281;
  t303 = my_piecewise3(t47, -params->alpha * t14 / 0.8e1, 0);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[0] = (-0.2e1 / 0.3e1 * t97 * t282 * t115 * t125 - 0.2e1 * t3 * t25 * (t287 * t130 * t132 - t287 * t111 * t137 / 0.2e1) * t32 + 0.2e1 * t147 * t282 * t148 + t152 * t154 * t303 / 0.12e2) * t4;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[2] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[3] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[4] = 0.0e0;

  t309 = my_piecewise3(t69, t168, 0.66666666666666666667e-1 * t64);
  t310 = t309 * t181;
  t315 = t128 * t309;
  t331 = my_piecewise3(t90, -params->alpha * t64 / 0.8e1, 0);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhosigma[5] = (-0.2e1 / 0.3e1 * t97 * t310 * t185 * t195 - 0.2e1 * t3 * t75 * (t315 * t199 * t201 - t315 * t181 * t206 / 0.2e1) * t82 + 0.2e1 * t216 * t310 * t217 + t152 * t222 * t331 / 0.12e2) * t54;

  t337 = my_piecewise3(t19, t98, -0.53333333333333333333e0 * t7);
  t338 = t337 * t111;
  t343 = t128 * t337;
  t357 = my_piecewise3(t47, t7, 0);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[0] = (-0.2e1 / 0.3e1 * t97 * t338 * t115 * t125 - 0.2e1 * t3 * t25 * (t343 * t130 * t132 - t343 * t111 * t137 / 0.2e1) * t32 + 0.2e1 * t147 * t338 * t148 + t152 * t154 * t357 / 0.12e2) * t4;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[1] = 0.0e0;

  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[2] = 0.0e0;

  t363 = my_piecewise3(t69, t168, -0.53333333333333333333e0 * t57);
  t364 = t363 * t181;
  t369 = t128 * t363;
  t383 = my_piecewise3(t90, t57, 0);
  if(v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    v2rhotau[3] = (-0.2e1 / 0.3e1 * t97 * t364 * t185 * t195 - 0.2e1 * t3 * t75 * (t369 * t199 * t201 - t369 * t181 * t206 / 0.2e1) * t82 + 0.2e1 * t216 * t364 * t217 + t152 * t222 * t383 / 0.12e2) * t54;

#ifndef XC_DONT_COMPILE_KXC

  if(order < 3) return;


#endif

#endif


}

